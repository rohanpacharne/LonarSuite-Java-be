findByBranchCode = SELECT * FROM LT_MAST_BRANCHES l \
WHERE  (l.status = 'Active' OR l.status = 'ACTIVE')  \
AND l.START_DATE <= now() \
AND (l.END_DATE IS NULL OR l.END_DATE >= now()) \
AND l.BRANCH_CODE  like ?

findByBranchName= SELECT * FROM LT_MAST_BRANCHES l \
WHERE  (l.status = 'Active' OR l.status = 'ACTIVE') \
AND l.START_DATE <= now() \
AND (l.END_DATE IS NULL OR l.END_DATE >= now()) \
AND l.BRANCH_NAME  like ?

findAllActive= SELECT * FROM LT_MAST_BRANCHES l \
WHERE  (l.status = 'Active' OR l.status = 'ACTIVE')  \
AND l.START_DATE <= now() \
AND (l.END_DATE IS NULL OR l.endDate >= now()) \
AND l.COMPANY_ID = ?


#getAllBranchActiveBillingAddress = SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME \
#FROM LT_MAST_BRANCHES l \
#WHERE  (l.status = 'Active' OR l.status = 'ACTIVE') \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now()) \
#AND l.BILLABLE_LOCATION  = 'Y' \
#AND l.COMPANY_ID = ?

getAllBranchActiveBillingAddress = SELECT l.BRANCH_ID, CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME \
FROM LT_MAST_BRANCHES l \
WHERE (l.status = 'Active' OR l.status = 'ACTIVE') \
  AND l.START_DATE <= NOW() \
  AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
  AND l.BILLABLE_LOCATION = 'Y' \
  AND l.COMPANY_ID = ?


#getAllActiveBillingAddrByBuyer = SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME  \
#FROM LT_MAST_BRANCHES l  \
#WHERE  l.COMPANY_ID = ( SELECT COMPANY_ID FROM LT_MAST_EMPLOYEES WHERE EMPLOYEE_ID = ? ) \
#AND (l.status = 'Active' OR l.status = 'ACTIVE')  \
#AND l.START_DATE <= now()  \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now())  AND l.BILLABLE_LOCATION  = 'Y'

getAllActiveBillingAddrByBuyer = SELECT l.BRANCH_ID, CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME \
FROM LT_MAST_BRANCHES l \
WHERE l.COMPANY_ID = (SELECT COMPANY_ID FROM LT_MAST_EMPLOYEES WHERE EMPLOYEE_ID = ?) \
  AND (l.status = 'Active' OR l.status = 'ACTIVE') \
  AND l.START_DATE <= NOW() \
  AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
  AND l.BILLABLE_LOCATION = 'Y'

#getAllActiveShippingAddress = SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME \
#FROM LT_MAST_BRANCHES l \
#WHERE  (l.status = 'Active' OR l.status = 'ACTIVE') \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now()) \
#AND l.SHIPPING_LOCATION  = 'Y' \
#AND l.COMPANY_ID = ?

getAllActiveShippingAddress = SELECT l.BRANCH_ID, CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME \
FROM LT_MAST_BRANCHES l \
WHERE (l.status = 'Active' OR l.status = 'ACTIVE') \
  AND l.START_DATE <= NOW() \
  AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
  AND l.SHIPPING_LOCATION = 'Y' \
  AND l.COMPANY_ID = ?


#getAllActiveShippingAddrByBuyer = SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME \
#FROM LT_MAST_BRANCHES l \
#WHERE  l.COMPANY_ID = ( SELECT COMPANY_ID FROM LT_MAST_EMPLOYEES WHERE EMPLOYEE_ID = ? ) \
#AND (l.status = 'Active' OR l.status = 'ACTIVE') \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now()) \
#AND l.SHIPPING_LOCATION  = 'Y'

getAllActiveShippingAddrByBuyer = SELECT l.BRANCH_ID, CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME \
FROM LT_MAST_BRANCHES l \
WHERE l.COMPANY_ID = (SELECT COMPANY_ID FROM LT_MAST_EMPLOYEES WHERE EMPLOYEE_ID = ?) \
  AND (l.status = 'Active' OR l.status = 'ACTIVE') \
  AND l.START_DATE <= NOW() \
  AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
  AND l.SHIPPING_LOCATION = 'Y'


#getLtMastBranchesByCompID =  SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME \
#FROM LT_MAST_BRANCHES l \
#WHERE  l.COMPANY_ID = ? \
#AND (l.status = 'Active' OR l.status = 'ACTIVE') \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now())

getLtMastBranchesByCompID =  SELECT l.BRANCH_ID, l.BRANCH_NAME || ' ( '||l.BRANCH_CODE||' )' as BRANCH_NAME \
FROM LT_MAST_BRANCHES l \
WHERE  l.COMPANY_ID = ? \
AND (l.status = 'Active' OR l.status = 'ACTIVE') \
AND l.START_DATE <= now() \
AND (l.END_DATE IS NULL OR l.END_DATE >= now())

#getLtMastLikeNameByCompanyId = SELECT (l.BRANCH_NAME||' ( '||l.BRANCH_CODE||' )') AS BRANCH_NAME,l.BRANCH_CODE, \
#l.BRANCH_ID,l.REPORTING_BRANCH,l.MANAGER_ID,l.STATE_CODE,l.GST_REG_NO,l.COMPANY_ID ,l.BILLABLE_LOCATION, \
#nvl2(l.MANAGER_ID,( cmv.VALUE_NAME||' '||em.FIRST_NAME|| ' '||em.LAST_NAME||' '||'('|| em.EMPLOYEE_NUMBER|| ')' ),null) as manager_name, \
#em.OFFICIAL_EMAIL as manager_offical_email_id, em.EMPLOYEE_NUMBER as manager_code \
#FROM LT_MAST_BRANCHES l ,lt_mast_employees em ,LT_MAST_COMN_MASTER_VALUES cmv, LT_MAST_COMN_MASTER cm \
#WHERE   l.MANAGER_ID = em.EMPLOYEE_ID(+) \
#and  (l.status = 'Active' OR l.status = 'ACTIVE')  \
#and em.TITLE = cmv.value_code(+) and cmv.MASTER_ID(+) = cm.MASTER_ID AND cm.MASTER_NAME = 'TITLE_MASTER' \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now())  \
#AND (upper(l.BRANCH_NAME)  like ? OR upper(l.BRANCH_CODE) like ? ) AND l.COMPANY_ID = ? 

getLtMastLikeNameByCompanyId = SELECT \
    CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME, \
    l.BRANCH_CODE, \
    l.BRANCH_ID, \
    l.REPORTING_BRANCH, \
    l.MANAGER_ID, \
    l.STATE_CODE, \
    l.GST_REG_NO, \
    l.COMPANY_ID, \
    l.BILLABLE_LOCATION, \
    IF( \
        l.MANAGER_ID IS NOT NULL,  \
        CONCAT( \
            cmv.VALUE_NAME, ' ', \
            em.FIRST_NAME, ' ', \
            em.LAST_NAME, ' ', \
            '(', em.EMPLOYEE_NUMBER, ')' \
        ), \
        NULL \
    ) AS manager_name, \
    em.OFFICIAL_EMAIL AS manager_official_email_id, \
    em.EMPLOYEE_NUMBER AS manager_code \
FROM \
    LT_MAST_BRANCHES l \
    LEFT JOIN lt_mast_employees em ON l.MANAGER_ID = em.EMPLOYEE_ID \
    LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON em.TITLE = cmv.VALUE_CODE \
    LEFT JOIN LT_MAST_COMN_MASTER cm ON cmv.MASTER_ID = cm.MASTER_ID AND cm.MASTER_NAME = 'TITLE_MASTER' \
WHERE \
    l.status = 'ACTIVE' \
    AND l.START_DATE <= NOW() \
    AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
    AND (UPPER(l.BRANCH_NAME) LIKE ? OR UPPER(l.BRANCH_CODE) LIKE ?) \
    AND l.COMPANY_ID = ?


#findActiveLikeBranchName=SELECT (l.BRANCH_NAME||' ( '||l.BRANCH_CODE||' )') AS BRANCH_NAME,l.BRANCH_CODE, \
#l.BRANCH_ID,l.REPORTING_BRANCH,l.MANAGER_ID,l.STATE_CODE,l.GST_REG_NO,l.COMPANY_ID ,l.BILLABLE_LOCATION, \
#nvl2(l.MANAGER_ID,( cmv.VALUE_NAME||' '||em.FIRST_NAME|| ' '||em.LAST_NAME||' '||'('|| em.EMPLOYEE_NUMBER|| ')' ),null) as manager_name, \
#em.OFFICIAL_EMAIL as manager_offical_email_id, em.EMPLOYEE_NUMBER as manager_code \
#FROM LT_MAST_BRANCHES l ,lt_mast_employees em ,LT_MAST_COMN_MASTER_VALUES cmv , LT_MAST_COMN_MASTER cm \
#WHERE   l.MANAGER_ID = em.EMPLOYEE_ID(+) \
#and  (l.status = 'Active' OR l.status = 'ACTIVE')  \
#and em.TITLE = cmv.value_code(+) and cmv.MASTER_ID(+) = cm.MASTER_ID AND cm.MASTER_NAME = 'TITLE_MASTER' \
#AND l.START_DATE <= now() \
#AND (l.END_DATE IS NULL OR l.END_DATE >= now())  \
#AND (upper(l.BRANCH_NAME)  like ? OR upper(l.BRANCH_CODE) like ? ) \
#AND l.COMPANY_ID = ?

findActiveLikeBranchName = SELECT CONCAT(l.BRANCH_NAME, ' (', l.BRANCH_CODE, ')') AS BRANCH_NAME, l.BRANCH_CODE, \
       l.BRANCH_ID, l.REPORTING_BRANCH, l.MANAGER_ID, l.STATE_CODE, l.GST_REG_NO, l.COMPANY_ID, l.BILLABLE_LOCATION, \
       IFNULL(CASE WHEN l.MANAGER_ID IS NOT NULL THEN \
         CONCAT(cmv.VALUE_NAME, ' ', em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') \
       END, NULL) AS manager_name, \
       em.OFFICIAL_EMAIL AS manager_official_email_id, \
       em.EMPLOYEE_NUMBER AS manager_code \
FROM LT_MAST_BRANCHES l \
LEFT JOIN lt_mast_employees em ON l.MANAGER_ID = em.EMPLOYEE_ID \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON em.TITLE = cmv.value_code \
LEFT JOIN LT_MAST_COMN_MASTER cm ON cmv.MASTER_ID = cm.MASTER_ID AND cm.MASTER_NAME = 'TITLE_MASTER' \
WHERE (l.status = 'Active' OR l.status = 'ACTIVE') \
  AND l.START_DATE <= NOW() \
  AND (l.END_DATE IS NULL OR l.END_DATE >= NOW()) \
  AND (UPPER(l.BRANCH_NAME) LIKE ? OR UPPER(l.BRANCH_CODE) LIKE ?) \
  AND l.COMPANY_ID = ?

   
isFeildsExists=SELECT branch_id , branch_code, gst_reg_no, BRANCH_NAME  \
FROM lt_mast_branches  \
WHERE ( branch_code = ? OR gst_reg_no = ? OR BRANCH_NAME = ? ) AND COMPANY_ID = ? 

updateBranch= SELECT gst_reg_no FROM lt_mast_branches WHERE gst_reg_no = ?

checkAlreadyUsed = SELECT * FROM LT_MAST_BRANCHES l WHERE l.REPORTING_BRANCH = ?

findByBranchId=SELECT * FROM LT_MAST_BRANCHES l WHERE l.branch_id = ?

#findAll=SELECT bm.* ,\
#(em.TITLE || em.first_name || ' '|| em.LAST_NAME) AS manager_Name , \
#em.EMPLOYEE_NUMBER as manager_Code, \
#em.OFFICIAL_EMAIL as manager_Offical_Email_Id, \
#em.EMPLOYEE_NUMBER as manager_Code \
#FROM LT_MAST_BRANCHES bm , LT_MAST_EMPLOYEES em \
#where  bm.Manager_id=em.EMPLOYEE_ID(+) \
#AND bm.COMPANY_ID = ?

findAll=SELECT bm.*, \
       CONCAT(em.TITLE, ' ', em.FIRST_NAME, ' ', em.LAST_NAME) AS manager_Name, \
       em.EMPLOYEE_NUMBER AS manager_Code, \
       em.OFFICIAL_EMAIL AS manager_Official_Email_Id \
FROM LT_MAST_BRANCHES bm \
LEFT JOIN LT_MAST_EMPLOYEES em ON bm.MANAGER_ID = em.EMPLOYEE_ID \
WHERE bm.COMPANY_ID = ?


getLtMastBranchesByID_21-2-2018=SELECT bm.* , \
nvl2(bm.MANAGER_ID,cmv.value_name ||' '|| em.first_name || ' '|| em.LAST_NAME||' '||'( '||em.EMPLOYEE_NUMBER||' )',null) AS manager_Name , \
 em.EMPLOYEE_NUMBER as manager_Code, em.OFFICIAL_EMAIL as manager_Offical_Email_Id, \
 em.EMPLOYEE_NUMBER as manager_Code \
 FROM LT_MAST_BRANCHES bm , LT_MAST_EMPLOYEES em ,LT_MAST_COMN_MASTER_VALUES cmv \
 WHERE  bm.Manager_id=em.EMPLOYEE_ID(+) \
 AND em.title = cmv.value_code(+) \
 AND bm.branch_id = ?
 
 
# getLtMastBranchesByID = SELECT bm.BRANCH_ID,bm.BRANCH_CODE,bm.BRANCH_NAME,bm.CITY,bm.REGION,bm.COUNTRY \
# ,lt_vpal_common_pkg.get_comn_value_name('COUNTRY_MASTER',bm.COUNTRY) COUNTRY_VALUE,  \
# bm.REPORTING_BRANCH,bm.OPENING_DATE,bm.MANAGER_ID,bm.STATE_CODE,bm.GST_REG_NO,bm.START_DATE,bm.END_DATE,bm.STATE_ID, \
# bm.BRANCH_TYPE \
#,lt_vpal_common_pkg.get_comn_value_name('BRANCTYPE_MASTER',bm.BRANCH_TYPE) as  BRANCH_TYPE_VALUE, \
# bm.CREATED_BY,bm.CREATION_DATE,bm.LAST_UPDATE_LOGIN,bm.LAST_UPDATED_BY, \
# bm.LAST_UPDATE_DATE,bm.COMPANY_ID, bm.BILLABLE_LOCATION,bm.SHIPPING_LOCATION, bm.STATUS \
# ,lt_vpal_common_pkg.get_comn_value_name('STATUS_MASTER',bm.STATUS) AS status_value, \
# cm.COMPANY_NAME as company_name, \
# nvl2(ms.STATE_ID,ms.STATE_NAME||' ( '||ms.STATE_CODE||' )','')as state_name, \
# nvl2(bm.MANAGER_ID, em.first_name || ' '|| em.LAST_NAME||' '||'( '||em.EMPLOYEE_NUMBER||' )',null) AS manager_Name ,  \
# em.EMPLOYEE_NUMBER as manager_Code, em.OFFICIAL_EMAIL as manager_Offical_Email_Id, em.EMPLOYEE_NUMBER as manager_Code, ms.GST_STATE_CODE \
# FROM LT_MAST_BRANCHES bm , LT_MAST_EMPLOYEES em ,LT_MAST_STATES ms, LT_VEND_COMPANY_MASTER cm \
# WHERE  bm.Manager_id=em.EMPLOYEE_ID(+) AND bm.branch_id = ? \
# AND bm.STATE_ID = ms.STATE_ID(+) \
# AND bm.COMPANY_ID = cm.COMPANY_ID(+)

getLtMastBranchesByID = SELECT bm.BRANCH_ID, bm.BRANCH_CODE, bm.BRANCH_NAME, bm.CITY, bm.REGION, bm.COUNTRY, \
       get_comn_value_name('COUNTRY_MASTER', bm.COUNTRY) AS COUNTRY_VALUE, \
       bm.REPORTING_BRANCH, bm.OPENING_DATE, bm.MANAGER_ID, bm.STATE_CODE, bm.GST_REG_NO, \
       bm.START_DATE, bm.END_DATE, bm.STATE_ID, bm.BRANCH_TYPE, \
       get_comn_value_name('BRANCTYPE_MASTER', bm.BRANCH_TYPE) AS BRANCH_TYPE_VALUE, \
       bm.CREATED_BY, bm.CREATION_DATE, bm.LAST_UPDATE_LOGIN, bm.LAST_UPDATED_BY, \
       bm.LAST_UPDATE_DATE, bm.COMPANY_ID, bm.BILLABLE_LOCATION, bm.SHIPPING_LOCATION, bm.STATUS, \
       get_comn_value_name('STATUS_MASTER', bm.STATUS) AS status_value, \
       cm.COMPANY_NAME AS company_name, \
       IFNULL(CONCAT(ms.STATE_NAME, ' (', ms.STATE_CODE, ')'), '') AS state_name, \
       IFNULL(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'), NULL) AS manager_Name, \
       em.EMPLOYEE_NUMBER AS manager_Code, em.OFFICIAL_EMAIL AS manager_Official_Email_Id, \
       ms.GST_STATE_CODE, \
       bm.branch_address \
FROM LT_MAST_BRANCHES bm \
LEFT JOIN LT_MAST_EMPLOYEES em ON bm.MANAGER_ID = em.EMPLOYEE_ID \
LEFT JOIN LT_MAST_STATES ms ON bm.STATE_ID = ms.STATE_ID \
LEFT JOIN LT_VEND_COMPANY_MASTER cm ON bm.COMPANY_ID = cm.COMPANY_ID \
WHERE bm.BRANCH_ID = ?

# getBranchDataTableRecords = select  *  from \
# (SELECT a.*,ROWNUM RNUM from \
# ( select mb.BRANCH_ID, mb.BRANCH_CODE, mb.BRANCH_NAME,cm.COMPANY_NAME as COMPANY_NAME ,mb.BILLABLE_LOCATION,mb.STATE_ID, \
# mb.CITY,mb.REGION, cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )'  AS state_name , \
# cmvc.VALUE_NAME AS country , \
# mb.REPORTING_BRANCH, mb.OPENING_DATE, me.OFFICIAL_EMAIL  , \
# nvl2(mb.manager_id,(me.first_name||' '||me.last_name||'( '||me.employee_number||' )'),NULL) AS MANAGER_NAME, \
# mb.STATE_COde,mb.GST_REG_NO,mb.START_DATE,mb.END_DATE \
# ,lt_vpal_common_pkg.get_comn_value_name('BRANCTYPE_MASTER',mb.BRANCH_TYPE) as BRANCH_TYPE \
# ,lt_vpal_common_pkg.get_comn_value_name('STATUS_MASTER',mb.STATUS)  as status \
# FROM  LT_MAST_BRANCHES mb, LT_MAST_STATES cmvsc,  lt_mast_employees me ,LT_VEND_COMPANY_MASTER cm , \
#  LT_MAST_COMN_MASTER_VALUES cmvc, LT_MAST_COMN_MASTER cm \
# WHERE   cmvsc.STATE_ID(+)=mb.state_ID \
# AND cm.COMPANY_ID(+) = mb.COMPANY_ID  \
# AND me.employee_id(+)=mb.manager_id  \
# AND mb.COUNTRY = cmvc.VALUE_CODE(+) \
# AND cmvc.MASTER_ID(+) = cm.MASTER_ID AND cm.MASTER_NAME = 'COUNTRY_MASTER'  \
# AND mb.COMPANY_ID = ? \
# AND nvl( upper( cm.COMPANY_NAME),'xx') LIKE  nvl(?,nvl(upper( cm.COMPANY_NAME),'xx') ) \
# AND  upper( mb.BRANCH_CODE) LIKE  nvl(?,upper( mb.BRANCH_CODE))  \
# AND upper(mb.BRANCH_NAME) LIKE  nvl(?,upper(mb.BRANCH_NAME)) \
# AND nvl(upper(mb.CITY),'xx') LIKE  nvl(?,nvl(upper(mb.CITY),'xx')) \
# AND nvl(upper(cmvc.VALUE_NAME),'xx')  LIKE  nvl(?,nvl(upper(cmvc.VALUE_NAME),'xx')) \
# AND nvl(upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )' ),'xx') LIKE  nvl(?,nvl(upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )' ),'xx') ) \
# AND nvl(upper(mb.STATUS ),'xx') LIKE  nvl(?,nvl(upper(mb.STATUS ),'xx')) \
# AND  TO_CHAR(mb.START_DATE,'DD-MM-YYYY')  LIKE nvl(?, TO_CHAR(mb.START_DATE,'DD-MM-YYYY')) \
# AND  TO_CHAR(nvl (mb.END_DATE, now() ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (mb.END_DATE, now() ),'DD-MM-YYYY')) \
# order by \
# CASE WHEN 2 = ? then upper(cm.COMPANY_NAME) END asc, \
# CASE WHEN 12 = ? then upper(cm.COMPANY_NAME) END desc, \
# CASE WHEN 3 = ? then upper(mb.BRANCH_CODE) END asc, \
# CASE WHEN 13 = ? then upper(mb.BRANCH_CODE) END desc, \
# CASE WHEN 4 = ? then upper(mb.BRANCH_NAME) END asc, \
# CASE WHEN 14 = ? then upper(mb.BRANCH_NAME) END desc, \
# CASE WHEN 5 = ? THEN upper(mb.CITY) END ASC, \
# CASE WHEN 15 = ? THEN upper(mb.CITY) END DESC, \
# CASE WHEN 7 = ? then upper(cmvc.VALUE_NAME) END asc, \
# CASE WHEN 17 = ? THEN upper(cmvc.VALUE_NAME) END DESC, \
# CASE WHEN 6 = ? then upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )') END asc, \
# CASE WHEN 16 = ? THEN upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )') END DESC, \
# CASE WHEN 8 = ? THEN upper(mb.STATUS) END ASC, \
# CASE WHEN 18 = ? THEN upper(mb.STATUS) END DESC, \
# CASE WHEN 9 = ? THEN mb.START_DATE END ASC,\
# CASE WHEN 19 = ? THEN mb.START_DATE END DESC, \
# CASE WHEN 10 = ? THEN mb.END_DATE END ASC, \
# CASE WHEN 20 = ? THEN mb.END_DATE END DESC, \
# CASE WHEN 1 = ? THEN mb.last_update_date END DESC, \
# CASE WHEN 11 = ? then mb.last_update_date END asc) a  where ROWNUM <=?)  WHERE RNUM >=?

getBranchDataTableRecords = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT \
            mb.BRANCH_ID, \
            mb.BRANCH_CODE, \
            mb.BRANCH_NAME, \
            cm.COMPANY_NAME AS COMPANY_NAME, \
            mb.BILLABLE_LOCATION, \
            mb.STATE_ID, \
            mb.CITY, \
            mb.REGION, \
            CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )') AS state_name, \
            cmvc.VALUE_NAME AS country, \
            mb.REPORTING_BRANCH, \
            mb.OPENING_DATE, \
            me.OFFICIAL_EMAIL, \
            IF(mb.MANAGER_ID IS NOT NULL, CONCAT(me.FIRST_NAME, ' ', me.LAST_NAME, ' ( ', me.EMPLOYEE_NUMBER, ' )'), NULL) AS MANAGER_NAME, \
            mb.STATE_CODE, \
            mb.GST_REG_NO, \
            mb.START_DATE, \
            mb.END_DATE, \
            get_comn_value_name('BRANCTYPE_MASTER', mb.BRANCH_TYPE) AS BRANCH_TYPE, \
            get_comn_value_name('STATUS_MASTER', mb.STATUS) AS STATUS \
        FROM  \
            LT_MAST_BRANCHES mb \
            LEFT JOIN LT_MAST_STATES cmvsc ON cmvsc.STATE_ID = mb.STATE_ID \
            AND cmvsc.STATUS = 'ACTIVE' \
            LEFT JOIN LT_VEND_COMPANY_MASTER cm ON cm.COMPANY_ID = mb.COMPANY_ID \
            LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = mb.MANAGER_ID \
            LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON mb.COUNTRY = cmvc.VALUE_CODE \
            AND cmvc.STATUS = 'ACTIVE' \
            LEFT JOIN LT_MAST_COMN_MASTER comn_cm ON cmvc.MASTER_ID = comn_cm.MASTER_ID \
            and comn_cm.MASTER_NAME = 'COUNTRY_MASTER' \
        WHERE  \
            mb.COMPANY_ID = ? \
            AND COALESCE(UPPER(cm.COMPANY_NAME), 'xx') LIKE COALESCE(?, COALESCE(UPPER(cm.COMPANY_NAME), 'xx')) \
            AND UPPER(mb.BRANCH_CODE) LIKE COALESCE(?, UPPER(mb.BRANCH_CODE)) \
            AND UPPER(mb.BRANCH_NAME) LIKE COALESCE(?, UPPER(mb.BRANCH_NAME)) \
            AND COALESCE(UPPER(mb.CITY), 'xx') LIKE COALESCE(?, COALESCE(UPPER(mb.CITY), 'xx')) \
            AND COALESCE(UPPER(cmvc.VALUE_NAME), 'xx') LIKE COALESCE(?, COALESCE(UPPER(cmvc.VALUE_NAME), 'xx')) \
            AND COALESCE(UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')), 'xx') LIKE COALESCE(?, COALESCE(UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')), 'xx')) \
            AND COALESCE(UPPER(mb.STATUS), 'xx') LIKE COALESCE(?, COALESCE(UPPER(mb.STATUS), 'xx')) \
            AND DATE_FORMAT(mb.START_DATE, '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(mb.START_DATE, '%d-%m-%Y')) \
            AND DATE_FORMAT(COALESCE(mb.END_DATE, CURDATE()), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(mb.END_DATE, CURDATE()), '%d-%m-%Y')) \
        ORDER BY \
            CASE WHEN ? = 2 THEN UPPER(cm.COMPANY_NAME) END ASC, \
            CASE WHEN ? = 12 THEN UPPER(cm.COMPANY_NAME) END DESC, \
            CASE WHEN ? = 3 THEN UPPER(mb.BRANCH_CODE) END ASC, \
            CASE WHEN ? = 13 THEN UPPER(mb.BRANCH_CODE) END DESC, \
            CASE WHEN ? = 4 THEN UPPER(mb.BRANCH_NAME) END ASC, \
            CASE WHEN ? = 14 THEN UPPER(mb.BRANCH_NAME) END DESC, \
            CASE WHEN ? = 5 THEN UPPER(mb.CITY) END ASC, \
            CASE WHEN ? = 15 THEN UPPER(mb.CITY) END DESC, \
            CASE WHEN ? = 7 THEN UPPER(cmvc.VALUE_NAME) END ASC, \
            CASE WHEN ? = 17 THEN UPPER(cmvc.VALUE_NAME) END DESC, \
            CASE WHEN ? = 6 THEN UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')) END ASC, \
            CASE WHEN ? = 16 THEN UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')) END DESC, \
            CASE WHEN ? = 8 THEN UPPER(mb.STATUS) END ASC, \
            CASE WHEN ? = 18 THEN UPPER(mb.STATUS) END DESC, \
            CASE WHEN ? = 9 THEN mb.START_DATE END ASC, \
            CASE WHEN ? = 19 THEN mb.START_DATE END DESC, \
            CASE WHEN ? = 10 THEN mb.END_DATE END ASC, \
            CASE WHEN ? = 20 THEN mb.END_DATE END DESC, \
            CASE WHEN ? = 1 THEN mb.LAST_UPDATE_DATE END DESC, \
            CASE WHEN ? = 11 THEN mb.LAST_UPDATE_DATE END ASC \
    ) a, (SELECT @rownum := 0) r \
    WHERE @rownum <= ? \
) AS paginated \
WHERE RNUM >= ?


   
#getLtMastBranchesCount =  select count(mb.BRANCH_ID) \
# FROM  LT_MAST_BRANCHES mb, LT_MAST_STATES cmvsc,  lt_mast_employees me ,LT_VEND_COMPANY_MASTER cm , \
#  LT_MAST_COMN_MASTER_VALUES cmvc, LT_MAST_COMN_MASTER cm \
# WHERE   cmvsc.STATE_ID(+)=mb.state_ID \
# AND cm.COMPANY_ID(+) = mb.COMPANY_ID  \
# AND me.employee_id(+)=mb.manager_id  \
# AND mb.COUNTRY = cmvc.VALUE_CODE(+) \
# AND cmvc.MASTER_ID(+) = cm.MASTER_ID AND cm.MASTER_NAME = 'COUNTRY_MASTER'  \
# AND mb.COMPANY_ID = ? \
# AND nvl( upper( cm.COMPANY_NAME),'xx') LIKE  nvl(?,nvl(upper( cm.COMPANY_NAME),'xx') ) \
# AND  upper( mb.BRANCH_CODE) LIKE  nvl(?,upper( mb.BRANCH_CODE))  \
# AND upper(mb.BRANCH_NAME) LIKE  nvl(?,upper(mb.BRANCH_NAME)) \
# AND nvl(upper(mb.CITY),'xx') LIKE  nvl(?,nvl(upper(mb.CITY),'xx')) \
# AND nvl(upper(cmvc.VALUE_NAME),'xx')  LIKE  nvl(?,nvl(upper(cmvc.VALUE_NAME),'xx')) \
# AND nvl(upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )' ),'xx') LIKE  nvl(?,nvl(upper(cmvsc.STATE_NAME||' ( '||cmvsc.STATE_CODE||' )' ),'xx') ) \
# AND nvl(upper(mb.STATUS ),'xx') LIKE  nvl(?,nvl(upper(mb.STATUS ),'xx')) \
# AND  TO_CHAR(mb.START_DATE,'DD-MM-YYYY')  LIKE nvl(?, TO_CHAR(mb.START_DATE,'DD-MM-YYYY')) \
# AND  TO_CHAR(nvl (mb.END_DATE, now() ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (mb.END_DATE, now() ),'DD-MM-YYYY'))
 
getLtMastBranchesCount =  SELECT COUNT(mb.BRANCH_ID) \
FROM LT_MAST_BRANCHES mb \
LEFT JOIN LT_MAST_STATES cmvsc ON cmvsc.STATE_ID = mb.STATE_ID \
LEFT JOIN LT_VEND_COMPANY_MASTER vend_cm ON vend_cm.COMPANY_ID = mb.COMPANY_ID \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = mb.MANAGER_ID \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON mb.COUNTRY = cmvc.VALUE_CODE \
LEFT JOIN LT_MAST_COMN_MASTER comn_cm ON cmvc.MASTER_ID = comn_cm.MASTER_ID \
WHERE comn_cm.MASTER_NAME = 'COUNTRY_MASTER' \
  AND mb.COMPANY_ID = ? \
  AND cmvsc.STATUS = 'ACTIVE' \
  AND cmvc.STATUS = 'ACTIVE' \
  AND COALESCE(UPPER(vend_cm.COMPANY_NAME), 'xx') LIKE COALESCE(?, COALESCE(UPPER(vend_cm.COMPANY_NAME), 'xx')) \
  AND UPPER(mb.BRANCH_CODE) LIKE COALESCE(?, UPPER(mb.BRANCH_CODE)) \
  AND UPPER(mb.BRANCH_NAME) LIKE COALESCE(?, UPPER(mb.BRANCH_NAME)) \
  AND COALESCE(UPPER(mb.CITY), 'xx') LIKE COALESCE(?, COALESCE(UPPER(mb.CITY), 'xx')) \
  AND COALESCE(UPPER(cmvc.VALUE_NAME), 'xx') LIKE COALESCE(?, COALESCE(UPPER(cmvc.VALUE_NAME), 'xx')) \
  AND COALESCE(UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')), 'xx') LIKE COALESCE(?, COALESCE(UPPER(CONCAT(cmvsc.STATE_NAME, ' ( ', cmvsc.STATE_CODE, ' )')), 'xx')) \
  AND COALESCE(UPPER(mb.STATUS), 'xx') LIKE COALESCE(?, COALESCE(UPPER(mb.STATUS), 'xx')) \
  AND DATE_FORMAT(mb.START_DATE, '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(mb.START_DATE, '%d-%m-%Y')) \
  AND DATE_FORMAT(COALESCE(mb.END_DATE, CURDATE()), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(mb.END_DATE, CURDATE()), '%d-%m-%Y'))
 
# getBranchForAuditByID = SELECT bm.branch_Id,bm.BRANCH_CODE,bm.BRANCH_NAME,bm.CITY,bm.REGION, ms.STATE_NAME,cmvc.value_name COUNTRY, \
# bm.REPORTING_BRANCH,bm.OPENING_DATE,bm.STATE_CODE,bm.GST_REG_NO,bm.START_DATE,bm.END_DATE, \
# cmvb.value_name as BRANCH_TYPE,cmvs.value_name as STATUS, cm.COMPANY_NAME  , bm.LAST_UPDATED_BY ,bm.BILLABLE_LOCATION,bm.SHIPPING_LOCATION, \
# nvl2(bm.MANAGER_ID,cmv.value_name ||' '|| em.first_name || ' '|| em.LAST_NAME||' '||'( '||em.EMPLOYEE_NUMBER||' )',null) AS manager_Name \
# FROM LT_MAST_BRANCHES bm , LT_MAST_EMPLOYEES em ,LT_MAST_COMN_MASTER_VALUES cmv , LT_MAST_STATES ms,LT_MAST_COMN_MASTER_VALUES cmvc, \
# LT_MAST_COMN_MASTER_VALUES cmvb ,LT_MAST_COMN_MASTER_VALUES cmvs , LT_VEND_COMPANY_MASTER cm  \
# WHERE  bm.Manager_id=em.EMPLOYEE_ID(+) AND bm.STATE_ID = ms.STATE_ID(+) AND bm.COUNTRY = cmvc.value_code(+)  \
# AND em.title = cmv.value_code(+) AND bm.BRANCH_TYPE = cmvb.value_code(+) AND bm.STATUS = cmvs.value_code(+) \
# AND bm.COMPANY_ID = cm.COMPANY_ID(+)  AND bm.branch_id = ?


getBranchForAuditByID = SELECT \
    bm.branch_Id, \
    bm.BRANCH_CODE, \
    bm.BRANCH_NAME, \
    bm.CITY, \
    bm.REGION, \
    ms.STATE_NAME, \
    cmvc.value_name AS COUNTRY, \
    bm.REPORTING_BRANCH, \
    bm.OPENING_DATE, \
    bm.STATE_CODE, \
    bm.GST_REG_NO, \
    bm.START_DATE, \
    bm.END_DATE, \
    cmvb.value_name AS BRANCH_TYPE, \
    cmvs.value_name AS STATUS, \
    cm.COMPANY_NAME, \
    bm.LAST_UPDATED_BY, \
    bm.BILLABLE_LOCATION, \
    bm.SHIPPING_LOCATION, \
    CASE  \
        WHEN bm.MANAGER_ID IS NOT NULL THEN CONCAT(cmv.value_name, ' ', em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') \
        ELSE NULL \
    END AS manager_Name \
FROM  \
    LT_MAST_BRANCHES bm \
    LEFT JOIN LT_MAST_EMPLOYEES em ON bm.Manager_id = em.EMPLOYEE_ID \
    LEFT JOIN LT_MAST_STATES ms ON bm.STATE_ID = ms.STATE_ID \
    LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON bm.COUNTRY = cmvc.value_code \
    LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON em.title = cmv.value_code \
    LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvb ON bm.BRANCH_TYPE = cmvb.value_code \
    LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON bm.STATUS = cmvs.value_code \
    LEFT JOIN LT_VEND_COMPANY_MASTER cm ON bm.COMPANY_ID = cm.COMPANY_ID \
WHERE  \
    bm.branch_id = ?
 
#getLtMastBranchesDataForReport=  SELECT bm.BRANCH_ID \
#     ,bm.BRANCH_CODE \
#     ,bm.BRANCH_NAME \
#     ,bm.CITY \
#     ,bm.REGION \
#     ,lt_vpal_common_pkg.get_comn_value_name('COUNTRY_MASTER',bm.country) COUNTRY_VALUE \
#     ,bm.REPORTING_BRANCH \
#     ,bm.OPENING_DATE  ,bm.STATE_CODE ,bm.GST_REG_NO,bm.START_DATE ,bm.END_DATE  \
#     ,lt_vpal_common_pkg.get_comn_value_name('BRANCH_TYPES',bm.branch_type) BRANCH_TYPE_VALUE \
#     ,bm.BILLABLE_LOCATION,bm.SHIPPING_LOCATION  \
#     ,lt_vpal_common_pkg.get_comn_value_name('STATUS_MASTER',bm.STATUS) status_value \
#     ,cm.COMPANY_NAME as company_name,nvl2(ms.STATE_ID,ms.STATE_NAME||' ( '||ms.STATE_CODE||' )','')as state_value \
#     ,nvl2(bm.MANAGER_ID, em.first_name || ' '|| em.LAST_NAME||' '||'( '||em.EMPLOYEE_NUMBER||' )',null) AS manager_Name \
#     ,em.EMPLOYEE_NUMBER as manager_Code,em.OFFICIAL_EMAIL as manager_Offical_Email_Id, em.EMPLOYEE_NUMBER as manager_Code  \
#     FROM LT_MAST_BRANCHES bm , LT_MAST_EMPLOYEES em ,LT_MAST_STATES ms,LT_VEND_COMPANY_MASTER cm  \
#     WHERE  bm.Manager_id=em.EMPLOYEE_ID(+) AND bm.STATE_ID = ms.STATE_ID (+) \
#     AND bm.COMPANY_ID = cm.COMPANY_ID (+)  AND bm.status = NVL(?,bm.status)  \
#     AND   bm.start_date >= NVL(to_date( ?,'dd-mm-yyyy'),bm.start_date)  \
#AND   NVL(bm.end_date,now()) <= NVL(to_date( ?,'dd-mm-yyyy'),NVL(bm.end_date,now())) AND bm.COMPANY_ID = ?

getLtMastBranchesDataForReport = SELECT bm.BRANCH_ID, \
       bm.BRANCH_CODE, \
       bm.BRANCH_NAME, \
       bm.CITY, \
       bm.REGION, \
       get_comn_value_name('COUNTRY_MASTER', bm.country) AS COUNTRY_VALUE, \
       bm.REPORTING_BRANCH, \
       bm.OPENING_DATE, \
       bm.STATE_CODE, \
       bm.GST_REG_NO, \
       bm.START_DATE, \
       bm.END_DATE, \
       get_comn_value_name('BRANCH_TYPES', bm.branch_type) AS BRANCH_TYPE_VALUE, \
       bm.BILLABLE_LOCATION, \
       bm.SHIPPING_LOCATION, \
       get_comn_value_name('STATUS_MASTER', bm.STATUS) AS status_value, \
       cm.COMPANY_NAME AS company_name, \
       IFNULL(CONCAT(ms.STATE_NAME, ' (', ms.STATE_CODE, ')'), '') AS state_value, \
       IFNULL(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'), NULL) AS manager_Name, \
       em.EMPLOYEE_NUMBER AS manager_Code, \
       em.OFFICIAL_EMAIL AS manager_Official_Email_Id \
FROM LT_MAST_BRANCHES bm \
LEFT JOIN LT_MAST_EMPLOYEES em ON bm.MANAGER_ID = em.EMPLOYEE_ID \
LEFT JOIN LT_MAST_STATES ms ON bm.STATE_ID = ms.STATE_ID \
LEFT JOIN LT_VEND_COMPANY_MASTER cm ON bm.COMPANY_ID = cm.COMPANY_ID \
WHERE bm.status = IFNULL(?, bm.status) \
  AND bm.start_date >= IFNULL(STR_TO_DATE(?, '%d-%m-%Y'), bm.start_date) \
  AND IFNULL(bm.end_date, NOW()) <= IFNULL(STR_TO_DATE(?, '%d-%m-%Y'), IFNULL(bm.end_date, NOW())) \
  AND bm.COMPANY_ID = ?

#_______________________________________________________________________________________________________________________

#Lexa Application Expense nature master queries Date 27-June-2024

getLtMastExpenseTypesLikeName = select * from lt_mast_expense_types lmet \
WHERE  ( UPPER(lmet.EXPENSE_NATURE) LIKE ? OR UPPER(lmet.EXPENSE_DESCRIPTION) LIKE ? ) \
AND UPPER(lmet.status) = 'ACTIVE' \
AND lmet.START_DATE <= now() \
AND (lmet.END_DATE IS NULL OR lmet.END_DATE >= now()) \
AND lmet.company_id = ?

#getExpenseTypesData = select  *  \
#from (SELECT a.*,ROWNUM RNUM from( \
#select met.EXPENSE_TYPE_ID,met.EXPENSE_NATURE,met.EXPENSE_DESCRIPTION,cmvt.value_name as EXPENSE_TYPE,\
#met.GL_CODE,met.GL_CODE_DESC,cmv.value_name as STATUS,met.START_DATE,met.END_DATE \
#from LT_MAST_EXPENSE_TYPES  met,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvt, \
#LT_MAST_COMN_MASTER cm ,LT_MAST_COMN_MASTER cms \
#where cmv.VALUE_CODE(+)= met.STATUS  \
#AND cms.MASTER_NAME = 'STATUS_MASTER'\
#AND cmvt.VALUE_CODE(+)= met.EXPENSE_TYPE \
#AND cmvt.MASTER_ID = cm.MASTER_ID \
#AND cmv.MASTER_ID = cms.MASTER_ID \
#AND cm.MASTER_NAME = 'EXPENSE_TYPE' \
#AND upper(met.EXPENSE_NATURE) like nvl(?,upper(met.EXPENSE_NATURE)) \
#AND nvl(upper(met.EXPENSE_DESCRIPTION),'xxx') like  nvl(?,nvl(upper(met.EXPENSE_DESCRIPTION),'xxx')) \
#AND UPPER(met.EXPENSE_TYPE)  like nvl(?,UPPER(met.EXPENSE_TYPE)) \
#AND UPPER(met.GL_CODE)  like nvl(?,UPPER(met.GL_CODE)) \
#AND upper(met.GL_CODE_DESC) like nvl(?,upper(met.GL_CODE_DESC)) \
#AND upper(cmv.VALUE_CODE) like nvl(?,upper(cmv.VALUE_CODE))  \
#AND  TO_CHAR(met.START_DATE,'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(met.START_DATE,'DD-MM-YYYY'))  \
#AND  TO_CHAR(nvl (met.END_DATE, now() ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (met.END_DATE, now() ),'DD-MM-YYYY')) \
#order by  \
#CASE WHEN 1 = ? then upper(met.EXPENSE_NATURE) END asc, \
#CASE WHEN 11 = ? then upper(met.EXPENSE_NATURE) END desc, \
#CASE WHEN 2 = ? then upper(met.EXPENSE_DESCRIPTION) END asc, \
#CASE WHEN 12 = ? then upper(met.EXPENSE_DESCRIPTION) END desc, \
#CASE WHEN 3 = ? then upper(met.EXPENSE_TYPE) END asc, \
#CASE WHEN 13 = ? then upper(met.EXPENSE_TYPE) END desc, \
#CASE WHEN 4 = ? then upper(met.GL_CODE) END asc, \
#CASE WHEN 14 = ? then upper(met.GL_CODE) END desc, \
#CASE WHEN 5 = ? then upper(met.GL_CODE_DESC) END asc, \
#CASE WHEN 15 = ? then upper(met.GL_CODE_DESC) END desc, \
#CASE WHEN 6 = ? then upper(cmv.value_name) END asc, \
#CASE WHEN 16 = ? then upper(cmv.value_name) END desc, \
#CASE WHEN 7 = ? then met.START_DATE END asc, \
#CASE WHEN 17 = ? then met.START_DATE END desc, \
#CASE WHEN 8 = ? then met.END_DATE END asc, \
#CASE WHEN 18 = ? then met.END_DATE END desc, \
#CASE WHEN 9 = ? then met.last_update_date END desc, \
#CASE WHEN 19 = ? then met.last_update_date END asc)a  where ROWNUM <=? ) WHERE rnum >=?

#getExpenseTypesData = SELECT * \
#FROM ( \
#    SELECT  \
#        a.*,  \
#        @rownum := @rownum + 1 AS rnum  \
#    FROM ( \
#        SELECT \
#            met.expense_type_id, \
#            met.expense_nature, \
#            met.expense_description, \
#            cmvt.value_code AS expense_type, \
#            met.gl_code, \
#            met.gl_code_desc, \
#            cmv.value_name AS status, \
#            met.start_date, \
#            met.end_date \
#        FROM  \
#            lt_mast_expense_types met \
#        LEFT JOIN  \
#            lt_mast_comn_master_values cmv ON cmv.value_code = met.status \
#        LEFT JOIN  \
#            lt_mast_comn_master_values cmvt ON cmvt.value_code = met.expense_type \
#        JOIN  \
#            lt_mast_comn_master cm ON cmvt.master_id = cm.master_id AND cm.master_name = 'EXPENSE_TYPE' \
#        JOIN \
#            lt_mast_comn_master cms ON cmv.master_id = cms.master_id AND cms.master_name = 'STATUS_MASTER' \
#        WHERE \
#            UPPER(met.expense_nature) LIKE IFNULL(?, UPPER(met.expense_nature)) \
#            AND IFNULL(UPPER(met.expense_description), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(met.expense_description), 'xxx')) \
#            AND UPPER(met.expense_type) LIKE IFNULL(?, UPPER(met.expense_type)) \
#            AND UPPER(met.gl_code) LIKE IFNULL(?, UPPER(met.gl_code)) \
#            AND UPPER(met.gl_code_desc) LIKE IFNULL(?, UPPER(met.gl_code_desc)) \
#            AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
#            AND DATE_FORMAT(met.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(met.start_date, '%d-%m-%Y')) \
#            AND DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y')) \
#        ORDER BY \
#            CASE WHEN ? = 1 THEN UPPER(met.expense_nature) END ASC, \
#            CASE WHEN ? = 11 THEN UPPER(met.expense_nature) END DESC, \
#            CASE WHEN ? = 2 THEN UPPER(met.expense_description) END ASC, \
#            CASE WHEN ? = 12 THEN UPPER(met.expense_description) END DESC, \
#            CASE WHEN ? = 3 THEN UPPER(met.expense_type) END ASC, \
#            CASE WHEN ? = 13 THEN UPPER(met.expense_type) END DESC, \
#            CASE WHEN ? = 4 THEN UPPER(met.gl_code) END ASC, \
#            CASE WHEN ? = 14 THEN UPPER(met.gl_code) END DESC, \
#            CASE WHEN ? = 5 THEN UPPER(met.gl_code_desc) END ASC, \
#            CASE WHEN ? = 15 THEN UPPER(met.gl_code_desc) END DESC, \
#            CASE WHEN ? = 6 THEN UPPER(cmv.value_name) END ASC, \
#            CASE WHEN ? = 16 THEN UPPER(cmv.value_name) END DESC, \
#            CASE WHEN ? = 7 THEN met.start_date END ASC, \
#            CASE WHEN ? = 17 THEN met.start_date END DESC, \
#            CASE WHEN ? = 8 THEN met.end_date END ASC, \
#            CASE WHEN ? = 18 THEN met.end_date END DESC, \
#            CASE WHEN ? = 9 THEN met.last_update_date END DESC, \
#            CASE WHEN ? = 19 THEN met.last_update_date END ASC \
#    ) a \
#    JOIN (SELECT @rownum := 0) r \
#    WHERE @rownum <= ? \
#) AS result \
#WHERE rnum >= ?

#getExpenseTypesData = SELECT * \
#FROM ( \
#    SELECT  \
#        a.*,  \
#        @rownum := @rownum + 1 AS rnum  \
#    FROM ( \
#        SELECT \
#            met.expense_type_id, \
#            met.expense_nature, \
#            met.expense_description, \
#            cmvt.value_code AS expense_type, \
#            cmv.value_name AS status, \
#            met.start_date, \
#            met.end_date \
#        FROM  \
#            lt_mast_expense_types met \
#        LEFT JOIN  \
#            lt_mast_comn_master_values cmv ON cmv.value_code = met.status \
#        LEFT JOIN  \
#            lt_mast_comn_master_values cmvt ON cmvt.value_code = met.expense_type \
#        JOIN  \
#            lt_mast_comn_master cm ON cmvt.master_id = cm.master_id AND cm.master_name = 'EXPENSE_TYPE' \
#        JOIN \
#            lt_mast_comn_master cms ON cmv.master_id = cms.master_id AND cms.master_name = 'STATUS_MASTER' \
#        WHERE \
#        	met.company_id = ? \
#            AND UPPER(met.expense_nature) LIKE IFNULL(?, UPPER(met.expense_nature)) \
#            AND IFNULL(UPPER(met.expense_description), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(met.expense_description), 'xxx')) \
#            AND UPPER(met.expense_type) LIKE IFNULL(?, UPPER(met.expense_type)) \
#            AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
#            AND DATE_FORMAT(met.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(met.start_date, '%d-%m-%Y')) \
#            AND DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y')) \
#        ORDER BY \
#            CASE WHEN ? = 1 THEN UPPER(met.expense_nature) END ASC, \
#            CASE WHEN ? = 11 THEN UPPER(met.expense_nature) END DESC, \
#            CASE WHEN ? = 2 THEN UPPER(met.expense_description) END ASC, \
#            CASE WHEN ? = 12 THEN UPPER(met.expense_description) END DESC, \
#            CASE WHEN ? = 3 THEN UPPER(met.expense_type) END ASC, \
#            CASE WHEN ? = 13 THEN UPPER(met.expense_type) END DESC, \
#            CASE WHEN ? = 6 THEN UPPER(cmv.value_name) END ASC, \
#            CASE WHEN ? = 16 THEN UPPER(cmv.value_name) END DESC, \
#            CASE WHEN ? = 7 THEN met.start_date END ASC, \
#            CASE WHEN ? = 17 THEN met.start_date END DESC, \
#            CASE WHEN ? = 8 THEN met.end_date END ASC, \
#            CASE WHEN ? = 18 THEN met.end_date END DESC, \
#            CASE WHEN ? = 9 THEN met.last_update_date END DESC, \
#            CASE WHEN ? = 19 THEN met.last_update_date END ASC \
#    ) a \
#    JOIN (SELECT @rownum := 0) r \
#    WHERE @rownum <= ? \
#) AS result \
#WHERE rnum >= ?

getExpenseTypesData = SELECT *  \
FROM (  \
    SELECT   \
        a.*,   \
        @rownum := @rownum + 1 AS rnum   \
    FROM (  \
        SELECT  \
            met.expense_type_id,  \
            met.expense_nature,  \
            met.expense_description,  \
            cmvt.value_code AS expense_type,  \
            lmga.account_name as glAccountName,  \
            cmv.value_name AS status,  \
            met.start_date,  \
            met.end_date  \
        FROM   \
            lt_mast_expense_types met  \
        left join  \
        lt_mast_gl_accounts lmga on lmga.gl_account_id = met.gl_account_id  \
        LEFT JOIN   \
            lt_mast_comn_master_values cmv ON cmv.value_code = met.status  \
        LEFT JOIN   \
            lt_mast_comn_master_values cmvt ON cmvt.value_code = met.expense_type  \
        JOIN   \
            lt_mast_comn_master cm ON cmvt.master_id = cm.master_id AND cm.master_name = 'EXPENSE_TYPE'  \
        JOIN  \
            lt_mast_comn_master cms ON cmv.master_id = cms.master_id AND cms.master_name = 'STATUS_MASTER'  \
        WHERE  \
            met.company_id = ?  \
            AND UPPER(met.expense_nature) LIKE IFNULL(?, UPPER(met.expense_nature))  \
            AND IFNULL(UPPER(met.expense_description), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(met.expense_description), 'xxx'))  \
            AND UPPER(met.expense_type) LIKE IFNULL(?, UPPER(met.expense_type))  \
            AND UPPER(lmga.account_name) LIKE IFNULL(?, UPPER(lmga.account_name))  \
            AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code))  \
            AND DATE_FORMAT(met.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(met.start_date, '%d-%m-%Y'))  \
            AND DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y'))  \
        ORDER BY  \
            CASE WHEN ? = 1 THEN UPPER(met.expense_nature) END ASC,  \
            CASE WHEN ? = 11 THEN UPPER(met.expense_nature) END DESC,  \
            CASE WHEN ? = 2 THEN UPPER(met.expense_description) END ASC,  \
            CASE WHEN ? = 12 THEN UPPER(met.expense_description) END DESC,  \
            CASE WHEN ? = 3 THEN UPPER(met.expense_type) END ASC,  \
            CASE WHEN ? = 13 THEN UPPER(met.expense_type) END DESC,  \
            CASE WHEN ? = 5 THEN UPPER(lmga.account_name) END ASC,  \
            CASE WHEN ? = 15 THEN UPPER(lmga.account_name) END DESC,  \
            CASE WHEN ? = 6 THEN UPPER(cmv.value_name) END ASC,  \
            CASE WHEN ? = 16 THEN UPPER(cmv.value_name) END DESC,  \
            CASE WHEN ? = 7 THEN met.start_date END ASC,  \
            CASE WHEN ? = 17 THEN met.start_date END DESC,  \
            CASE WHEN ? = 8 THEN met.end_date END ASC,  \
            CASE WHEN ? = 18 THEN met.end_date END DESC,  \
            CASE WHEN ? = 9 THEN met.last_update_date END DESC,  \
            CASE WHEN ? = 19 THEN met.last_update_date END ASC  \
    ) a  \
    JOIN (SELECT @rownum := 0) r  \
    WHERE @rownum <= ?  \
) AS result  \
WHERE rnum >= ?


#getExpenseTypesCount = select count(met.EXPENSE_TYPE_ID) \
#from LT_MAST_EXPENSE_TYPES  met,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvt, \
#LT_MAST_COMN_MASTER cm ,LT_MAST_COMN_MASTER cms \
#where cmv.VALUE_CODE(+)= met.STATUS  \
#AND cms.MASTER_NAME = 'STATUS_MASTER'\
#AND cmvt.VALUE_CODE(+)= met.EXPENSE_TYPE \
#AND cmvt.MASTER_ID = cm.MASTER_ID \
#AND cmv.MASTER_ID = cms.MASTER_ID \
#AND cm.MASTER_NAME = 'EXPENSE_TYPE' \
#AND upper(met.EXPENSE_NATURE) like nvl(?,upper(met.EXPENSE_NATURE)) \
#AND nvl(upper(met.EXPENSE_DESCRIPTION),'xxx') like  nvl(?,nvl(upper(met.EXPENSE_DESCRIPTION),'xxx'))  \
#AND UPPER(met.EXPENSE_TYPE)  like nvl(?,UPPER(met.EXPENSE_TYPE)) \
#AND UPPER(met.GL_CODE)  like nvl(?,UPPER(met.GL_CODE)) \
#AND upper(met.GL_CODE_DESC) like nvl(?,upper(met.GL_CODE_DESC)) \
#AND upper(cmv.VALUE_CODE) like nvl(?,upper(cmv.VALUE_CODE))  \
#AND  TO_CHAR(met.START_DATE,'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(met.START_DATE,'DD-MM-YYYY'))  \
#AND  TO_CHAR(nvl (met.END_DATE, now() ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (met.END_DATE, now() ),'DD-MM-YYYY'))

#getExpenseTypesCount = SELECT \
#    COUNT(met.expense_type_id) \
#FROM \
#    lt_mast_expense_types met \
#LEFT JOIN \
#    lt_mast_comn_master_values cmv ON cmv.value_code = met.status \
#LEFT JOIN \
#    lt_mast_comn_master_values cmvt ON cmvt.value_code = met.expense_type \
#JOIN \
#    lt_mast_comn_master cm ON cmvt.master_id = cm.master_id AND cm.master_name = 'EXPENSE_TYPE' \
#JOIN \
#    lt_mast_comn_master cms ON cmv.master_id = cms.master_id AND cms.master_name = 'STATUS_MASTER' \
#WHERE \
#    UPPER(met.expense_nature) LIKE IFNULL(?, UPPER(met.expense_nature)) \
#    AND IFNULL(UPPER(met.expense_description), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(met.expense_description), 'xxx')) \
#    AND UPPER(met.expense_type) LIKE IFNULL(?, UPPER(met.expense_type)) \
#    AND UPPER(met.gl_code) LIKE IFNULL(?, UPPER(met.gl_code)) \
#    AND UPPER(met.gl_code_desc) LIKE IFNULL(?, UPPER(met.gl_code_desc)) \
#    AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
#    AND DATE_FORMAT(met.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(met.start_date, '%d-%m-%Y')) \
#    AND DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y'))

getExpenseTypesCount = SELECT \
    COUNT(met.expense_type_id) \
FROM \
    lt_mast_expense_types met \
left join \
	lt_mast_gl_accounts lmga on lmga.GL_ACCOUNT_ID = met.gl_account_id \
LEFT JOIN \
    lt_mast_comn_master_values cmv ON cmv.value_code = met.status \
LEFT JOIN \
    lt_mast_comn_master_values cmvt ON cmvt.value_code = met.expense_type \
JOIN \
    lt_mast_comn_master cm ON cmvt.master_id = cm.master_id AND cm.master_name = 'EXPENSE_TYPE' \
JOIN \
    lt_mast_comn_master cms ON cmv.master_id = cms.master_id AND cms.master_name = 'STATUS_MASTER' \
WHERE \
	met.company_id = ? \
    AND UPPER(met.expense_nature) LIKE IFNULL(?, UPPER(met.expense_nature)) \
    AND IFNULL(UPPER(met.expense_description), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(met.expense_description), 'xxx')) \
    AND UPPER(met.expense_type) LIKE IFNULL(?, UPPER(met.expense_type)) \
    AND UPPER(lmga.account_name) LIKE IFNULL(?, UPPER(lmga.account_name)) \
    AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
    AND DATE_FORMAT(met.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(met.start_date, '%d-%m-%Y')) \
    AND DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(met.end_date, NOW()), '%d-%m-%Y'))

save = INSERT INTO lt_mast_expense_types \
(Expense_Type_Id ,Expense_Nature,Expense_Description,Expense_Type,GL_Code,GL_Code_Desc, \
STATUS,CREATION_DATE,Start_Date, End_Date, Created_by, \
Last_update_login, Last_updated_by, Last_update_date,PURPOSE_REQ ) \
VALUES(LT_MAST_EXPENSE_TYPES_S.nextval,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

#getLtMastExpenseTypesByExpenseNature = SELECT * FROM lt_mast_expense_types ext  \
#where (ext.status = 'Active' OR ext.status = 'ACTIVE') \
#AND (ext.start_date <= now() \
#AND (ext.end_date is null or ext.end_date > now()) ) \
#AND upper(ext.EXPENSE_NATURE) = ?

getLtMastExpenseTypesByExpenseNature = SELECT \
    * \
FROM \
    lt_mast_expense_types ext \
WHERE \
    (ext.status = 'Active' OR ext.status = 'ACTIVE') \
    AND ext.start_date <= NOW() \
    AND (ext.end_date IS NULL OR ext.end_date > NOW()) \
    AND UPPER(ext.expense_nature) = ? \
    AND ext.company_id  = ?

#getLtMastExpenseTypesByGlCode = SELECT * FROM lt_mast_expense_types ext  \
#where (ext.status = 'Active' OR ext.status = 'ACTIVE') \
#AND (ext.start_date <= now() \
#AND (ext.end_date is null or ext.end_date > now()) ) \
#AND upper(ext.GL_CODE) = ?

getLtMastExpenseTypesByGlCode = SELECT \
    * \
FROM \
    lt_mast_expense_types ext \
WHERE \
    (ext.status = 'Active' OR ext.status = 'ACTIVE') \
    AND ext.start_date <= NOW() \
    AND (ext.end_date IS NULL OR ext.end_date > NOW()) \
    AND UPPER(ext.gl_code) = ?

#getExpenseTypeById = SELECT * FROM lt_mast_expense_types ext  WHERE ext.Expense_Type_Id = ? 

getExpenseTypeById = SELECT ext.*,lmga.account_code as glAccountCode ,lmga.account_name as glAccountName \
FROM lt_mast_expense_types ext  \
join lt_mast_gl_accounts lmga \
where ext.gl_account_id = lmga.GL_ACCOUNT_ID \
AND ext.Expense_Type_Id = ?

delete = DELETE FROM lt_mast_expense_types WHERE Expense_Type_Id = ?

update = UPDATE lt_mast_expense_types SET Expense_Nature = ? ,Expense_Description = ?,Expense_Type = ?, \
STATUS =?,CREATION_DATE =?,START_DATE =?,END_DATE =?, created_by =?, \
LAST_UPDATE_LOGIN =?, LAST_UPDATED_BY =?, LAST_UPDATE_DATE = ? ,GL_ACCOUNT_ID = ? \
WHERE Expense_Type_Id = ?

#_________________________________________________________________________

#Lexa Application Project master queries Date 28-June-2024

getLtMastCustomersLikeName = select lmc.CUSTOMER_ID , lmc.CUSTOMER_NUMBER ,lmc.CUSTOMER_NAME ,lmc.STATUS , \
lmc.CUSTOMER_CLASS_CODE , lmc.LEGAL_STATUS , lmc.PAN_NO , lmc.TAN_NO , lmc.CUSTOMER_TYPE , \
lmc.RELATED_PARTY , lmc.CUSTOMER_GL_CLASS , lmc.ACCOUNT_TYPE , lmc.ACCOUNT_DESC , lmc.COMPANY_ID , lmc.CREATED_BY , \
lmc.CREATION_DATE , lmc.CREATION_DATE , lmc.LAST_UPDATE_LOGIN , lmc.LAST_UPDATED_BY , lmc.LAST_UPDATE_DATE , lmc.INITIATOR_ID \
from lt_mast_customers lmc  \
WHERE  ( UPPER(lmc.CUSTOMER_NUMBER) LIKE ? OR UPPER(lmc.CUSTOMER_NAME) LIKE ? ) AND lmc.COMPANY_ID = ? \
AND UPPER(lmc.status) = 'ACTIVE' 

getLtMastProjectsLikeName = SELECT * FROM LT_MAST_PROJECTS lmp \
WHERE  ( UPPER(lmp.PROJECT_NUMBER) LIKE ? OR UPPER(lmp.PROJECT_NAME) LIKE ? ) \
AND UPPER(lmp.status) = 'ACTIVE'  \
AND lmp.START_DATE <= now()  \
AND (lmp.END_DATE IS NULL OR lmp.END_DATE >= now()) \
AND lmp.company_id = ?

#listAllActiveLtMastProjectDao = SELECT v.PROJECT_ID,v.PROJECT_NUMBER,v.PROJECT_NAME, \
#v.PROJECT_DESC, v.CUSTOMER_ID,v.PM_ID \
#FROM LT_MAST_PROJECTS v WHERE v.start_date <= now() AND (v.end_date is null or v.end_date >= now())

listAllActiveLtMastProjectDao = SELECT \
    v.project_id, \
    v.project_number, \
    v.project_name, \
    v.project_desc, \
    v.customer_id, \
    v.pm_id \
FROM \
    lt_mast_projects v \
WHERE \
    v.start_date <= NOW() \
    AND (v.end_date IS NULL OR v.end_date >= NOW())

#getLtMastProjectsDataTable = select  *  from  \
#(SELECT a.*,ROWNUM RNUM from ( select pm.PROJECT_ID,pm.PROJECT_NUMBER,pm.PROJECT_NAME,  \
#pm.PROJECT_DESC,cmv.value_name as STATUS,pm.START_DATE,pm.END_DATE, pm.CUSTOMER_ID,  pm.PM_ID , \
#nvl2(pm.CUSTOMER_ID,( cm.CUSTOMER_NAME||' '||'('||cm.CUSTOMER_NUMBER||')'), null ) AS customer_name,  \
#nvl2(pm.PM_ID ,(me.first_name||' '|| me.LAST_NAME||' '||'('||me.EMPLOYEE_NUMBER||')'),null) AS employee_name \
#from LT_MAST_PROJECTS pm,LT_MAST_COMN_MASTER cm, LT_MAST_COMN_MASTER_VALUES cmv ,LT_MAST_CUSTOMERS cm,lt_mast_employees me \
#where cmv.value_code(+)=pm.status \
#AND cm.MASTER_ID = cmv.MASTER_ID \
#AND cm.MASTER_NAME = 'STATUS_MASTER' \
#and pm.CUSTOMER_ID = cm.CUSTOMER_ID(+)  \
#and pm.PM_ID = me.EMPLOYEE_ID(+)  \
#AND upper(pm.PROJECT_NUMBER) like  nvl(?,upper(pm.PROJECT_NUMBER))   \
#AND upper(pm.PROJECT_NAME) like  nvl(?,upper(pm.PROJECT_NAME))   \
#AND nvl(upper(pm.PROJECT_DESC),'xxx') like nvl(?,nvl(upper(pm.PROJECT_DESC),'xxx'))  \
#AND upper(cmv.value_code) like nvl(?,upper(cmv.value_code))   \
#AND  TO_CHAR(pm.START_DATE,'DD-MM-YYYY')  LIKE nvl(?, TO_CHAR(pm.START_DATE,'DD-MM-YYYY'))   \
#AND  TO_CHAR(nvl (pm.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (pm.END_DATE, now()+1 ),'DD-MM-YYYY'))  \
#order by   \
#CASE WHEN 2 = ? then pm.PROJECT_NUMBER END asc,  \
#CASE WHEN 12 = ? then pm.PROJECT_NUMBER END desc,  \
#CASE WHEN 3 = ? then upper(pm.PROJECT_NAME) END asc,  \
#CASE WHEN 13 = ? then upper(pm.PROJECT_NAME) END desc, \
#CASE WHEN 4 = ? then upper(pm.PROJECT_DESC) END asc,  \
#CASE WHEN 14 = ? then upper(pm.PROJECT_DESC) END desc,  \
#CASE WHEN 5 = ? then upper(cmv.value_code) END asc,  \
#CASE WHEN 15 = ? then upper(cmv.value_code) END desc, \
#CASE WHEN 6 = ? then pm.START_DATE END asc,  \
#CASE WHEN 16 = ? then pm.START_DATE END desc,  \
#CASE WHEN 7 = ? then pm.END_DATE END asc,  \
#CASE WHEN 17 = ? then pm.END_DATE END desc,  \
#CASE WHEN 8 = ? then pm.last_update_date END desc,  \
#CASE WHEN 18 = ? then pm.last_update_date END ASC \
#)a where ROWNUM <=? ) WHERE rnum >=?

getLtMastProjectsDataTable = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS rnum \
    FROM ( \
        SELECT \
            pm.project_id, \
            pm.project_number, \
            pm.project_name, \
            pm.project_desc, \
            cmv.value_name AS status, \
            pm.start_date, \
            pm.end_date, \
            pm.customer_id, \
            pm.pm_id, \
            IF(pm.customer_id IS NOT NULL, CONCAT(cm.customer_name, ' (', cm.customer_number, ')'), NULL) AS customer_name, \
            IF(pm.pm_id IS NOT NULL, CONCAT(me.first_name, ' ', me.last_name, ' (', me.employee_number, ')'), NULL) AS employee_name  \
        FROM \
            lt_mast_projects pm \
        LEFT JOIN  \
            lt_mast_comn_master_values cmv ON cmv.value_code = pm.status \
        LEFT JOIN  \
            lt_mast_customers cm ON pm.customer_id = cm.customer_id \
        LEFT JOIN \
            lt_mast_employees me ON pm.pm_id = me.employee_id \
        JOIN  \
            lt_mast_comn_master lmcm ON lmcm.master_id = cmv.master_id AND lmcm.master_name = 'STATUS_MASTER' \
        WHERE \
        pm.company_id = ? \
            AND UPPER(pm.project_number) LIKE IFNULL(?, UPPER(pm.project_number)) \
            AND UPPER(pm.project_name) LIKE IFNULL(?, UPPER(pm.project_name)) \
            AND IFNULL(UPPER(pm.project_desc), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(pm.project_desc), 'xxx')) \
            AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
            AND DATE_FORMAT(pm.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(pm.start_date, '%d-%m-%Y')) \
            AND DATE_FORMAT(IFNULL(pm.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(pm.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
        ORDER BY \
            CASE WHEN ? = 2 THEN pm.project_number END ASC, \
            CASE WHEN ? = 12 THEN pm.project_number END DESC, \
            CASE WHEN ? = 3 THEN UPPER(pm.project_name) END ASC, \
            CASE WHEN ? = 13 THEN UPPER(pm.project_name) END DESC, \
            CASE WHEN ? = 4 THEN UPPER(pm.project_desc) END ASC, \
            CASE WHEN ? = 14 THEN UPPER(pm.project_desc) END DESC, \
            CASE WHEN ? = 5 THEN UPPER(cmv.value_code) END ASC, \
            CASE WHEN ? = 15 THEN UPPER(cmv.value_code) END DESC, \
            CASE WHEN ? = 6 THEN pm.start_date END ASC, \
            CASE WHEN ? = 16 THEN pm.start_date END DESC, \
            CASE WHEN ? = 7 THEN pm.end_date END ASC, \
            CASE WHEN ? = 17 THEN pm.end_date END DESC, \
            CASE WHEN ? = 8 THEN pm.last_update_date END DESC, \
            CASE WHEN ? = 18 THEN pm.last_update_date END ASC \
    ) a \
    JOIN (SELECT @rownum := 0) r \
    WHERE @rownum <= ? \
) AS result \
WHERE rnum >= ?

#getLtMastProjectsCount = select count(pm.PROJECT_ID) \
#from LT_MAST_PROJECTS pm,LT_MAST_COMN_MASTER_VALUES cmv ,LT_MAST_CUSTOMERS cm,lt_mast_employees me , \
#LT_MAST_COMN_MASTER_VALUES cmvt  , LT_MAST_COMN_MASTER lmcm \
#where cmv.value_code(+)=pm.status  \
#AND lmcm.MASTER_ID = cmv.MASTER_ID \
#AND lmcm.MASTER_NAME = 'STATUS_MASTER' \
#and cmvt.value_code(+)=me.title  \
#and pm.CUSTOMER_ID = cm.CUSTOMER_ID(+) \
#and pm.PM_ID = me.EMPLOYEE_ID(+) \
#AND upper(pm.PROJECT_NUMBER) like  nvl(?,upper(pm.PROJECT_NUMBER))  \
#AND upper(pm.PROJECT_NAME) like  nvl(?,upper(pm.PROJECT_NAME))  \
#AND nvl(upper(pm.PROJECT_DESC),'xxx') like nvl(?,nvl(upper(pm.PROJECT_DESC),'xxx'))  \
#AND upper(cmv.value_code) like nvl(?,upper(cmv.value_code))  \
#AND  TO_CHAR(pm.START_DATE,'DD-MM-YYYY')  LIKE nvl(?, TO_CHAR(pm.START_DATE,'DD-MM-YYYY'))  \
#AND  TO_CHAR(nvl (pm.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (pm.END_DATE, now()+1 ),'DD-MM-YYYY')) \

getLtMastProjectsCount = SELECT \
    COUNT(pm.project_id) \
FROM \
    lt_mast_projects pm \
LEFT JOIN \
    lt_mast_comn_master_values cmv ON cmv.value_code = pm.status \
LEFT JOIN \
    lt_mast_customers cm ON pm.customer_id = cm.customer_id \
LEFT JOIN \
    lt_mast_employees me ON pm.pm_id = me.employee_id \
LEFT JOIN \
    lt_mast_comn_master_values cmvt ON cmvt.value_code = me.title \
JOIN  \
    lt_mast_comn_master lmcm ON lmcm.master_id = cmv.master_id AND lmcm.master_name = 'STATUS_MASTER' \
WHERE \
	pm.company_id = ? \
    AND UPPER(pm.project_number) LIKE IFNULL(?, UPPER(pm.project_number)) \
    AND UPPER(pm.project_name) LIKE IFNULL(?, UPPER(pm.project_name)) \
    AND IFNULL(UPPER(pm.project_desc), 'xxx') LIKE IFNULL(?, IFNULL(UPPER(pm.project_desc), 'xxx')) \
    AND UPPER(cmv.value_code) LIKE IFNULL(?, UPPER(cmv.value_code)) \
    AND DATE_FORMAT(pm.start_date, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(pm.start_date, '%d-%m-%Y')) \
    AND DATE_FORMAT(IFNULL(pm.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(pm.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y'))

#isFeildsExistsProj = SELECT PROJECT_ID,PROJECT_NUMBER,PROJECT_NAME FROM LT_MAST_PROJECTS \
#WHERE PROJECT_NUMBER =? OR PROJECT_NAME =?

isFeildsExistsProj = SELECT \
    project_id, \
    project_number, \
    project_name \
FROM \
    lt_mast_projects \
WHERE \
    project_number = ? \
    OR project_name = ?

#checkProjectTaskValuesDetails = SELECT lpt.TASK_CODE, lpt.TASK_NAME, lpt.TASK_ID FROM Lt_Mast_Project_Tasks lpt \
#where lpt.TASK_CODE = ?

checkProjectTaskValuesDetails = SELECT \
    lpt.task_code, \
    lpt.task_name, \
    lpt.task_id  \
FROM \
    lt_mast_project_tasks lpt \
WHERE \
    lpt.task_code = ?

getAllEmployee = SELECT employee_id AS valueCode, \
CONCAT(first_name, ' ', last_name) AS valueName \
FROM lt_mast_employees

getAllCustomer =  SELECT customer_id AS valueCode, \
customer_name AS valueName, \
customer_number AS customerCode \
FROM lt_mast_customers \
LIMIT 500

#getByIdProject = SELECT p.PROJECT_ID,p.PROJECT_NUMBER,p.PROJECT_NAME,p.PROJECT_DESC,p.STATUS, \
#p.START_DATE,p.END_DATE,p.CREATED_BY,p.CREATION_DATE,p.LAST_UPDATE_LOGIN,p.LAST_UPDATED_BY, \
#p.LAST_UPDATE_DATE,p.CUSTOMER_ID,p.PM_ID as project_manager_id, \
#nvl2(p.PM_ID,cmv.value_name ||' '|| e.FIRST_NAME ||' '|| e.LAST_NAME || ' ( '|| e.EMPLOYEE_NUMBER||' )',null) as EMPLOYEE_NAME \
#FROM LT_MAST_PROJECTS p,LT_MAST_EMPLOYEES e,LT_MAST_COMN_MASTER_VALUES cmv  \
#WHERE p.PM_ID = e.EMPLOYEE_ID(+) \
#AND e.title = cmv.value_code(+) \
#AND p.PROJECT_ID = ?

getByIdProject = SELECT \
    p.PROJECT_ID, \
    p.PROJECT_NUMBER, \
    p.PROJECT_NAME, \
    p.PROJECT_DESC, \
    p.STATUS, \
    p.START_DATE, \
    p.END_DATE, \
    p.CREATED_BY, \
    p.CREATION_DATE, \
    p.LAST_UPDATE_LOGIN, \
    p.LAST_UPDATED_BY, \
    p.LAST_UPDATE_DATE, \
    p.CUSTOMER_ID, \
    p.PM_ID AS project_manager_id, \
    IF(p.PM_ID IS NOT NULL, CONCAT(cmv.value_name, ' ', e.FIRST_NAME, ' ', e.LAST_NAME, ' ( ', e.EMPLOYEE_NUMBER, ' )'), NULL) AS EMPLOYEE_NAME, \
    p.company_id as companyId \
FROM \
    LT_MAST_PROJECTS p \
LEFT JOIN \
    LT_MAST_EMPLOYEES e ON p.PM_ID = e.EMPLOYEE_ID \
LEFT JOIN \
    LT_MAST_COMN_MASTER_VALUES cmv ON e.title = cmv.value_code \
WHERE \
    p.PROJECT_ID = ?
 
#getByIdTask =  select pt.PROJECT_ID,pt.TASK_ID,pt.TASK_CODE,pt.TASK_NAME,pt.TASK_DESCRIPTION, \
#cmv.value_name as status,pt.START_DATE,pt.END_DATE,pt.CREATED_BY,pt.CREATION_DATE,  \
#pt.LAST_UPDATE_LOGIN,pt.LAST_UPDATED_BY,pt.LAST_UPDATE_DATE  \
#from LT_MAST_PROJECT_TASKS pt, lt_mast_comn_master_values cmv ,LT_MAST_COMN_MASTER CM \
# where pt.project_id= ? AND pt.status = cmv.VALUE_CODE(+) \
#AND cm.MASTER_ID = cmv.MASTER_ID(+) \
#AND cm.MASTER_NAME = 'STATUS_MASTER'

getByIdTask =  SELECT \
    pt.project_id, \
    pt.task_id, \
    pt.task_code, \
    pt.task_name, \
    pt.task_description, \
    cmv.value_code AS status, \
    pt.start_date, \
    pt.end_date, \
    pt.created_by, \
    pt.creation_date, \
    pt.last_update_login, \
    pt.last_updated_by, \
    pt.last_update_date \
FROM  \
    lt_mast_project_tasks pt \
LEFT JOIN \
    lt_mast_comn_master_values cmv ON pt.status = cmv.value_code \
LEFT JOIN \
    lt_mast_comn_master cm ON cm.master_id = cmv.master_id \
WHERE \
    pt.project_id = ? \
    AND cm.master_name = 'STATUS_MASTER'

#findLtMastProjectTasksByProjectId = select PROJECT_ID,TASK_ID,TASK_CODE,TASK_NAME,TASK_DESCRIPTION,\
#STATUS,START_DATE,END_DATE \
#from LT_MAST_PROJECT_TASKS p \
#where P.PROJECT_ID= ? \
#AND p.START_DATE <= now() AND (p.END_DATE IS NULL OR p.END_DATE >= now())

findLtMastProjectTasksByProjectId = SELECT \
    project_id, \
    task_id, \
    task_code, \
    task_name, \
    task_description, \
    status, \
    start_date, \
    end_date \
FROM \
    lt_mast_project_tasks p \
WHERE \
    p.project_id = ? 

#findLtMastProjectTasksByProjectId = SELECT \
#    project_id, \
#    task_id, \
#    task_code, \
#    task_name, \
#    task_description, \
#    status, \
#    start_date, \
#    end_date \
#FROM  \
#    lt_mast_project_tasks p \
#WHERE \
#    p.project_id = ?  \
#    AND p.start_date <= NOW()  \
#    AND (p.end_date IS NULL OR p.end_date >= NOW())

 
#______________________________________________________________________Expense header queries

#getCountLtExpExpenseHeaders = SELECT count(EH.EXP_HEADER_ID)  \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,lt_mast_comn_master_values cmvt, \
#LT_MAST_COMN_MASTER_VALUES CMVS,LT_MAST_EMPLOYEES em ,  \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav  \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)  \
#AND em.title = cmvt.value_code(+)  \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+)  \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)  \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+)  \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)   \
#AND cmvv.value_code(+)=eh.expense_category  \
#AND eh.expense_category  IN ( ? ,?)  \
#AND cmvc.value_code(+)=eh.Currency_Code  \
#AND cmvs.value_code(+)=eh.status  \
#AND eh.EMPLOYEE_ID = ?  \
#AND eh.EMPLOYEE_ID = em.employee_id  \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY')  \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)   \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))   \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))  \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))   \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY'))  \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')  \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY'))

getCountLtExpExpenseHeaders = SELECT  \
    COUNT(eh.exp_header_id)  \
FROM  \
    lt_exp_expense_headers eh  \
    LEFT JOIN lt_mast_divisions d ON eh.division_id = d.division_id  \
    LEFT JOIN lt_mast_branches mb ON eh.location_id = mb.branch_id  \
    LEFT JOIN lt_mast_cost_centers cc ON eh.cost_center_id = cc.cost_center_id  \
    LEFT JOIN lt_mast_vendors lmv ON eh.vendor_id = lmv.vendor_id  \
    LEFT JOIN lt_mast_vendor_addresses mva ON eh.vendor_add_id = mva.vendor_add_id  \
    LEFT JOIN lt_mast_comn_master_values cmvv ON cmvv.value_code = eh.expense_category \
    AND cmvv.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'EXPENSE_CATEGORY') \
    LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.currency_code  \
    AND cmvc.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'CURRENCY_MASTER')  \
    LEFT JOIN lt_mast_comn_master_values cmvs ON cmvs.value_code = eh.status  \
    AND cmvs.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'STATUS_MASTER')  \
    LEFT JOIN lt_mast_employees em ON eh.employee_id = em.employee_id  \
    LEFT JOIN lt_mast_comn_master_values mvav  ON mva.country = mvav.value_code \
WHERE  \
    eh.expense_category IN (?, ?)  \
    AND eh.employee_id = ? \
    AND eh.expense_number LIKE COALESCE(?, eh.expense_number)  \
    AND UPPER(cmvv.value_name) LIKE COALESCE(?, UPPER(cmvv.value_name)) \
    AND COALESCE(eh.expense_amount, -99) LIKE COALESCE(?, COALESCE(eh.expense_amount, -99))  \
    AND coalesce(UPPER(cmvs.value_name),'xx') LIKE COALESCE(?, coalesce(UPPER(cmvs.value_name),'xx') )  \
    AND DATE_FORMAT(IFNULL(eh.start_date,NOW()), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(IFNULL(eh.start_date,NOW()), '%d-%m-%Y'))  \
    AND DATE_FORMAT(COALESCE(eh.end_date, NOW()), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.end_date, NOW()), '%d-%m-%Y'))  \
    AND DATE_FORMAT(COALESCE(eh.expense_submission_date, NOW()), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.expense_submission_date, NOW()), '%d-%m-%Y')) 


#getEmployeeDataTableCount = SELECT count(eh.Exp_Header_id)\
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav, \
#lt_mast_comn_master_values cmvt ,LT_MAST_EMPLOYEES em \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND em.title = cmvt.value_code(+) \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#AND eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND eh.expense_category  IN ( ? ,?) \
#AND EH.STATUS in ('INPROGRESS','APPROVED') \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND em.SUPERVISOR_EMP_ID = ? \
#AND eh.EMPLOYEE_ID = em.employee_id \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY') \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
#AND upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') \
#like  nvl(?,upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )')) \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))  \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99)) \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY') \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY'))

getEmployeeDataTableCount = SELECT \
    COUNT(eh.exp_header_id) \
FROM  \
    lt_exp_expense_headers eh \
    LEFT JOIN lt_mast_divisions d ON eh.division_id = d.division_id \
    LEFT JOIN lt_mast_branches mb ON em.branch_id = mb.branch_id \
    LEFT JOIN lt_mast_cost_centers cc ON em.cost_center_id = cc.cost_center_id \
    LEFT JOIN lt_mast_vendors lmv ON eh.vendor_id = lmv.vendor_id \
    LEFT JOIN lt_mast_vendor_addresses mva ON eh.vendor_add_id = mva.vendor_add_id \
    LEFT JOIN lt_mast_comn_master_values cmv ON cmv.value_code = eh.dept_id \
    LEFT JOIN lt_mast_comn_master_values cmvv ON cmvv.value_code = eh.expense_category \
    LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.currency_code \
    LEFT JOIN lt_mast_comn_master_values cmvs ON cmvs.value_code = eh.status \
    LEFT JOIN lt_mast_comn_master_values cmvt ON em.title = cmvt.value_code \
    LEFT JOIN lt_mast_employees em ON eh.employee_id = em.employee_id \
    LEFT JOIN lt_mast_comn_master mvav ON mva.country = mvav.value_code \
WHERE \
    eh.expense_category IN (?, ?) \
    AND eh.status IN ('INPROGRESS', 'APPROVED') \
    AND cmvv.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'EXPENSE_CATEGORY') \
    AND em.supervisor_emp_id = ? \
    AND eh.expense_number LIKE COALESCE(?, eh.expense_number) \
    AND UPPER(CONCAT(cmvt.value_name, ' ', em.first_name, ' ', em.last_name, ' (', em.employee_number, ')')) LIKE COALESCE(?, UPPER(CONCAT(cmvt.value_name, ' ', em.first_name, ' ', em.last_name, ' (', em.employee_number, ')'))) \
    AND UPPER(cmvv.value_name) LIKE COALESCE(?, UPPER(cmvv.value_name)) \
    AND COALESCE(eh.expense_amount, -99) LIKE COALESCE(?, COALESCE(eh.expense_amount, -99)) \
    AND UPPER(cmvs.value_name) LIKE COALESCE(?, UPPER(cmvs.value_name)) \
    AND DATE_FORMAT(eh.start_date, '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(eh.start_date, '%d-%m-%Y')) \
    AND DATE_FORMAT(COALESCE(eh.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.end_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
    AND DATE_FORMAT(COALESCE(eh.expense_submission_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.expense_submission_date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y'))


#getAllExpenseRecords = select  * from  \
#(SELECT a.*,ROWNUM RNUM from  \
#(  SELECT \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name , \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE, eh.LAST_UPDATE_DATE,eh.Exp_Header_id, \
#nvl2(d.Division_Name,(d.Division_Name||' '||'('||d.Division_Code||')'),null) AS Division_Name, \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(em.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  || \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)|| \
#nvl2(mva.STATE,(','||mva.STATE),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmv.value_name AS dept_id, cmvv.value_name AS expense_category, CMVC.VALUE_NAME AS CURRENCY_CODE, \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, eh.Exchange_Rate,    EH.APPROVED_DATE,   \
#CMVS.VALUE_NAME AS STATUS \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav, \
#lt_mast_comn_master_values cmvt ,LT_MAST_EMPLOYEES em \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND em.title = cmvt.value_code(+) \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#AND eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND eh.expense_category  IN ( ? ,?) \
#AND EH.STATUS in ('INPROGRESS','APPROVED') \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.employee_id \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY') \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
#AND upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') \
#like  nvl(?,upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )')) \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))  \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99)) \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY') \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \
#  order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc , \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc, \
#  CASE WHEN 3 = ? then employee_Name END asc , \
#CASE WHEN 13 = ? then employee_Name END desc ,\
#CASE WHEN 1 = ? then eh.Expense_Number END asc , \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,\
#CASE WHEN 2 = ? then cmvv.value_name END asc , \
#CASE WHEN 12 = ? then cmvv.value_name END desc , \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc , \
#CASE WHEN 14 = ? then eh.Expense_Amount END desc ,\
#CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc ,\
#CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc ,\
#CASE WHEN 6 = ? then eh.START_DATE END asc , \
#CASE WHEN 16 = ? then eh.START_DATE END desc,\
#CASE WHEN 7 = ? then eh.END_DATE END desc , \
#CASE WHEN 17 = ? then eh.END_DATE END asc , \
#CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC , \
#CASE WHEN 35 = ? then cmvs.value_name END asc )a  where ROWNUM <=? )  WHERE RNUM >=?

getAllExpenseRecords = SELECT * FROM  \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM  \
(  SELECT \
CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') AS employee_Name, \
EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE, eh.LAST_UPDATE_DATE, eh.Exp_Header_id, \
IFNULL(CONCAT(d.Division_Name, ' (', d.Division_Code, ')'), null) AS Division_Name, \
CONCAT(mb.branch_name, ' (', mb.branch_code, ')') AS LOCATION_NAME, \
IFNULL(CONCAT(cc.COST_CENTER_NAME, ' (', cc.COST_CENTER_CODE, ')'), null) AS COST_CENTER_NAME, \
IFNULL(CONCAT(lmv.VENDOR_NAME, ' (', lmv.VENDOR_CODE, ')'), null) AS VENDOR_NAME, \
CONCAT(IFNULL(mva.ADDRESS_1, ''), IFNULL(CONCAT(',', mva.ADDRESS_2), null), \
IFNULL(CONCAT(',', mva.ADDRESS_3), null), IFNULL(CONCAT(',', mva.CITY), null), \
IFNULL(CONCAT(',', mva.STATE), null), IFNULL(CONCAT(',', mvav.value_name), null)) AS VENDOR_ADDR, \
cmv.value_name AS dept_id, cmvv.value_name AS expense_category, CMVC.VALUE_NAME AS CURRENCY_CODE, \
EH.START_DATE, EH.END_DATE, eh.Expense_Amount, eh.Exchange_Rate, EH.APPROVED_DATE, \
CMVS.VALUE_NAME AS STATUS \
FROM LT_EXP_EXPENSE_HEADERS EH \
LEFT JOIN LT_MAST_DIVISIONS D ON eh.DIVISION_ID = d.DIVISION_ID \
LEFT JOIN lt_mast_employees em ON eh.EMPLOYEE_ID = em.employee_id \
LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID \
LEFT JOIN lt_mast_comn_master_values mvav ON mva.COUNTRY = mvav.value_code \
LEFT JOIN LT_MAST_BRANCHES MB ON em.BRANCH_ID = mb.BRANCH_ID \
LEFT JOIN lt_mast_cost_centers cc ON em.COST_CENTER_ID = cc.COST_CENTER_ID \
LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID \
LEFT JOIN lt_mast_comn_master_values cmv ON cmv.value_code = eh.dept_id \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.value_code = eh.status \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.value_code = eh.expense_category AND cmvv.master_id = \
(SELECT master_id FROM lt_mast_comn_master WHERE master_name='EXPENSE_CATEGORY') \
LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.Currency_Code \
WHERE eh.expense_category IN ( ? ,?) \
AND EH.STATUS in ('INPROGRESS','APPROVED') \
AND eh.Expense_Number LIKE COALESCE(?, eh.Expense_Number) \
AND UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) LIKE \
COALESCE(UPPER(?), UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'))) \
AND UPPER(cmvv.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvv.value_name)) \
AND IFNULL(eh.Expense_Amount, -99) LIKE COALESCE(?, IFNULL(eh.Expense_Amount, -99)) \
AND UPPER(cmvs.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvs.value_name)) \
AND DATE_FORMAT(eh.START_DATE, '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(eh.START_DATE, '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE \
COALESCE(?, DATE_FORMAT(IFNULL(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE \
COALESCE(?, DATE_FORMAT(IFNULL(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
ORDER BY \
CASE WHEN 8 = ? THEN eh.LAST_UPDATE_DATE END DESC, \
CASE WHEN 18 = ? THEN eh.LAST_UPDATE_DATE END ASC, \
CASE WHEN 3 = ? THEN employee_Name END ASC, \
CASE WHEN 13 = ? THEN employee_Name END DESC, \
CASE WHEN 1 = ? THEN eh.Expense_Number END ASC, \
CASE WHEN 11 = ? THEN eh.Expense_Number END DESC, \
CASE WHEN 2 = ? THEN cmvv.value_name END ASC, \
CASE WHEN 12 = ? THEN cmvv.value_name END DESC, \
CASE WHEN 4 = ? THEN eh.Expense_Amount END ASC, \
CASE WHEN 14 = ? THEN eh.Expense_Amount END DESC, \
CASE WHEN 5 = ? THEN eh.Expense_Submission_Date END ASC, \
CASE WHEN 15 = ? THEN eh.Expense_Submission_Date END DESC, \
CASE WHEN 6 = ? THEN eh.START_DATE END ASC, \
CASE WHEN 16 = ? THEN eh.START_DATE END DESC, \
CASE WHEN 7 = ? THEN eh.END_DATE END DESC, \
CASE WHEN 17 = ? THEN eh.END_DATE END ASC, \
CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC, \
CASE WHEN 35 = ? THEN cmvs.value_name END ASC \
) a, (SELECT @rownum := 0) r \
WHERE @rownum <= ?) subquery \
WHERE RNUM >= ?




#getAllDataTableCount = SELECT count(eh.Exp_Header_id)\
#  FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav, \
#lt_mast_comn_master_values cmvt ,LT_MAST_EMPLOYEES em \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND em.title = cmvt.value_code(+) \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#AND eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND eh.expense_category  IN ( ? ,?) \
#AND EH.STATUS in ('INPROGRESS','APPROVED') \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.employee_id \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY') \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
#AND upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') \
#like  nvl(?,upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )')) \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))  \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99)) \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY') \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY'))

getAllDataTableCount = SELECT count(eh.Exp_Header_id) \
FROM LT_EXP_EXPENSE_HEADERS EH \
LEFT JOIN LT_MAST_DIVISIONS D ON eh.DIVISION_ID = d.DIVISION_ID \
LEFT JOIN LT_MAST_EMPLOYEES em ON eh.EMPLOYEE_ID = em.employee_id \
LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID \
LEFT JOIN lt_mast_comn_master_values mvav ON mva.COUNTRY = mvav.value_code \
LEFT JOIN LT_MAST_BRANCHES MB ON em.BRANCH_ID = mb.BRANCH_ID \
LEFT JOIN lt_mast_cost_centers cc ON em.COST_CENTER_ID = cc.COST_CENTER_ID \
LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID \
LEFT JOIN lt_mast_comn_master_values cmv ON cmv.value_code = eh.dept_id \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.value_code = eh.status \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.value_code = eh.expense_category AND cmvv.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'EXPENSE_CATEGORY') \
LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.Currency_Code \
WHERE eh.expense_category IN (?, ?) \
AND EH.STATUS in ('INPROGRESS', 'APPROVED') \
AND eh.Expense_Number LIKE COALESCE(?, eh.Expense_Number) \
AND UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) LIKE COALESCE(UPPER(?), UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'))) \
AND UPPER(cmvv.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvv.value_name)) \
AND IFNULL(eh.Expense_Amount, -99) LIKE COALESCE(?, IFNULL(eh.Expense_Amount, -99)) \
AND UPPER(cmvs.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvs.value_name)) \
AND DATE_FORMAT(eh.START_DATE, '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(eh.START_DATE, '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(IFNULL(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(IFNULL(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y'));


#getLtExpExpenseHeadersDatatable = select * from  \
#(SELECT a.*,ROWNUM RNUM from (  SELECT \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name , \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE, \
#eh.LAST_UPDATE_DATE,eh.Exp_Header_id, \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name, \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  || \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)|| \
#nvl2(mva.STATE,(','||mva.STATE),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmv.value_name AS dept_id, \
#cmvv.value_name AS expense_category, \
#CMVC.VALUE_NAME AS CURRENCY_CODE, \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, \
#eh.Exchange_Rate,    EH.APPROVED_DATE,    CMVS.VALUE_NAME AS STATUS \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,lt_mast_comn_master_values cmvt, \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS,LT_MAST_EMPLOYEES em , \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND em.title = cmvt.value_code(+) \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+) \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND eh.expense_category  IN ( ? ,?) \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = ? \
#AND eh.EMPLOYEE_ID = em.employee_id \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY') \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))  \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99)) \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY') \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \
#  order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc , \
#  CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc, \
#  CASE WHEN 1 = ? then eh.Expense_Number END asc , \
#  CASE WHEN 11 = ? then eh.Expense_Number END desc , \
#  CASE WHEN 2 = ? then cmvv.value_name END asc , \
#  CASE WHEN 12 = ? then cmvv.value_name END desc , \
#  CASE WHEN 4 = ? then eh.Expense_Amount END asc , \
#  CASE WHEN 24 = ? then eh.Expense_Amount END desc , \
#  CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc ,\
#  CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc , \
#  CASE WHEN 3 = ? then eh.START_DATE END asc , \
#  CASE WHEN 13 = ? then eh.START_DATE END desc, \
#  CASE WHEN 6 = ? then eh.END_DATE END desc , \
#  CASE WHEN 16 = ? then eh.END_DATE END asc ,  \
#  CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC , \
#  CASE WHEN 35 = ? then cmvs.value_name END asc )a  where ROWNUM <=? )  WHERE RNUM >=?


#getLtExpExpenseHeadersDatatable = select * from   \
#(SELECT a.*,ROWNUM RNUM from (  SELECT  \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name ,  \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,  \
#eh.LAST_UPDATE_DATE,eh.Exp_Header_id,  \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name,  \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME ,  \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME,  \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME,  \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||  \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||  \
#nvl2(lms.STATE_CODE,(','||lms.STATE_NAME),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmvv.value_name AS expense_category,  \
#CMVC.VALUE_NAME AS CURRENCY_CODE,  \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount,  \
#eh.Exchange_Rate,    EH.APPROVED_DATE,    CMVS.VALUE_NAME AS STATUS  \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,  \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,lt_mast_comn_master_values cmvt  \
#,LT_MAST_STATES lms \
#,LT_MAST_COMN_MASTER_VALUES CMVS,LT_MAST_EMPLOYEES em ,  \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav  \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)  \
#AND em.title = cmvt.value_code(+)  \
#AND mva.COUNTRY = mvav.value_code(+)  \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+)  \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)  \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+)  \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)  \
#AND cmvv.value_code(+)=eh.expense_category  \
#AND eh.expense_category  IN ( ? ,?)  \
#AND cmvc.value_code(+)=eh.Currency_Code  \
#AND cmvs.value_code(+)=eh.status  \
#AND eh.EMPLOYEE_ID = ?  \
#AND eh.EMPLOYEE_ID = em.employee_id  \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY')  \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)   \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))   \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))  \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name)) \
#AND lms.state_id = mva.STATE_ID \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY'))  \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')  \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY'))  \
#order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc ,  \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc,  \
#CASE WHEN 1 = ? then eh.Expense_Number END asc ,  \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,  \
#CASE WHEN 2 = ? then cmvv.value_name END asc ,  \
#CASE WHEN 12 = ? then cmvv.value_name END desc ,  \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc ,  \
#CASE WHEN 24 = ? then eh.Expense_Amount END desc ,  \
#CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc , \
#CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc ,  \
#CASE WHEN 3 = ? then eh.START_DATE END asc ,  \
#CASE WHEN 13 = ? then eh.START_DATE END desc,  \
#CASE WHEN 6 = ? then eh.END_DATE END desc ,  \
#CASE WHEN 16 = ? then eh.END_DATE END asc ,   \
#CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC ,  \
#CASE WHEN 35 = ? then cmvs.value_name END asc \
#)a  where ROWNUM <=? )  WHERE RNUM >=?


#getLtExpExpenseHeadersDatatable = select * from    \
#(SELECT a.*,ROWNUM RNUM from (  SELECT  \
#(em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name ,  \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,   \
#eh.LAST_UPDATE_DATE,eh.Exp_Header_id,   \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name,   \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||   \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||   \
#nvl2(lms.STATE_CODE,(','||lms.STATE_NAME),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmvv.value_name AS expense_category,   \
#CMVC.VALUE_NAME AS CURRENCY_CODE,   \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, \
#eh.Exchange_Rate,    EH.APPROVED_DATE,    CMVS.VALUE_NAME AS STATUS  \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,  \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,lt_mast_comn_master_values cmvt   \
#,LT_MAST_STATES lms  \
#,LT_MAST_COMN_MASTER LMCM,LT_MAST_COMN_MASTER_VALUES CMVS,LT_MAST_EMPLOYEES em ,   \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav  \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)   \
#AND mva.COUNTRY = mvav.value_code(+)   \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+)   \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)   \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+)    \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)   \
#AND cmvv.value_code(+)=eh.expense_category  \
#AND eh.expense_category  IN (? ,?)   \
#AND cmvc.value_code(+)=eh.Currency_Code   \
#AND cmvs.value_code(+)=eh.status   \
#AND cmvs.master_id = lmcm.master_id \
#AND lmcm.master_name = 'EXPENSE_STATUS'\
#AND eh.EMPLOYEE_ID = ?  \
#AND eh.EMPLOYEE_ID = em.employee_id  \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY')  \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)    \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))    \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))   \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND lms.state_id = mva.STATE_ID(+)  \
#AND TO_CHAR(nvl (eh.START_DATE, now()-1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.START_DATE, now()-1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY'))   \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')   \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY'))   \
#order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc ,   \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc,   \
#CASE WHEN 1 = ? then eh.Expense_Number END asc ,   \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,   \
#CASE WHEN 2 = ? then cmvv.value_name END asc ,   \
#CASE WHEN 12 = ? then cmvv.value_name END desc ,   \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc ,   \
#CASE WHEN 24 = ? then eh.Expense_Amount END desc ,   \
#CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc ,  \
#CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc ,   \
#CASE WHEN 3 = ? then eh.START_DATE END asc ,  \
#CASE WHEN 13 = ? then eh.START_DATE END desc,   \
#CASE WHEN 6 = ? then eh.END_DATE END desc ,   \
#CASE WHEN 16 = ? then eh.END_DATE END asc ,   \
#CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC ,   \
#CASE WHEN 35 = ? then cmvs.value_name END asc  \
#)a where ROWNUM <=? )  WHERE RNUM >=?
  
# getLtExpExpenseHeadersDatatable = select * from  \
# (SELECT a.*,ROWNUM RNUM from (  SELECT  \
#(em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name ,  \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,   \
#eh.LAST_UPDATE_DATE,eh.Exp_Header_id,   \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name,   \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||   \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||   \
#nvl2(lms.STATE_CODE,(','||lms.STATE_NAME),null) || nvl2(mva.COUNTRY,(''||mvav.value_name),null)) as VENDOR_ADDR, \
#cmvv.value_name AS expense_category,   \
#'INR' as Currency_code, \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, \
#eh.Exchange_Rate,    EH.APPROVED_DATE,    CMVS.VALUE_NAME AS STATUS \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB \
#    ,lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva    \
#    ,LT_MAST_STATES lms  \
#    ,LT_MAST_COMN_MASTER LMCM,LT_MAST_COMN_MASTER_VALUES CMVS,LT_MAST_EMPLOYEES em  \
#    ,LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values mvav  \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)   \
#AND mva.COUNTRY = mvav.value_code(+)  \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+)   \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)   \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+)    \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)  \
#AND lms.state_id(+) = mva.STATE_ID \
#AND eh.expense_category  IN (?,?)   \
#AND cmvs.value_code(+)=eh.status   \
#AND cmvs.master_id = lmcm.master_id \
#AND lmcm.master_name = 'EXPENSE_STATUS'\
#AND eh.EMPLOYEE_ID = ? \
#AND eh.EMPLOYEE_ID = em.employee_id  \
#AND cmvv.value_code(+)=eh.expense_category  \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY')  \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)    \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))    \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))   \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(nvl (eh.START_DATE, now()-1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.START_DATE, now()-1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY'))   \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')  LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \
#order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc ,   \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc,   \
#CASE WHEN 1 = ? then eh.Expense_Number END asc ,   \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,   \
#CASE WHEN 2 = ? then cmvv.value_name END asc ,   \
#CASE WHEN 12 = ? then cmvv.value_name END desc ,   \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc ,   \
#CASE WHEN 24 = ? then eh.Expense_Amount END desc ,   \
#CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc ,  \
#CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc ,  \
#CASE WHEN 3 = ? then eh.START_DATE END asc ,  \
#CASE WHEN 13 = ? then eh.START_DATE END desc,   \
#CASE WHEN 6 = ? then eh.END_DATE END desc ,   \
#CASE WHEN 16 = ? then eh.END_DATE END asc ,   \
#CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC ,   \
#CASE WHEN 35 = ? then cmvs.value_name END asc  \
#)a where ROWNUM <=? )  WHERE RNUM >=?

getLtExpExpenseHeadersDatatable = SELECT *   \
FROM (   \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM   \
    FROM (   \
        SELECT   \
        CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') AS employee_Name,  \
        EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,   \
        eh.LAST_UPDATE_DATE, eh.Exp_Header_id,   \
        CONCAT(d.Division_Name, ' (', d.Division_Code, ')') AS Division_Name,   \
        CONCAT(mb.branch_name, ' (', mb.branch_code, ')') AS LOCATION_NAME,  \
        IF(eh.cost_center_id IS NOT NULL, CONCAT(cc.COST_CENTER_NAME, ' (', cc.COST_CENTER_CODE, ')'), NULL) AS COST_CENTER_NAME,   \
        IF(eh.vendor_id IS NOT NULL, CONCAT(lmv.VENDOR_NAME, ' (', lmv.VENDOR_CODE, ')'), NULL) AS VENDOR_NAME,  \
        CONCAT(   \
            IFNULL(mva.ADDRESS_1, ''), \
            IF(mva.ADDRESS_2 IS NOT NULL, CONCAT(',', mva.ADDRESS_2), ''),   \
            IF(mva.ADDRESS_3 IS NOT NULL, CONCAT(',', mva.ADDRESS_3), ''),  \
            IF(mva.CITY IS NOT NULL, CONCAT(',', mva.CITY), ''),  \
            IF(lms.STATE_CODE IS NOT NULL, CONCAT(',', lms.STATE_NAME), ''), \
            IF(mva.COUNTRY IS NOT NULL, CONCAT(',', mvav.value_name), '')   \
        ) AS VENDOR_ADDR,   \
        cmvv.value_name AS expense_category,   \
        'INR' AS Currency_code,   \
        EH.START_DATE, EH.END_DATE, eh.Expense_Amount,   \
        eh.Exchange_Rate, EH.APPROVED_DATE, CMVS.VALUE_NAME AS STATUS ,cmvs.value_code,cmvs.value_name \
        FROM LT_EXP_EXPENSE_HEADERS EH   \
        LEFT JOIN LT_MAST_DIVISIONS D ON eh.DIVISION_ID = d.DIVISION_ID   \
        LEFT JOIN LT_MAST_BRANCHES MB ON eh.LOCATION_ID = mb.BRANCH_ID   \
        LEFT JOIN lt_mast_cost_centers cc ON eh.COST_CENTER_ID = cc.COST_CENTER_ID   \
        LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID \
        LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID  \
        LEFT JOIN LT_MAST_STATES lms ON lms.state_id = mva.STATE_ID   \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.value_code = eh.status   \
        and cmvs.master_id = (select master_id from lt_mast_comn_master lmcm where lmcm.master_name = 'EXPENSE_STATUS' ) \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.value_code = eh.expense_category   \
        and CMVV.master_id = (select master_id from lt_mast_comn_master lmcm where lmcm.master_name = 'EXPENSE_CATEGORY' ) \
        LEFT JOIN lt_mast_comn_master_values mvav ON mva.COUNTRY = mvav.value_code   \
        and mvav.master_id = (select master_id from lt_mast_comn_master lmcm where lmcm.master_name = 'COUNTRY_MASTER' ) \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON cmvc.value_code = eh.Currency_Code   \
        and cmvc.master_id = (select master_id from lt_mast_comn_master lmcm where lmcm.master_name = 'CURRENCY_MASTER' ) \
        LEFT JOIN LT_MAST_EMPLOYEES em ON eh.EMPLOYEE_ID = em.employee_id   \
        WHERE eh.expense_category IN (?, ?)   \
        AND eh.EMPLOYEE_ID = ? \
        AND cmvv.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'EXPENSE_CATEGORY')  \
        AND eh.Expense_Number LIKE COALESCE(?, eh.Expense_Number)   \
        AND UPPER(cmvv.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvv.value_name))   \
        AND IFNULL(eh.Expense_Amount, -99) LIKE COALESCE(?, IFNULL(eh.Expense_Amount, -99))  \
        AND UPPER(cmvs.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvs.value_name))   \
        AND DATE_FORMAT(COALESCE(eh.START_DATE, NOW() - INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.START_DATE, NOW() - INTERVAL 1 DAY), '%d-%m-%Y'))   \
        AND DATE_FORMAT(COALESCE(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y'))   \
        AND DATE_FORMAT(COALESCE(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
        ORDER BY   \
        CASE WHEN 8 = ? THEN eh.LAST_UPDATE_DATE END DESC,  \
        CASE WHEN 18 = ? THEN eh.LAST_UPDATE_DATE END ASC,  \
        CASE WHEN 1 = ? THEN eh.Expense_Number END ASC,   \
        CASE WHEN 11 = ? THEN eh.Expense_Number END DESC,   \
        CASE WHEN 2 = ? THEN cmvv.value_name END ASC,   \
        CASE WHEN 12 = ? THEN cmvv.value_name END DESC,   \
        CASE WHEN 4 = ? THEN eh.Expense_Amount END ASC,   \
        CASE WHEN 24 = ? THEN eh.Expense_Amount END DESC,   \
        CASE WHEN 5 = ? THEN eh.Expense_Submission_Date END ASC,   \
        CASE WHEN 15 = ? THEN eh.Expense_Submission_Date END DESC,   \
        CASE WHEN 3 = ? THEN eh.START_DATE END ASC,   \
        CASE WHEN 13 = ? THEN eh.START_DATE END DESC,   \
        CASE WHEN 6 = ? THEN eh.END_DATE END DESC,   \
        CASE WHEN 16 = ? THEN eh.END_DATE END ASC,   \
        CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC,  \
        CASE WHEN 35 = ? THEN cmvs.value_name END ASC  \
    ) a   \
    CROSS JOIN (SELECT @rownum := 0) r   \
) b   \
WHERE RNUM <= ? and RNUM >= ?


#getAllExpenseRecords = select  * from  \
#(SELECT a.*,ROWNUM RNUM from  \
#(  SELECT \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_Name , \
#EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE, eh.LAST_UPDATE_DATE,eh.Exp_Header_id, \
#nvl2(d.Division_Name,(d.Division_Name||' '||'('||d.Division_Code||')'),null) AS Division_Name, \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(em.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  || \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)|| \
#nvl2(mva.STATE,(','||mva.STATE),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmv.value_name AS dept_id, cmvv.value_name AS expense_category, CMVC.VALUE_NAME AS CURRENCY_CODE, \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, eh.Exchange_Rate,    EH.APPROVED_DATE,   \
#CMVS.VALUE_NAME AS STATUS \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB, \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav, \
#lt_mast_comn_master_values cmvt ,LT_MAST_EMPLOYEES em \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND em.title = cmvt.value_code(+) \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#AND eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND eh.expense_category  IN ( ? ,?) \
#AND EH.STATUS in ('INPROGRESS','APPROVED') \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.employee_id \
#AND cmvv.master_id=(select master_id from lt_mast_comn_master where master_name='EXPENSE_CATEGORY') \
#AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
#AND upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') \
#like  nvl(?,upper(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )')) \
#AND upper(cmvv.value_name) LIKE nvl( ?, upper(cmvv.value_name))  \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99)) \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))  \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY') \
#LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now()+1 ),'DD-MM-YYYY')) \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY') \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \
#  order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc , \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc, \
#  CASE WHEN 3 = ? then employee_Name END asc , \
#CASE WHEN 13 = ? then employee_Name END desc ,\
#CASE WHEN 1 = ? then eh.Expense_Number END asc , \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,\
#CASE WHEN 2 = ? then cmvv.value_name END asc , \
#CASE WHEN 12 = ? then cmvv.value_name END desc , \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc , \
#CASE WHEN 14 = ? then eh.Expense_Amount END desc ,\
#CASE WHEN 5 = ? then eh.Expense_Submission_Date END asc ,\
#CASE WHEN 15 = ? then eh.Expense_Submission_Date END desc ,\
#CASE WHEN 6 = ? then eh.START_DATE END asc , \
#CASE WHEN 16 = ? then eh.START_DATE END desc,\
#CASE WHEN 7 = ? then eh.END_DATE END desc , \
#CASE WHEN 17 = ? then eh.END_DATE END asc , \
#CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC , \
#CASE WHEN 35 = ? then cmvs.value_name END asc )a  where ROWNUM <=? )  WHERE RNUM >=?

getAllExpenseRecords = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT \
        CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') AS employee_Name, \
        EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE, eh.LAST_UPDATE_DATE, eh.Exp_Header_id, \
        IF(d.Division_Name IS NOT NULL, CONCAT(d.Division_Name, ' (', d.Division_Code, ')'), NULL) AS Division_Name, \
        CONCAT(mb.branch_name, ' (', mb.branch_code, ')') AS LOCATION_NAME, \
        IF(eh.cost_center_id IS NOT NULL, CONCAT(cc.COST_CENTER_NAME, ' (', cc.COST_CENTER_CODE, ')'), NULL) AS COST_CENTER_NAME, \
        IF(eh.vendor_id IS NOT NULL, CONCAT(lmv.VENDOR_NAME, ' (', lmv.VENDOR_CODE, ')'), NULL) AS VENDOR_NAME, \
        CONCAT( \
            IFNULL(mva.ADDRESS_1, ''), \
            IF(mva.ADDRESS_2 IS NOT NULL, CONCAT(',', mva.ADDRESS_2), ''), \
            IF(mva.ADDRESS_3 IS NOT NULL, CONCAT(',', mva.ADDRESS_3), ''), \
            IF(mva.CITY IS NOT NULL, CONCAT(',', mva.CITY), ''), \
            IF(mva.STATE IS NOT NULL, CONCAT(',', mva.STATE), ''), \
            IF(mva.COUNTRY IS NOT NULL, CONCAT(',', mvav.value_name), '') \
        ) AS VENDOR_ADDR, \
        cmv.value_name AS dept_id, cmvv.value_name AS expense_category, cmvc.VALUE_NAME AS CURRENCY_CODE, \
        EH.START_DATE, EH.END_DATE, eh.Expense_Amount, eh.Exchange_Rate, EH.APPROVED_DATE, \
        CMVS.VALUE_NAME AS STATUS \
        FROM LT_EXP_EXPENSE_HEADERS EH \
        LEFT JOIN LT_MAST_DIVISIONS D ON eh.DIVISION_ID = d.DIVISION_ID \
        LEFT JOIN LT_MAST_BRANCHES MB ON eh.LOCATION_ID = mb.BRANCH_ID \
        LEFT JOIN lt_mast_cost_centers cc ON eh.COST_CENTER_ID = cc.COST_CENTER_ID \
        LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID \
        LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID \
        LEFT JOIN lt_mast_comn_master_values cmv ON cmv.value_code = eh.dept_id \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.value_code = eh.status \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.value_code = eh.expense_category \
        LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.Currency_Code \
        LEFT JOIN lt_mast_comn_master_values mvav ON mva.COUNTRY = mvav.value_code \
        LEFT JOIN LT_MAST_EMPLOYEES em ON eh.EMPLOYEE_ID = em.employee_id \
        WHERE eh.expense_category IN (?, ?) \
        AND EH.STATUS IN ('INPROGRESS', 'APPROVED') \
        AND cmvv.master_id = (SELECT master_id FROM lt_mast_comn_master WHERE master_name = 'EXPENSE_CATEGORY') \
        AND eh.Expense_Number LIKE COALESCE(?, eh.Expense_Number) \
        AND UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) LIKE COALESCE(UPPER(?), UPPER(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'))) \
        AND UPPER(cmvv.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvv.value_name)) \
        AND IFNULL(eh.Expense_Amount, -99) LIKE COALESCE(?, IFNULL(eh.Expense_Amount, -99)) \
        AND UPPER(cmvs.value_name) LIKE COALESCE(UPPER(?), UPPER(cmvs.value_name)) \
        AND DATE_FORMAT(COALESCE(eh.START_DATE, NOW() - INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.START_DATE, NOW() - INTERVAL 1 DAY), '%d-%m-%Y')) \
        AND DATE_FORMAT(COALESCE(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
        AND DATE_FORMAT(COALESCE(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE COALESCE(?, DATE_FORMAT(COALESCE(eh.Expense_Submission_Date, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
        ORDER BY \
        CASE WHEN 8 = ? THEN eh.LAST_UPDATE_DATE END DESC, \
        CASE WHEN 18 = ? THEN eh.LAST_UPDATE_DATE END ASC, \
        CASE WHEN 3 = ? THEN employee_Name END ASC, \
        CASE WHEN 13 = ? THEN employee_Name END DESC, \
        CASE WHEN 1 = ? THEN eh.Expense_Number END ASC, \
        CASE WHEN 11 = ? THEN eh.Expense_Number END DESC, \
        CASE WHEN 2 = ? THEN cmvv.value_name END ASC, \
        CASE WHEN 12 = ? THEN cmvv.value_name END DESC, \
        CASE WHEN 4 = ? THEN eh.Expense_Amount END ASC, \
        CASE WHEN 14 = ? THEN eh.Expense_Amount END DESC, \
        CASE WHEN 5 = ? THEN eh.Expense_Submission_Date END ASC, \
        CASE WHEN 15 = ? THEN eh.Expense_Submission_Date END DESC, \
        CASE WHEN 6 = ? THEN eh.START_DATE END ASC, \
        CASE WHEN 16 = ? THEN eh.START_DATE END DESC, \
        CASE WHEN 7 = ? THEN eh.END_DATE END DESC, \
        CASE WHEN 17 = ? THEN eh.END_DATE END ASC, \
        CASE WHEN 14 = ? THEN CMVS.VALUE_NAME END DESC, \
        CASE WHEN 35 = ? THEN cmvs.value_name END ASC \
    ) a \
    CROSS JOIN (SELECT @rownum := 0) r \
    WHERE ROWNUM <= ? \
) b \
WHERE RNUM >= ?



#updateExpenseAmount1 = UPDATE lt_exp_expense_headers \
#SET Expense_Amount = (SELECT ROUND(SUM(Amount),2) \
#FROM lt_exp_expense_lines l \
#WHERE  Exp_Header_id= ? ) , LAST_UPDATE_DATE = ? WHERE Exp_Header_id =?

updateExpenseAmount1 = UPDATE lt_exp_expense_headers \
SET Expense_Amount = ( \
    SELECT ROUND(SUM(Amount), 2) \
    FROM lt_exp_expense_lines l \
    WHERE Exp_Header_id = ? \
), \
LAST_UPDATE_DATE = ? \
WHERE Exp_Header_id = ?
 
#updateExpenseAmount2 = SELECT * FROM LT_EXP_EXPENSE_LINES el \
#WHERE el.end_date = (SELECT max( eel.end_date ) \
#FROM LT_EXP_EXPENSE_LINES eel \
#where eel.exp_header_id=? ) and el.exp_header_id=?

updateExpenseAmount2 = SELECT * FROM LT_EXP_EXPENSE_LINES el \
WHERE el.end_date = ( \
    SELECT MAX(eel.end_date) \
    FROM LT_EXP_EXPENSE_LINES eel \
    WHERE eel.exp_header_id = ? \
) AND el.exp_header_id = ?

 
queryStartDate = SELECT * FROM LT_EXP_EXPENSE_LINES el \
WHERE el.START_DATE = ( select MIN(eel.START_DATE) \
FROM LT_EXP_EXPENSE_LINES eel where eel.exp_header_id=?) and el.exp_header_id=?

updateExpenseAmount3 = UPDATE lt_exp_expense_headers \
SET End_Date = ?, START_DATE= ?, LAST_UPDATE_DATE = ? WHERE Exp_Header_id =?

deleteLtExpExpenseHeaders = DELETE FROM LT_EXP_EXPENSE_HEADERS WHERE Exp_Header_id = ? 

getExpenseList = SELECT  distinct(e.EXP_HEADER_ID) as exp_header_id, Expense_Number, Expense_Submission_Date,EXPENSE_CATEGORY, \
apr.APPROVAL_LEVEL,Expense_Amount, Employee_id   \
FROM lt_exp_expense_headers e, LT_EXPENSE_APPROVAL apr \
WHERE apr.EXP_HEADER_ID = e.EXP_HEADER_ID \
AND e.Status= ? \
AND ((apr.APPROVAL_LEVEL = apr.CURRENT_APPROVAL_LEVEL AND apr.STATUS = 'APPROVED') \
   OR (apr.CURRENT_APPROVAL_LEVEL IS NULL AND apr.STATUS = 'NO_ACTION') \
   OR  (apr.APPROVAL_LEVEL = apr.CURRENT_APPROVAL_LEVEL AND apr.STATUS = 'NO_ACTION'))
   
getApprovalLevel = select   MIN(APPROVAL_LEVEL) as MIN_LEVEL,  CURRENT_APPROVAL_LEVEL ,MODULE_APPROVAL_ID \
from lt_expense_approval where EXP_HEADER_ID = ? \
 group by APPROVAL_LEVEL,  CURRENT_APPROVAL_LEVEL ,MODULE_APPROVAL_ID \
  order by MIN_LEVEL
  
#getApprovalList = SELECT a.EXP_APPROVAL_ID,a.MODULE_APPROVAL_ID,a.APPROVAL_ID,a.APPROVAL_LEVEL, \
# a.CURRENT_APPROVAL_LEVEL,a.EXP_HEADER_ID,a.STATUS,a.DELEGATION_ID, \
# a.MODULE_APP_EMPLOYEES_ID , 'N' AS APPROVED_BY_ANYONE \
# FROM lt_expense_approval a left outer join lt_exp_module_approvals b \
# on a.MODULE_APPROVAL_ID=b.MODULE_APPROVAL_ID  \
# WHERE a.EXP_HEADER_ID= ? AND a.APPROVAL_LEVEL= ?

getApprovalList = SELECT a.EXP_APPROVAL_ID,a.MODULE_APPROVAL_ID,a.APPROVAL_ID,a.APPROVAL_LEVEL,  \
 a.CURRENT_APPROVAL_LEVEL,a.EXP_HEADER_ID,a.STATUS,a.DELEGATION_ID,  \
 a.MODULE_APP_EMPLOYEES_ID , b.APPROVED_BY_ANYONE AS APPROVED_BY_ANYONE  \
 FROM lt_expense_approval a left outer join lt_mast_module_approvals b \
 on a.MODULE_APPROVAL_ID=b.MODULE_APPROVAL_ID   \
 WHERE a.EXP_HEADER_ID= ? AND a.APPROVAL_LEVEL= ?
 
  getNextApprovalLevel = select MIN(APPROVAL_LEVEL) AS  CURRENT_APPROVAL_LEVEL \
 from lt_expense_approval \
 where EXP_HEADER_ID = ? AND APPROVAL_LEVEL > ?
 
 upDateStatus1 = UPDATE lt_expense_approval SET \
STATUS=?,LAST_UPDATE_DATE=?  \
WHERE EXP_HEADER_ID=? AND APPROVAL_LEVEL =? AND STATUS <> ?

upDateStatus2 = UPDATE lt_expense_approval SET \
STATUS=? ,LAST_UPDATE_DATE= ?, CURRENT_APPROVAL_LEVEL=? WHERE EXP_HEADER_ID=?

updateCurrentApprovalLevel = UPDATE lt_expense_approval SET \
CURRENT_APPROVAL_LEVEL = ?  WHERE EXP_HEADER_ID=?

#findEmpDetailsByExpHeaderId = SELECT EH.EXP_HEADER_ID,EH.EXPENSE_NUMBER,EH.EXPENSE_SUBMISSION_DATE, \
#EH.EMPLOYEE_ID,EH.START_DATE,EH.END_DATE,EH.EXCHANGE_RATE,EH.EXPENSE_AMOUNT,EH.DIVISION_ID,EH.LOCATION_ID,\
#EH.COST_CENTER_ID,EH.PURPOSE,EH.VENDOR_ID,EH.VENDOR_ADD_ID,EH.APPROVED_DATE,EH.STATUS, \
#cmvs.value_name as expense_status,EH.CREATED_BY,\
#EH.CREATION_DATE,EH.LAST_UPDATE_LOGIN,EH.EXPENSE_CATEGORY , \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_name ,\
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name, \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME , \
#nvl2(em.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  || \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)|| \
#nvl2(mva.STATE,(','||mva.STATE),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmv.value_name AS dept_name, EH.dept_id, \
#CMVC.VALUE_NAME AS CURRENCY_CODE \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,LT_MAST_EMPLOYEES em ,\
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc, \
#lt_mast_comn_master_values mvav ,lt_mast_comn_master_values cmvt \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+) \
#AND cmvt.value_code(+) = em.title \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND  cmv.value_code(+)=eh.dept_id \
#AND cmvv.value_code(+)=eh.expense_category \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.EMPLOYEE_ID \
#AND eh.Exp_Header_id = ?

#findEmpDetailsByExpHeaderId = SELECT EH.EXP_HEADER_ID, \
#EH.EXPENSE_NUMBER, \
#EH.EXPENSE_SUBMISSION_DATE,   \
#EH.EMPLOYEE_ID, \
#EH.START_DATE, \
#EH.END_DATE, \
#EH.EXCHANGE_RATE, \
#EH.EXPENSE_AMOUNT, \
#EH.DIVISION_ID, \
#EH.LOCATION_ID,  \
#EH.COST_CENTER_ID, \
#EH.PURPOSE, \
#EH.VENDOR_ID, \
#EH.VENDOR_ADD_ID, \
#EH.APPROVED_DATE, \
#EH.STATUS,   \
#cmvs.value_name as expense_status,EH.CREATED_BY,  \
#EH.CREATION_DATE,EH.LAST_UPDATE_LOGIN,EH.EXPENSE_CATEGORY ,   \
#(cmvt.value_name ||' '|| em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_name , \
#(div.Division_Name||' '||'('||div.Division_Code||')') AS Division_Name,   \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME ,   \
#nvl2(em.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME,  \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME,   \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||   \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||   \
#nvl2(lms.STATE_CODE,(','||lms.STATE_NAME),null) || mva.COUNTRY) as VENDOR_ADDR   \
#,MB.* \
#FROM LT_EXP_EXPENSE_HEADERS EH, \
#LT_MAST_DIVISIONS DIV, \
#LT_MAST_BRANCHES MB, \
#LT_MAST_EMPLOYEES em ,  \
#lt_mast_cost_centers cc,  \
#LT_MAST_VENDORS LMV, \
#lt_mast_vendor_addresses mva ,   \
#LT_MAST_COMN_MASTER CMS, \
#LT_MAST_COMN_MASTER_VALUES CMVS,   \
#LT_MAST_COMN_MASTER LMCM, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,   \
#lt_mast_comn_master_values cmvt  , \
#LT_MAST_STATES lms \
#WHERE eh.DIVISION_ID = div.DIVISION_ID(+)   \
#AND cmvt.value_code(+) = em.title   \
#AND em.BRANCH_ID = mb.BRANCH_ID(+)   \
#AND em.COST_CENTER_ID = cc.COST_CENTER_ID(+)  \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+)  \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND lms.state_id(+) = mva.STATE_ID \
#AND lmcm.master_name = 'EXPENSE_CATEGORY' \
#AND cmvv.MASTER_ID = lmcm.master_id \
#AND cmvv.value_code(+)=eh.expense_category  \
#AND cms.MASTER_NAME = 'EXPENSE_STATUS' \
#AND cmvs.master_id = cms.master_id \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.EMPLOYEE_ID  \
#AND eh.Exp_Header_id = ?

findEmpDetailsByExpHeaderId = SELECT EH.EXP_HEADER_ID,  \
EH.EXPENSE_NUMBER,  \
EH.EXPENSE_SUBMISSION_DATE,  \
EH.EMPLOYEE_ID,  \
EH.START_DATE,  \
EH.END_DATE,  \
EH.EXCHANGE_RATE,  \
EH.EXPENSE_AMOUNT,  \
EH.DIVISION_ID,  \
EH.LOCATION_ID,  \
EH.COST_CENTER_ID,  \
EH.PURPOSE,  \
EH.VENDOR_ID,  \
EH.VENDOR_ADD_ID,  \
EH.APPROVED_DATE,  \
EH.STATUS,  \
cmvs.value_name AS expense_status,  \
EH.CREATED_BY,  \
EH.CREATION_DATE,  \
EH.LAST_UPDATE_LOGIN,  \
EH.EXPENSE_CATEGORY,  \
(CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) AS employee_name,  \
(CONCAT(lmd.Division_Name, ' ', '(', lmd.Division_Code, ')')) AS Division_Name,  \
(CONCAT(mb.branch_name, ' ', '(', mb.branch_code, ')')) AS LOCATION_NAME,  \
IFNULL(CONCAT(cc.COST_CENTER_NAME, ' ', '(', cc.COST_CENTER_CODE, ')'), NULL) AS COST_CENTER_NAME,  \
IFNULL(CONCAT(lmv.VENDOR_NAME, ' ', '(', lmv.VENDOR_CODE, ')'), NULL) AS VENDOR_NAME,  \
(CONCAT(IFNULL(mva.ADDRESS_1, ''), IFNULL(CONCAT(',', mva.ADDRESS_2), ''), IFNULL(CONCAT(',', mva.ADDRESS_3), ''), IFNULL(CONCAT(',', mva.CITY), ''), IFNULL(CONCAT(',', lms.STATE_NAME), ''), IFNULL(CONCAT(',', mva.COUNTRY), ''))) AS VENDOR_ADDR,  \
MB.*  \
FROM LT_EXP_EXPENSE_HEADERS EH  \
LEFT JOIN LT_MAST_DIVISIONS lmd ON eh.DIVISION_ID = lmd.DIVISION_ID   \
LEFT JOIN LT_MAST_EMPLOYEES em ON eh.EMPLOYEE_ID = em.EMPLOYEE_ID  \
LEFT JOIN LT_MAST_BRANCHES MB ON em.BRANCH_ID = mb.BRANCH_ID  \
LEFT JOIN lt_mast_cost_centers cc ON em.COST_CENTER_ID = cc.COST_CENTER_ID  \
LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID  \
LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID  \
LEFT JOIN LT_MAST_COMN_MASTER CMS ON cms.MASTER_NAME = 'EXPENSE_STATUS'  \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.master_id = cms.master_id AND cmvs.value_code = eh.STATUS  \
LEFT JOIN LT_MAST_COMN_MASTER LMCM ON lmcm.MASTER_NAME = 'EXPENSE_CATEGORY'  \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.MASTER_ID = lmcm.master_id AND cmvv.value_code = eh.EXPENSE_CATEGORY  \
LEFT JOIN LT_MAST_STATES lms ON lms.state_id = mva.STATE_ID  \
WHERE eh.Exp_Header_id = ?



#getCountInbox = select COUNT( ea . EXP_APPROVAL_ID ) as id \
#from lt_expense_approval ea, \
#lt_exp_expense_headers eh, \
#lt_mast_employees em, \
#LT_MAST_COMN_MASTER_VALUES cmv, \
#LT_MAST_COMN_MASTER_VALUES cmvs \
#where ea.EXP_HEADER_ID = eh.Exp_Header_id \
#and eh.expense_category = 'EXPENSE' \
#and em.employee_id=eh.employee_id \
#AND em.title = cmv.value_code(+) \
#AND cmvs.value_code(+) = ea.status \
#and upper (ea.STATUS) in (?,?) \
#and (ea.APPROVAL_ID = ? or ea.DELEGATION_ID = ? ) \
#AND upper(eh.Expense_Number) LIKE nvl( ?, upper(eh.Expense_Number)) \
#AND eh.Expense_Amount like nvl( ?, eh.Expense_Amount) \
#AND upper(ea.STATUS) LIKE nvl( ?, upper(ea.STATUS)) \
#AND  TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')) \
#AND  UPPER( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) \
#LIKE UPPER(NVL(?, ( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' )))

getCountInbox = SELECT COUNT(ea.EXP_APPROVAL_ID) AS id \
FROM lt_expense_approval ea \
JOIN lt_exp_expense_headers eh ON ea.EXP_HEADER_ID = eh.Exp_Header_id \
JOIN lt_mast_employees em ON em.employee_id = eh.employee_id \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ea.status \
and cmvs.MASTER_ID = (select Master_id from LT_MAST_COMN_MASTER where MASTER_NAME = 'EXP_STATUS_MASTER') \
WHERE eh.expense_category = 'EXPENSE' \
AND UPPER(ea.STATUS) IN (?, ?) \
AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?) \
AND UPPER(eh.Expense_Number) LIKE IFNULL(?, UPPER(eh.Expense_Number)) \
AND eh.Expense_Amount LIKE IFNULL(?, eh.Expense_Amount) \
AND UPPER(ea.STATUS) LIKE IFNULL(?, UPPER(ea.STATUS)) \
AND DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y')) \
AND UPPER(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) \
LIKE UPPER(IFNULL(?, CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')))


#getByStatusInboxView =  select * from \
#(SELECT a.*,ROWNUM RNUM from(select ea.EXP_APPROVAL_ID AS EXPENSE_APPROVAL_ID, \
#ea.MODULE_APPROVAL_ID AS MODULE_APPROVAL_ID, \
#ea.APPROVAL_ID AS APPROVAL_ID, \
#ea.APPROVAL_LEVEL AS APPROVAL_LEVEL, \
#ea.CURRENT_APPROVAL_LEVEL AS CURRENT_APPROVAL_LEVEL, \
#ea.EXP_HEADER_ID AS EXPENSE_HEADER_ID, \
#cmvs.value_name AS STATUS,   \
#ea.LAST_UPDATE_DATE AS LAST_UPDATE_DATE,  \
#ea.DELEGATION_ID AS DELEGATION_ID, \
#ea.START_DATE AS START_DATE, \
#ea.END_DATE AS END_DATE, \
#eh.Employee_id AS Employee_id, \
#eh.Expense_Number AS Expense_Number, \
#eh.Expense_Amount AS Expense_Amount, \
#eh.Division_id AS Division_id,  \
#eh.EXPENSE_CATEGORY,\
#( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) AS INITIATOR_NAME  \
#from lt_expense_approval ea, \
#lt_exp_expense_headers eh, \
#lt_mast_employees em, \
#LT_MAST_COMN_MASTER_VALUES cmv, \
#LT_MAST_COMN_MASTER_VALUES cmvs \
#where ea.EXP_HEADER_ID = eh.Exp_Header_id \
#and em.employee_id=eh.employee_id \
#AND em.title = cmv.value_code(+) \
#AND cmvs.value_code(+) = ea.status \
#and upper (ea.STATUS) in (?,?) \
#and (ea.APPROVAL_ID = ? or ea.DELEGATION_ID = ? ) \
#AND upper(eh.Expense_Number) LIKE nvl( ?, upper(eh.Expense_Number)) \
#AND eh.Expense_Amount like nvl( ?, eh.Expense_Amount) \
#AND upper(ea.STATUS) LIKE nvl( ?, upper(ea.STATUS)) \
#AND  TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')) \
#AND  UPPER( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) \
#LIKE UPPER(NVL(?, ( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ))) \
#AND eh.EXPENSE_CATEGORY = 'EXPENSE' \
#order by  \
#CASE WHEN 2 = ? then upper(eh.Expense_Number) END asc , \
#CASE WHEN 11 = ? then upper(eh.Expense_Number) END desc , \
#CASE WHEN 3 = ? then upper(INITIATOR_NAME) END asc , \
#CASE WHEN 12 = ? then upper(INITIATOR_NAME) END desc , \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc , \
#CASE WHEN 13 = ? then eh.Expense_Amount END desc , \
#CASE WHEN 5 = ? then ea.STATUS || to_char(ea.LAST_UPDATE_DATE,'RRRR-MM-DD HH24:MI:SS')  END desc ,  \
#CASE WHEN 14 = ? then ea.STATUS END asc,  \
#CASE WHEN 6 = ? then ea.LAST_UPDATE_DATE END asc ,  \
#CASE WHEN 15 = ? then ea.LAST_UPDATE_DATE END desc ) a  where ROWNUM <=? )  WHERE RNUM >=?

getByStatusInboxView =  SELECT * FROM  \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM  \
(SELECT ea.EXP_APPROVAL_ID AS EXPENSE_APPROVAL_ID,  \
ea.MODULE_APPROVAL_ID AS MODULE_APPROVAL_ID,  \
ea.APPROVAL_ID AS APPROVAL_ID,  \
ea.APPROVAL_LEVEL AS APPROVAL_LEVEL,  \
ea.CURRENT_APPROVAL_LEVEL AS CURRENT_APPROVAL_LEVEL,  \
ea.EXP_HEADER_ID AS EXPENSE_HEADER_ID,  \
cmvs.value_name AS STATUS,  \
ea.LAST_UPDATE_DATE AS LAST_UPDATE_DATE,  \
ea.DELEGATION_ID AS DELEGATION_ID,  \
ea.START_DATE AS START_DATE,  \
ea.END_DATE AS END_DATE,  \
eh.Employee_id AS Employee_id,  \
eh.Expense_Number AS Expense_Number,  \
eh.Expense_Amount AS Expense_Amount,  \
eh.Division_id AS Division_id,  \
eh.EXPENSE_CATEGORY,  \
ea.created_by, \
(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) AS INITIATOR_NAME  \
FROM lt_expense_approval ea  \
JOIN lt_exp_expense_headers eh ON ea.EXP_HEADER_ID = eh.Exp_Header_id  \
JOIN lt_mast_employees em ON em.employee_id = eh.employee_id  \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ea.status  \
and cmvs.MASTER_ID = (select Master_id from LT_MAST_COMN_MASTER where MASTER_NAME = 'EXP_STATUS_MASTER')  \
WHERE UPPER(ea.STATUS) IN (?, ?)  \
AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?)  \
AND UPPER(eh.Expense_Number) LIKE IFNULL(?, UPPER(eh.Expense_Number))  \
AND eh.Expense_Amount LIKE IFNULL(?, eh.Expense_Amount)  \
AND UPPER(ea.STATUS) LIKE IFNULL(?, UPPER(ea.STATUS))  \
AND DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y')  \
LIKE IFNULL(?, DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y'))  \
AND UPPER(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'))  \
LIKE UPPER(IFNULL(?, CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')))  \
AND eh.EXPENSE_CATEGORY = 'EXPENSE'  \
ORDER BY  \
CASE WHEN 2 = ? THEN UPPER(eh.Expense_Number) END ASC,  \
CASE WHEN 11 = ? THEN UPPER(eh.Expense_Number) END DESC,  \
CASE WHEN 3 = ? THEN UPPER(INITIATOR_NAME) END ASC,  \
CASE WHEN 12 = ? THEN UPPER(INITIATOR_NAME) END DESC,  \
CASE WHEN 4 = ? THEN eh.Expense_Amount END ASC,  \
CASE WHEN 13 = ? THEN eh.Expense_Amount END DESC,  \
CASE WHEN 5 = ? THEN CONCAT(ea.STATUS, ' ', DATE_FORMAT(ea.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s')) END DESC,  \
CASE WHEN 14 = ? THEN ea.STATUS END ASC,  \
CASE WHEN 6 = ? THEN ea.LAST_UPDATE_DATE END ASC,  \
CASE WHEN 15 = ? THEN ea.LAST_UPDATE_DATE END DESC  \
) a, (SELECT @rownum := 0) r  \
) b  \
WHERE RNUM <= ? and RNUM >= ?



#getCountInboxForAdvance = select COUNT( ea . EXP_APPROVAL_ID ) as id \
#from lt_expense_approval ea, \
#lt_exp_expense_headers eh, \
#lt_mast_employees em, \
#LT_MAST_COMN_MASTER_VALUES cmv, \
#LT_MAST_COMN_MASTER_VALUES cmvs \
#where ea.EXP_HEADER_ID = eh.Exp_Header_id \
#and eh.expense_category = 'ADVANCE' \
#and em.employee_id=eh.employee_id \
#AND em.title = cmv.value_code(+) \
#AND cmvs.value_code(+) = ea.status \
#and upper (ea.STATUS) in (?,?) \
#and (ea.APPROVAL_ID = ? or ea.DELEGATION_ID = ? ) \
#AND upper(eh.Expense_Number) LIKE nvl( ?, upper(eh.Expense_Number)) \
#AND eh.Expense_Amount like nvl( ?, eh.Expense_Amount) \
#AND upper(ea.STATUS) LIKE nvl( ?, upper(ea.STATUS)) \
#AND  TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')) \
#AND  UPPER( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) \
#LIKE UPPER(NVL(?, ( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' )))

getCountInboxForAdvance = SELECT COUNT(ea.EXP_APPROVAL_ID) AS id \
FROM lt_expense_approval ea, \
lt_exp_expense_headers eh, \
lt_mast_employees em, \
LT_MAST_COMN_MASTER_VALUES cmvs, \
lt_mast_comn_master lmcm \
WHERE ea.EXP_HEADER_ID = eh.Exp_Header_id \
AND eh.expense_category = 'ADVANCE' \
AND em.employee_id = eh.employee_id \
AND cmvs.value_code = ea.status \
and cmvs.MASTER_ID  = lmcm.MASTER_ID \
and lmcm.MASTER_NAME = 'EXP_STATUS_MASTER' \
AND UPPER(ea.STATUS) IN (?, ?) \
AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?) \
AND UPPER(eh.Expense_Number) LIKE IFNULL(?, UPPER(eh.Expense_Number)) \
AND eh.Expense_Amount LIKE IFNULL(?, eh.Expense_Amount) \
AND UPPER(ea.STATUS) LIKE IFNULL(?, UPPER(ea.STATUS)) \
AND DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y') \
LIKE IFNULL(?, DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y')) \
AND UPPER(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) \
LIKE UPPER(IFNULL(?, CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')))

#AND em.title = cmv.value_code \
#for advance
#getByStatusInboxViewForAdvance =  select * from \
#(SELECT a.*,ROWNUM RNUM from(select ea.EXP_APPROVAL_ID AS EXPENSE_APPROVAL_ID, \
#ea.MODULE_APPROVAL_ID AS MODULE_APPROVAL_ID, \
#ea.APPROVAL_ID AS APPROVAL_ID, \
#ea.APPROVAL_LEVEL AS APPROVAL_LEVEL, \
#ea.CURRENT_APPROVAL_LEVEL AS CURRENT_APPROVAL_LEVEL, \
#ea.EXP_HEADER_ID AS EXPENSE_HEADER_ID, \
#cmvs.value_name AS STATUS,   \
#ea.LAST_UPDATE_DATE AS LAST_UPDATE_DATE,  \
#ea.DELEGATION_ID AS DELEGATION_ID, \
#ea.START_DATE AS START_DATE, \
#ea.END_DATE AS END_DATE, \
#eh.Employee_id AS Employee_id, \
#eh.Expense_Number AS Expense_Number, \
#eh.Expense_Amount AS Expense_Amount, \
#eh.Division_id AS Division_id,  \
#eh.EXPENSE_CATEGORY,\
#( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) AS INITIATOR_NAME  \
#from lt_expense_approval ea, \
#lt_exp_expense_headers eh, \
#lt_mast_employees em, \
#LT_MAST_COMN_MASTER_VALUES cmv, \
#LT_MAST_COMN_MASTER_VALUES cmvs \
#where ea.EXP_HEADER_ID = eh.Exp_Header_id \
#and em.employee_id=eh.employee_id \
#AND em.title = cmv.value_code(+) \
#AND cmvs.value_code(+) = ea.status \
#and upper (ea.STATUS) in (?,?) \
#and (ea.APPROVAL_ID = ? or ea.DELEGATION_ID = ? ) \
#AND upper(eh.Expense_Number) LIKE nvl( ?, upper(eh.Expense_Number)) \
#AND eh.Expense_Amount like nvl( ?, eh.Expense_Amount) \
#AND upper(ea.STATUS) LIKE nvl( ?, upper(ea.STATUS)) \
#AND  TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')  \
#LIKE nvl(?, TO_CHAR(ea.LAST_UPDATE_DATE,'DD-MM-YYYY')) \
#AND  UPPER( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ) \
#LIKE UPPER(NVL(?, ( cmv.value_name||' ' || em.first_name || ' '|| em.LAST_NAME||' ' || '(' ||em.EMPLOYEE_NUMBER||')' ))) \
#AND eh.EXPENSE_CATEGORY = 'ADVANCE' \
#order by  \
#CASE WHEN 2 = ? then upper(eh.Expense_Number) END asc , \
#CASE WHEN 11 = ? then upper(eh.Expense_Number) END desc , \
#CASE WHEN 3 = ? then upper(INITIATOR_NAME) END asc , \
#CASE WHEN 12 = ? then upper(INITIATOR_NAME) END desc , \
#CASE WHEN 4 = ? then eh.Expense_Amount END asc , \
#CASE WHEN 13 = ? then eh.Expense_Amount END desc , \
#CASE WHEN 5 = ? then ea.STATUS || to_char(ea.LAST_UPDATE_DATE,'RRRR-MM-DD HH24:MI:SS')  END desc ,  \
#CASE WHEN 14 = ? then ea.STATUS END asc,  \
#CASE WHEN 6 = ? then ea.LAST_UPDATE_DATE END asc ,  \
#CASE WHEN 15 = ? then ea.LAST_UPDATE_DATE END desc ) a  where ROWNUM <=? )  WHERE RNUM >=?

getByStatusInboxViewForAdvance = SELECT * \
FROM ( \
    SELECT a.*, \
           @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT ea.EXP_APPROVAL_ID AS EXPENSE_APPROVAL_ID, \
               ea.MODULE_APPROVAL_ID AS MODULE_APPROVAL_ID, \
               ea.APPROVAL_ID AS APPROVAL_ID, \
               ea.APPROVAL_LEVEL AS APPROVAL_LEVEL, \
               ea.CURRENT_APPROVAL_LEVEL AS CURRENT_APPROVAL_LEVEL, \
               ea.EXP_HEADER_ID AS EXPENSE_HEADER_ID, \
               cmvs.value_name AS STATUS, \
               ea.LAST_UPDATE_DATE AS LAST_UPDATE_DATE, \
               ea.DELEGATION_ID AS DELEGATION_ID, \
               ea.START_DATE AS START_DATE, \
               ea.END_DATE AS END_DATE, \
               eh.Employee_id AS Employee_id, \
               eh.Expense_Number AS Expense_Number, \
               eh.Expense_Amount AS Expense_Amount, \
               eh.Division_id AS Division_id, \
               eh.EXPENSE_CATEGORY, \
               ea.created_by, \
               CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') AS INITIATOR_NAME \
        FROM lt_expense_approval ea \
        JOIN lt_exp_expense_headers eh ON ea.EXP_HEADER_ID = eh.Exp_Header_id \
        JOIN lt_mast_employees em ON em.employee_id = eh.employee_id \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ea.status \
        and cmvs.MASTER_ID = (select MASTER_ID from LT_MAST_COMN_MASTER where MASTER_NAME = 'EXP_STATUS_MASTER') \
        WHERE UPPER(ea.STATUS) IN (UPPER(?), UPPER(?)) \
          AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?) \
          AND UPPER(eh.Expense_Number) LIKE IFNULL(UPPER(?), UPPER(eh.Expense_Number)) \
          AND eh.Expense_Amount LIKE IFNULL(?, eh.Expense_Amount) \
          AND UPPER(ea.STATUS) LIKE IFNULL(UPPER(?), UPPER(ea.STATUS)) \
          AND DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(ea.LAST_UPDATE_DATE, '%d-%m-%Y'), ?) \
          AND UPPER(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) LIKE UPPER(IFNULL(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'), ?)) \
          AND eh.EXPENSE_CATEGORY = 'ADVANCE' \
        ORDER BY \
            CASE WHEN 2 = ? THEN UPPER(eh.Expense_Number) END ASC, \
            CASE WHEN 11 = ? THEN UPPER(eh.Expense_Number) END DESC, \
            CASE WHEN 3 = ? THEN UPPER(INITIATOR_NAME) END ASC, \
            CASE WHEN 12 = ? THEN UPPER(INITIATOR_NAME) END DESC, \
            CASE WHEN 4 = ? THEN eh.Expense_Amount END ASC, \
            CASE WHEN 13 = ? THEN eh.Expense_Amount END DESC, \
            CASE WHEN 5 = ? THEN CONCAT(ea.STATUS, ' ', DATE_FORMAT(ea.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s')) END DESC, \
            CASE WHEN 14 = ? THEN ea.STATUS END ASC, \
            CASE WHEN 6 = ? THEN ea.LAST_UPDATE_DATE END ASC, \
            CASE WHEN 15 = ? THEN ea.LAST_UPDATE_DATE END DESC \
    ) a, \
    (SELECT @rownum := 0) rnum \
) sub \
WHERE RNUM BETWEEN ? AND ?


#for advance
#getLtExpAdvanceCount = SELECT count(eh.Exp_Header_id)  \
# FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,  \
# lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,  \
# lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav   \
# WHERE eh.DIVISION_ID = d.DIVISION_ID(+)  \
# AND mva.COUNTRY = mvav.value_code(+)  \
# AND eh.LOCATION_ID = mb.BRANCH_ID(+)  \
# AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)  \
# and eh.Vendor_ID = lmv.VENDOR_ID(+)  \
# and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)  \
# AND cmvc.value_code(+)=eh.Currency_Code  \
# AND cmvs.value_code(+)=eh.status  \
# AND eh.EMPLOYEE_ID = ? \
# AND EH.EXPENSE_CATEGORY = ? \
# AND eh.Expense_Number LIKE nvl(?, eh.Expense_Number)  \
# AND upper(EH.EXPENSE_CATEGORY) LIKE nvl( ?, upper(EH.EXPENSE_CATEGORY))   \
# AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))  \
# AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))   \
# AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY'))  \
# AND TO_CHAR(nvl (eh.END_DATE, now() ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now() ),'DD-MM-YYYY'))  \
# AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')  \
# LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \

getLtExpAdvanceCount = SELECT COUNT(eh.Exp_Header_id) \
FROM LT_EXP_EXPENSE_HEADERS eh \
LEFT JOIN LT_MAST_DIVISIONS d ON eh.DIVISION_ID = d.DIVISION_ID \
LEFT JOIN LT_MAST_BRANCHES mb ON eh.LOCATION_ID = mb.BRANCH_ID \
LEFT JOIN lt_mast_cost_centers cc ON eh.COST_CENTER_ID = cc.COST_CENTER_ID \
LEFT JOIN LT_MAST_VENDORS lmv ON eh.Vendor_ID = lmv.VENDOR_ID \
LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON mva.COUNTRY = cmv.value_code \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = eh.status \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON cmvc.value_code = eh.Currency_Code \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES mvav ON mva.COUNTRY = mvav.value_code \
WHERE eh.EMPLOYEE_ID = ? \
  AND eh.EXPENSE_CATEGORY = ? \
  AND eh.Expense_Number LIKE IFNULL(?, eh.Expense_Number) \
  AND UPPER(eh.EXPENSE_CATEGORY) LIKE IFNULL(UPPER(?), UPPER(eh.EXPENSE_CATEGORY)) \
  AND IFNULL(eh.Expense_Amount, -99) LIKE IFNULL(?, IFNULL(eh.Expense_Amount, -99)) \
  AND UPPER(cmvs.value_name) LIKE IFNULL(UPPER(?), UPPER(cmvs.value_name)) \
  AND DATE_FORMAT(eh.START_DATE, '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(eh.START_DATE, '%d-%m-%Y'), ?) \
  AND DATE_FORMAT(IFNULL(eh.END_DATE, NOW()), '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(IFNULL(eh.END_DATE, NOW()), '%d-%m-%Y'), ?) \
  AND DATE_FORMAT(IFNULL(eh.EXPENSE_SUBMISSION_DATE, DATE_ADD(NOW(), INTERVAL 1 DAY)), '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(IFNULL(eh.EXPENSE_SUBMISSION_DATE, DATE_ADD(NOW(), INTERVAL 1 DAY)), '%d-%m-%Y'), ?) ;

 
#for advance
#getLtExpAdvanceRecords =  select * from   \
#(SELECT a.*,ROWNUM RNUM from (  SELECT EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,  \
#eh.LAST_UPDATE_DATE,eh.Exp_Header_id,  \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name,  \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME ,  \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME,  \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME,  \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||  \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||  \
#nvl2(lms.STATE_CODE ,(','||lms.STATE_NAME),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR,  \
#EH.EXPENSE_CATEGORY, CMVC.VALUE_NAME AS CURRENCY_CODE,  \
#EH.START_DATE,EH.END_DATE,eh.Expense_Amount, eh.Exchange_Rate,    EH.APPROVED_DATE,   \
#CMVS.VALUE_NAME AS STATUS  \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,  \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva ,  \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS,lt_mast_comn_master_values cmvc,lt_mast_comn_master_values mvav ,LT_MAST_STATES lms \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)  \
#AND mva.COUNTRY = mvav.value_code(+)  \
#AND eh.LOCATION_ID = mb.BRANCH_ID(+)  \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+)  \
#and eh.Vendor_ID = lmv.VENDOR_ID(+)  \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+)  \
#AND cmvc.value_code(+)=eh.Currency_Code  \
#AND cmvs.value_code(+)=eh.status  \
#AND eh.EMPLOYEE_ID = ?  \
#AND EH.EXPENSE_CATEGORY = ? \
#AND eh.Expense_Number LIKE nvl(? , eh.Expense_Number)  \
#AND upper(EH.EXPENSE_CATEGORY) LIKE nvl( ?, upper(EH.EXPENSE_CATEGORY))   \
#AND nvl(eh.Expense_Amount,-99) like nvl(?,nvl(eh.Expense_Amount,-99))  \
#AND upper(cmvs.value_name) LIKE nvl(?, upper(cmvs.value_name))   \
#AND TO_CHAR(eh.START_DATE,'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(eh.START_DATE,'DD-MM-YYYY'))  \
#AND TO_CHAR(nvl (eh.END_DATE, now() ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (eh.END_DATE, now() ),'DD-MM-YYYY'))  \
#AND TO_CHAR(nvl (eh.Expense_Submission_Date, now()+1 ),'DD-MM-YYYY')  \
#LIKE NVL(?, TO_CHAR(NVL (EH.EXPENSE_SUBMISSION_DATE, now()+1 ),'DD-MM-YYYY')) \
#order by   CASE WHEN 8 = ? then eh.LAST_UPDATE_DATE END desc ,  \
#CASE WHEN 18 = ? then eh.LAST_UPDATE_DATE END asc,  \
#CASE WHEN 1 = ? then eh.Expense_Number END asc ,  \
#CASE WHEN 11 = ? then eh.Expense_Number END desc ,  \
#CASE WHEN 222 = ? then  EH.EXPENSE_CATEGORY END asc ,  \
#CASE WHEN 1222 = ? then  EH.EXPENSE_CATEGORY END desc , \
#CASE WHEN 2 = ? then eh.Expense_Amount END asc ,  \
#CASE WHEN 22 = ? then eh.Expense_Amount END desc ,  \
#CASE WHEN 3 = ? then eh.Expense_Submission_Date END asc , \
#CASE WHEN 13 = ? then eh.Expense_Submission_Date END desc ,  \
#CASE WHEN 5 = ? then eh.START_DATE END asc ,  \
#CASE WHEN 25 = ? then eh.START_DATE END desc, \
#CASE WHEN 6 = ? then eh.END_DATE END desc ,  \
#CASE WHEN 16 = ? then eh.END_DATE END asc ,   \
#CASE WHEN 12= ? THEN CMVS.VALUE_NAME END DESC ,  \
#CASE WHEN 14 = ? then cmvs.value_name END asc \
# )a  where ROWNUM <=? )  WHERE RNUM >=?

getLtExpAdvanceRecords = SELECT * FROM   \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM (  \
    SELECT \
        EH.EXPENSE_NUMBER,  \
        EH.EXPENSE_SUBMISSION_DATE,  \
        eh.LAST_UPDATE_DATE,  \
        eh.Exp_Header_id,  \
        CONCAT(d.Division_Name, ' (', d.Division_Code, ')') AS Division_Name,  \
        CONCAT(mb.branch_name, ' (', mb.branch_code, ')') AS LOCATION_NAME ,  \
        IFNULL(CONCAT(cc.COST_CENTER_NAME, ' (', cc.COST_CENTER_CODE, ')'), NULL) AS COST_CENTER_NAME,  \
        IFNULL(CONCAT(lmv.VENDOR_NAME, ' (', lmv.VENDOR_CODE, ')'), NULL) AS VENDOR_NAME,  \
        CONCAT(  \
            IFNULL(mva.ADDRESS_1, ''),  \
            IFNULL(CONCAT(',', mva.ADDRESS_2), ''),  \
            IFNULL(CONCAT(',', mva.ADDRESS_3), ''),  \
            IFNULL(CONCAT(',', mva.CITY), ''),  \
            IFNULL(CONCAT(',', lms.STATE_NAME), ''),  \
            IFNULL(CONCAT(',', mvav.value_name), '')  \
        ) AS VENDOR_ADDR,  \
        EH.EXPENSE_CATEGORY,  \
        CMVC.VALUE_NAME AS CURRENCY_CODE,  \
        EH.START_DATE,  \
        EH.END_DATE,  \
        eh.Expense_Amount,  \
        eh.Exchange_Rate,  \
        EH.APPROVED_DATE,  \
        CMVS.VALUE_NAME AS STATUS  \
    FROM \
        LT_EXP_EXPENSE_HEADERS EH  \
        LEFT JOIN LT_MAST_DIVISIONS d ON eh.DIVISION_ID = d.DIVISION_ID  \
        LEFT JOIN LT_MAST_BRANCHES mb ON eh.LOCATION_ID = mb.BRANCH_ID  \
        LEFT JOIN lt_mast_cost_centers cc ON eh.COST_CENTER_ID = cc.COST_CENTER_ID  \
        LEFT JOIN LT_MAST_VENDORS lmv ON eh.Vendor_ID = lmv.VENDOR_ID  \
        LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID  \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON mva.COUNTRY = cmv.value_code  \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = eh.status  \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvc ON cmvc.value_code = eh.Currency_Code  \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES mvav ON mva.COUNTRY = mvav.value_code  \
        LEFT JOIN LT_MAST_STATES lms ON mva.STATE_CODE = lms.STATE_CODE  \
    WHERE  \
        eh.EMPLOYEE_ID = ?  \
        AND EH.EXPENSE_CATEGORY = ?  \
        AND eh.Expense_Number LIKE IFNULL(?, eh.Expense_Number)  \
        AND UPPER(EH.EXPENSE_CATEGORY) LIKE IFNULL(UPPER(?), UPPER(EH.EXPENSE_CATEGORY))  \
        AND IFNULL(eh.Expense_Amount, -99) LIKE IFNULL(?, IFNULL(eh.Expense_Amount, -99))  \
        AND UPPER(cmvs.value_name) LIKE IFNULL(UPPER(?), UPPER(cmvs.value_name))  \
        AND DATE_FORMAT(eh.START_DATE, '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(eh.START_DATE, '%d-%m-%Y'), ?)  \
        AND DATE_FORMAT(IFNULL(eh.END_DATE, NOW()), '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(IFNULL(eh.END_DATE, NOW()), '%d-%m-%Y'), ?)  \
        AND DATE_FORMAT(IFNULL(eh.EXPENSE_SUBMISSION_DATE, DATE_ADD(NOW(), INTERVAL 1 DAY)), '%d-%m-%Y') LIKE IFNULL(DATE_FORMAT(IFNULL(eh.EXPENSE_SUBMISSION_DATE, DATE_ADD(NOW(), INTERVAL 1 DAY)), '%d-%m-%Y'), ?)  \
    ORDER BY  \
        CASE WHEN 8 = ? THEN eh.LAST_UPDATE_DATE END DESC ,  \
        CASE WHEN 18 = ? THEN eh.LAST_UPDATE_DATE END ASC,  \
        CASE WHEN 1 = ? THEN eh.Expense_Number END ASC ,  \
        CASE WHEN 11 = ? THEN eh.Expense_Number END DESC ,  \
        CASE WHEN 222 = ? THEN  EH.EXPENSE_CATEGORY END ASC ,  \
        CASE WHEN 1222 = ? THEN  EH.EXPENSE_CATEGORY END DESC ,  \
        CASE WHEN 2 = ? THEN eh.Expense_Amount END ASC ,  \
        CASE WHEN 22 = ? THEN eh.Expense_Amount END DESC ,  \
        CASE WHEN 3 = ? THEN eh.Expense_Submission_Date END ASC ,  \
        CASE WHEN 13 = ? THEN eh.Expense_Submission_Date END DESC ,  \
        CASE WHEN 5 = ? THEN eh.START_DATE END ASC ,  \
        CASE WHEN 25 = ? THEN eh.START_DATE END DESC ,  \
        CASE WHEN 6 = ? THEN eh.END_DATE END DESC ,  \
        CASE WHEN 16 = ? THEN eh.END_DATE END ASC ,  \
        CASE WHEN 12= ? THEN CMVS.VALUE_NAME END DESC ,  \
        CASE WHEN 14 = ? THEN cmvs.value_name END ASC  \
) a  \
JOIN (SELECT @rownum := 0) r  \
WHERE RNUM <= ?  \
) AS result  \
WHERE RNUM >= ?

#__________________________________________ExpenseLines queries

getCount = SELECT count(l.EXP_LINE_ID)  \
FROM LT_EXP_EXPENSE_LINES l,lt_mast_expense_types t \
WHERE ifnull(l.Exp_Header_id,'xx') = ifnull(?,'xx') and l.created_by = ? \
AND l.Expense_Type_Id=t.Expense_Type_Id

#original query
#getDatatableByExpenseHeaderId = select  *  from  \
#(SELECT a.*,ROWNUM RNUM from  \
#( SELECT l.Exp_Header_id, t.Expense_Nature,l.CURRENCY_CODE,l.EXCHANGE_RATE,l.AMOUNT,l.Start_Date,l.End_Date, \
#l.Justification,l.EXP_LINE_ID  ,l.purpose  \
#FROM LT_EXP_EXPENSE_LINES l,lt_mast_expense_types t \
#WHERE l.Exp_Header_id = ?  \
#AND l.Expense_Type_Id=t.Expense_Type_Id \
#order by  \
#CASE WHEN 2 = ? then l.EXP_LINE_ID END asc, \
#CASE WHEN 12 = ? then l.EXP_LINE_ID END desc ,\
#CASE WHEN 3 = ? then upper(Expense_Nature) END asc, \
#CASE WHEN 13 = ? then upper(Expense_Nature) END desc, \
#CASE WHEN 4 = ? then l.CURRENCY_CODE END asc, \
#CASE WHEN 14 = ? then l.CURRENCY_CODE END desc, \
#CASE WHEN 5 = ? then l.EXCHANGE_RATE END asc, \
#CASE WHEN 15 = ? then l.EXCHANGE_RATE END desc, \
#CASE WHEN 6 = ? then l.AMOUNT END asc, \
#CASE WHEN 16 = ? then l.AMOUNT END desc ,\
#CASE WHEN 7 = ? then l.JUSTIFICATION END asc, \
#CASE WHEN 17 = ? then l.JUSTIFICATION END desc ,\
#CASE WHEN 8 = ? then l.START_DATE END asc, \
#CASE WHEN 18 = ? then l.START_DATE END desc, \
#CASE WHEN 9 = ? then l.END_DATE END asc, \
#CASE WHEN 19 = ? then l.END_DATE END desc ,\
#CASE WHEN 10 = ? then l.END_DATE END asc, \
#CASE WHEN 20 = ? then l.END_DATE END desc\
#) a where ROWNUM <=? ) WHERE RNUM >=?

#for filter original query
#getDatatableByExpenseHeaderId = select  *  from  \
#(SELECT a.*,ROWNUM RNUM from  \
#( SELECT l.Exp_Header_id, t.Expense_Nature,l.CURRENCY_CODE,l.EXCHANGE_RATE,l.AMOUNT,l.Start_Date,l.End_Date, \
#l.Justification,l.EXP_LINE_ID  ,l.purpose  \
#FROM LT_EXP_EXPENSE_LINES l,lt_mast_expense_types t \
#WHERE l.Exp_Header_id = ?  \
#AND l.Expense_Type_Id=t.Expense_Type_Id \
#AND upper(t.EXPENSE_NATURE) like  nvl(?,upper(t.EXPENSE_NATURE))\
#AND nvl(l.Amount,-99) like nvl(?,nvl(l.Amount,-99))\
#AND upper(l.purpose) like  nvl(?,upper(l.purpose))\
#AND  TO_CHAR(l.START_DATE,'DD-MM-YYYY')  LIKE nvl(?, TO_CHAR(l.START_DATE,'DD-MM-YYYY'))  \
#AND  TO_CHAR(nvl (l.END_DATE, now()+1 ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (l.END_DATE, now()+1 ),'DD-MM-YYYY'))  \
#order by  \
#CASE WHEN 2 = ? then l.EXP_LINE_ID END asc, \
#CASE WHEN 12 = ? then l.EXP_LINE_ID END desc ,\
#CASE WHEN 3 = ? then upper(Expense_Nature) END asc, \
#CASE WHEN 13 = ? then upper(Expense_Nature) END desc, \
#CASE WHEN 4 = ? then l.CURRENCY_CODE END asc, \
#CASE WHEN 14 = ? then l.CURRENCY_CODE END desc, \
#CASE WHEN 5 = ? then l.EXCHANGE_RATE END asc, \
#CASE WHEN 15 = ? then l.EXCHANGE_RATE END desc, \
#CASE WHEN 6 = ? then l.AMOUNT END asc, \
#CASE WHEN 16 = ? then l.AMOUNT END desc ,\
#CASE WHEN 7 = ? then l.JUSTIFICATION END asc, \
#CASE WHEN 17 = ? then l.JUSTIFICATION END desc ,\
#CASE WHEN 8 = ? then l.START_DATE END asc, \
#CASE WHEN 18 = ? then l.START_DATE END desc, \
#CASE WHEN 9 = ? then l.END_DATE END asc, \
#CASE WHEN 19 = ? then l.END_DATE END desc ,\
#CASE WHEN 10 = ? then l.END_DATE END asc, \
#CASE WHEN 20 = ? then l.END_DATE END desc\
#)\
#a where ROWNUM <=? ) WHERE RNUM >=?


getDatatableByExpenseHeaderId = SELECT * FROM \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM \
(SELECT l.Exp_Header_id, t.Expense_Nature, l.CURRENCY_CODE, l.EXCHANGE_RATE, l.AMOUNT, l.Start_Date, l.End_Date, \
l.Justification, l.EXP_LINE_ID, l.purpose \
FROM LT_EXP_EXPENSE_LINES l \
JOIN lt_mast_expense_types t ON l.Expense_Type_Id = t.Expense_Type_Id \
where ifnull(l.Exp_Header_id,'xx') = ifnull(?,'xx') and l.created_by = ? \
AND UPPER(t.EXPENSE_NATURE) LIKE IFNULL(?, UPPER(t.EXPENSE_NATURE)) \
AND IFNULL(l.Amount, -99) LIKE IFNULL(?, IFNULL(l.Amount, -99)) \
AND coalesce(UPPER(l.purpose),'xx') LIKE COALESCE(?, coalesce(UPPER(l.purpose),'xx')) \
AND DATE_FORMAT(l.START_DATE, '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(l.START_DATE, '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(l.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(l.END_DATE, NOW() + INTERVAL 1 DAY), '%d-%m-%Y')) \
ORDER BY \
CASE WHEN 2 = ? THEN UPPER(t.EXPENSE_NATURE) END ASC,  \
CASE WHEN 12 = ? THEN UPPER(t.EXPENSE_NATURE) END DESC,  \
CASE WHEN 3 = ? THEN l.Amount END ASC,  \
CASE WHEN 13 = ? THEN l.Amount END DESC,  \
CASE WHEN 4 = ? THEN UPPER(l.purpose) END ASC,  \
CASE WHEN 14 = ? THEN UPPER(l.purpose) END DESC,    \
CASE WHEN 5 = ? THEN l.START_DATE END ASC,  \
CASE WHEN 15 = ? THEN l.START_DATE END DESC,  \
CASE WHEN 6 = ? THEN l.END_DATE END ASC,  \
CASE WHEN 16 = ? THEN l.END_DATE END DESC \
) a, (SELECT @rownum := 0) r \
 ) b \
WHERE RNUM <= ? AND RNUM >= ?


#getExpenseLinesByLineIdV1 = SELECT l.EXP_HEADER_ID,l.EXP_LINE_ID,l.LINE_NO,l.START_DATE,l.END_DATE, \
#l.RECEIPT_AMOUNT,l.CURRENCY_CODE,l.EXCHANGE_RATE,l.AMOUNT,l.JUSTIFICATION,l.PROJECT_ID,l.TASK_ID, \
#l.TRAVEL_TYPE,l.TICKET_CLASS_CODE,l.TICKET_NUMBER,l.FLIGHT_NUMBER,l.NUMBER_ATTENDEES,l.ATTENDEES, \
#l.STATUS,l.CREATED_BY,l.LAST_UPDATE_LOGIN,l.MODE_OF_TRAVEL,l.PAID_BY_COMPANY,l.HOTEL_NAME,l.HOTEL_NO_OF_DAYS, \
#l.HOTEL_RATE,l.HOTEL_BILL_NUMBER,l.FOOD_NAME_OF_HOTEL,l.FOOD_HOTEL_BILL_NUMBER,l.PURPOSE, \
#trim(l.MISSING_BILL) as MISSING_BILL,l.FUEL_COST_PER_KM,l.MAINTENANCE_PER_KM,l.TOTAL_FUEL_COST, \
#l.TOTAL_MAINTENANCE_COST,l.TOLL_CHARGES,l.EXPENSE_TYPE_ID,l.TOTAL_DISTANCE_TRAVELED,l.SEAT_PREFRENCE,l.CARRIER, \
#l.FROM_CITY,l.TO_CITY,l.FOOD_PREFERENCE,l.DEPARTURE_TIME,l.ARRIVAL_TIME,l.BOOKING_TYPE,l.EXPENSE_ATTACHMENT_ID as expense_file_upload_id ,\
#l.CREATION_DATE,l.expense_bill_number, ef.FILE_PATH, \
#(t.Expense_Nature||'('||t.Expense_Type||')')  as Expense_Type_Code \
#FROM LT_EXP_EXPENSE_LINES l, lt_mast_expense_types t ,LT_MAST_EXP_FILE_UPLOAD ef \
#WHERE l.Exp_Line_id = ? AND l.Expense_Type_Id=t.Expense_Type_Id AND l.EXPENSE_ATTACHMENT_ID= ef.EXPENSE_ATTACHMENT_ID(+) 

getExpenseLinesByLineIdV1 = SELECT l.EXP_HEADER_ID, l.EXP_LINE_ID, l.LINE_NO, l.START_DATE, l.END_DATE, \
l.RECEIPT_AMOUNT, l.CURRENCY_CODE, l.EXCHANGE_RATE, l.AMOUNT, l.JUSTIFICATION, l.PROJECT_ID, l.TASK_ID, \
l.TRAVEL_TYPE, l.TICKET_CLASS_CODE, l.TICKET_NUMBER, l.FLIGHT_NUMBER, l.NUMBER_ATTENDEES, l.ATTENDEES, \
l.STATUS, l.CREATED_BY, l.LAST_UPDATE_LOGIN, l.MODE_OF_TRAVEL, l.PAID_BY_COMPANY, l.HOTEL_NAME, l.HOTEL_NO_OF_DAYS, \
l.HOTEL_RATE, l.HOTEL_BILL_NUMBER, l.FOOD_NAME_OF_HOTEL, l.FOOD_HOTEL_BILL_NUMBER, l.PURPOSE, \
TRIM(l.MISSING_BILL) AS MISSING_BILL, l.FUEL_COST_PER_KM, l.MAINTENANCE_PER_KM, l.TOTAL_FUEL_COST, \
l.TOTAL_MAINTENANCE_COST, l.TOLL_CHARGES, l.EXPENSE_TYPE_ID, l.TOTAL_DISTANCE_TRAVELED, l.SEAT_PREFERENCE, l.CARRIER, \
l.FROM_CITY, l.TO_CITY, l.FOOD_PREFERENCE, l.DEPARTURE_TIME, l.ARRIVAL_TIME, l.BOOKING_TYPE, l.EXPENSE_ATTACHMENT_ID AS expense_file_upload_id, \
l.CREATION_DATE, l.expense_bill_number, ef.FILE_PATH,lmp.project_name as projectName, \
(CONCAT(t.Expense_Nature, '(', t.Expense_Type, ')')) AS Expense_Type_Code \
FROM LT_EXP_EXPENSE_LINES l \
JOIN lt_mast_expense_types t ON l.Expense_Type_Id = t.Expense_Type_Id \
LEFT JOIN LT_EXP_EXPENSE_ATTACHMENTS ef ON l.EXPENSE_ATTACHMENT_ID = ef.EXPENSE_ATTACHMENT_ID \
LEFT JOIN lt_mast_projects lmp ON l.project_id = lmp.PROJECT_ID  \
WHERE l.Exp_Line_id = ?


deleteLine = DELETE FROM LT_EXP_EXPENSE_LINES WHERE Exp_Line_id = ?
 
deleteMileageLine = DELETE FROM LT_EXP_MILEAGE_EXPENSE_LINES WHERE Exp_Line_id = ?

#getExpenseLinesByLineId =  SELECT l.EXP_HEADER_ID,l.EXP_LINE_ID,l.LINE_NO,l.START_DATE,l.END_DATE, \
#l.RECEIPT_AMOUNT,l.CURRENCY_CODE,l.EXCHANGE_RATE,l.AMOUNT,l.JUSTIFICATION,l.PROJECT_ID,l.TASK_ID, \
#l.TRAVEL_TYPE,l.TICKET_CLASS_CODE,l.TICKET_NUMBER,l.FLIGHT_NUMBER,l.NUMBER_ATTENDEES,l.ATTENDEES, \
#l.STATUS,l.CREATED_BY,l.LAST_UPDATE_LOGIN,l.MODE_OF_TRAVEL,l.PAID_BY_COMPANY,l.HOTEL_NAME,l.HOTEL_NO_OF_DAYS, \
#l.HOTEL_RATE,l.HOTEL_BILL_NUMBER,l.FOOD_NAME_OF_HOTEL,l.FOOD_HOTEL_BILL_NUMBER,l.PURPOSE, \
#trim(l.MISSING_BILL) as MISSING_BILL,l.FUEL_COST_PER_KM,l.MAINTENANCE_PER_KM,l.TOTAL_FUEL_COST, \
#l.TOTAL_MAINTENANCE_COST,l.TOLL_CHARGES,l.EXPENSE_TYPE_ID,l.TOTAL_DISTANCE_TRAVELED,l.SEAT_PREFRENCE,l.CARRIER, \
#l.FROM_CITY,l.TO_CITY,l.FOOD_PREFERENCE,l.DEPARTURE_TIME,l.ARRIVAL_TIME,l.BOOKING_TYPE,l.EXPENSE_ATTACHMENT_ID, \
#l.CREATION_DATE,l.expense_bill_number, \
#(t.Expense_Nature||'('||t.Expense_Type||')')  as Expense_Type_Code \
#FROM LT_EXP_EXPENSE_LINES l, lt_mast_expense_types t \
#WHERE l.Exp_Line_id = ? AND l.Expense_Type_Id=t.Expense_Type_Id(+)

getExpenseLinesByLineId =  SELECT l.EXP_HEADER_ID, l.EXP_LINE_ID, l.LINE_NO, l.START_DATE, l.END_DATE, \
l.RECEIPT_AMOUNT, l.CURRENCY_CODE, l.EXCHANGE_RATE, l.AMOUNT, l.JUSTIFICATION, l.PROJECT_ID, l.TASK_ID, \
l.TRAVEL_TYPE, l.TICKET_CLASS_CODE, l.TICKET_NUMBER, l.FLIGHT_NUMBER, l.NUMBER_ATTENDEES, l.ATTENDEES, \
l.STATUS, l.CREATED_BY, l.LAST_UPDATE_LOGIN, l.MODE_OF_TRAVEL, l.PAID_BY_COMPANY, l.HOTEL_NAME, l.HOTEL_NO_OF_DAYS, \
l.HOTEL_RATE, l.HOTEL_BILL_NUMBER, l.FOOD_NAME_OF_HOTEL, l.FOOD_HOTEL_BILL_NUMBER, l.PURPOSE, \
TRIM(l.MISSING_BILL) AS MISSING_BILL, l.FUEL_COST_PER_KM, l.MAINTENANCE_PER_KM, l.TOTAL_FUEL_COST, \
l.TOTAL_MAINTENANCE_COST, l.TOLL_CHARGES, l.EXPENSE_TYPE_ID, l.TOTAL_DISTANCE_TRAVELED, l.SEAT_PREFERENCE, l.CARRIER, \
l.FROM_CITY, l.TO_CITY, l.FOOD_PREFERENCE, l.DEPARTURE_TIME, l.ARRIVAL_TIME, l.BOOKING_TYPE, l.EXPENSE_ATTACHMENT_ID, \
l.CREATION_DATE, l.expense_bill_number, \
(CONCAT(t.Expense_Nature, '(', t.Expense_Type, ')')) AS Expense_Type_Code \
FROM LT_EXP_EXPENSE_LINES l \
JOIN lt_mast_expense_types t ON l.Expense_Type_Id = t.Expense_Type_Id \
WHERE l.Exp_Line_id = ?


#________________________________________________expenseApprovalQueries

loadApprovers = SELECT a.module_app_employees_id,a.employees_id,b.approval_level,b.module, a.MODULE_APPROVAL_ID \
FROM lt_expense_module_app_emp a,lt_exp_module_approvals b \
WHERE a.MODULE_APPROVAL_ID=b.MODULE_APPROVAL_ID \
AND DIVISION_ID= ? \
AND MODULE= ?  \
AND STATUS= ? \
AND ( a.START_DATE <= now() \
AND (a.END_DATE is null or a.END_DATE > now()) )
 
loadApproversInsert = INSERT INTO lt_expense_approval \
(MODULE_APPROVAL_ID,APPROVAL_ID,APPROVAL_LEVEL,CURRENT_APPROVAL_LEVEL,DELEGATION_ID, \
EXPENSE_HEADER_ID, STATUS,START_DATE,END_DATE, CREATED_BY,CREATION_DATE,LAST_UPDATE_LOGIN, \
LAST_UPDATED_BY,LAST_UPDATE_DATE ,MODULE_APP_EMPLOYEES_ID) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

#findOneLtExpExpenseHeaders =  SELECT EH.EXP_HEADER_ID,EH.EXPENSE_NUMBER,EH.EXPENSE_SUBMISSION_DATE, \
#EH.EMPLOYEE_ID,EH.START_DATE,EH.END_DATE,EH.EXCHANGE_RATE,EH.EXPENSE_AMOUNT,EH.DIVISION_ID,EH.LOCATION_ID, \
#EH.COST_CENTER_ID,EH.PURPOSE,EH.VENDOR_ID,EH.VENDOR_ADD_ID,EH.APPROVED_DATE,EH.STATUS, \
#cmvs.value_name as expense_status,EH.CREATED_BY, \
#EH.CREATION_DATE,EH.LAST_UPDATE_LOGIN,EH.EXPENSE_CATEGORY , \
#(em.FIRST_NAME ||' '|| em.LAST_NAME || ' ( '|| em.EMPLOYEE_NUMBER||' )') AS employee_name , \
#(d.Division_Name||' '||'('||d.Division_Code||')') AS Division_Name, \
#(mb.branch_name||' '||'('||mb.branch_code||')') AS LOCATION_NAME ,  \
#nvl2(eh.cost_center_id,(cc.COST_CENTER_NAME||' '||'('||cc.COST_CENTER_CODE||')'),null) AS COST_CENTER_NAME, \
#nvl2(eh.vendor_id, (lmv.VENDOR_NAME||' '||'('||lmv.VENDOR_CODE||')'),null) AS VENDOR_NAME, \
#( nvl(mva.ADDRESS_1,'') || nvl2(mva.ADDRESS_2,(','||mva.ADDRESS_2),null)  ||  \
#nvl2(mva.ADDRESS_3,(','||mva.ADDRESS_3),null)||nvl2(mva.CITY,(','||mva.CITY),null)||  \
#nvl2(lms.STATE_CODE ,(','||lms.STATE_NAME),null) || nvl2(mva.COUNTRY,(','||mvav.value_name),null)) as VENDOR_ADDR, \
#cmv.value_name AS dept_name, \
#CMVC.VALUE_NAME AS CURRENCY_CODE \
#FROM LT_EXP_EXPENSE_HEADERS EH,LT_MAST_DIVISIONS D,LT_MAST_BRANCHES MB,LT_MAST_EMPLOYEES em , \
#lt_mast_cost_centers cc, LT_MAST_VENDORS LMV,lt_mast_vendor_addresses mva , \
#lt_mast_comn_master_values cmv,LT_MAST_COMN_MASTER_VALUES CMVS, \
#LT_MAST_COMN_MASTER_VALUES CMVV ,lt_mast_comn_master_values cmvc, \
#lt_mast_comn_master_values mvav ,LT_MAST_STATES lms \
#WHERE eh.DIVISION_ID = d.DIVISION_ID(+)  \
#AND mva.COUNTRY = mvav.value_code(+) \
#AND em.BRANCH_ID = mb.BRANCH_ID(+) \
#AND eh.COST_CENTER_ID = cc.COST_CENTER_ID(+) \
#AND eh.VENDOR_ID = lmv.VENDOR_ID(+) \
#and eh.Vendor_Add_ID = mva.VENDOR_ADD_ID(+) \
#AND cmvv.value_code(+)=eh.expense_category \
#AND cmvc.value_code(+)=eh.Currency_Code \
#AND cmvs.value_code(+)=eh.status \
#AND eh.EMPLOYEE_ID = em.EMPLOYEE_ID \
#AND eh.Exp_Header_id = ? \
#FETCH FIRST ROW ONLY

findOneLtExpExpenseHeaders = SELECT EH.EXP_HEADER_ID, EH.EXPENSE_NUMBER, EH.EXPENSE_SUBMISSION_DATE,  \
EH.EMPLOYEE_ID, EH.START_DATE, EH.END_DATE, EH.EXCHANGE_RATE, EH.EXPENSE_AMOUNT, EH.DIVISION_ID, EH.LOCATION_ID,  \
EH.COST_CENTER_ID, EH.PURPOSE, EH.VENDOR_ID, EH.VENDOR_ADD_ID, EH.APPROVED_DATE, EH.STATUS,  \
cmvs.value_name AS expense_status, EH.CREATED_BY,  \
EH.CREATION_DATE, EH.LAST_UPDATE_LOGIN, EH.EXPENSE_CATEGORY,  \
CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' ( ', em.EMPLOYEE_NUMBER, ' )') AS employee_name,  \
CONCAT(d.Division_Name, ' (', d.Division_Code, ')') AS Division_Name,  \
CONCAT(mb.branch_name, ' (', mb.branch_code, ')') AS LOCATION_NAME,  \
IF(eh.cost_center_id IS NOT NULL, CONCAT(cc.COST_CENTER_NAME, ' (', cc.COST_CENTER_CODE, ')'), NULL) AS COST_CENTER_NAME, \
IF(eh.vendor_id IS NOT NULL, CONCAT(lmv.VENDOR_NAME, ' (', lmv.VENDOR_CODE, ')'), NULL) AS VENDOR_NAME,  \
CONCAT(IFNULL(mva.ADDRESS_1, ''), IF(mva.ADDRESS_2 IS NOT NULL, CONCAT(',', mva.ADDRESS_2), ''),  \
IF(mva.ADDRESS_3 IS NOT NULL, CONCAT(',', mva.ADDRESS_3), ''), IF(mva.CITY IS NOT NULL, CONCAT(',', mva.CITY), ''), \
IF(lms.STATE_CODE IS NOT NULL, CONCAT(',', lms.STATE_NAME), ''), IF(mva.COUNTRY IS NOT NULL, CONCAT(',', mvav.value_name), '')) AS VENDOR_ADDR,  \
null AS dept_name,  \
CMVC.VALUE_NAME AS CURRENCY_CODE  \
FROM LT_EXP_EXPENSE_HEADERS EH  \
LEFT JOIN LT_MAST_DIVISIONS D ON eh.DIVISION_ID = d.DIVISION_ID \
LEFT JOIN LT_MAST_EMPLOYEES em ON eh.EMPLOYEE_ID = em.EMPLOYEE_ID \
LEFT JOIN LT_MAST_BRANCHES MB ON em.BRANCH_ID = mb.BRANCH_ID  \
LEFT JOIN lt_mast_cost_centers cc ON eh.COST_CENTER_ID = cc.COST_CENTER_ID  \
LEFT JOIN LT_MAST_VENDORS LMV ON eh.VENDOR_ID = lmv.VENDOR_ID  \
LEFT JOIN lt_mast_vendor_addresses mva ON eh.Vendor_Add_ID = mva.VENDOR_ADD_ID    \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVS ON cmvs.value_code = eh.status  \
and cmvs.master_id =  (select cm.master_id from LT_MAST_COMN_MASTER cm where cmvs.master_id = cm.master_id and cm.master_name = 'EXPENSE_CATEGORY' ) \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES CMVV ON cmvv.value_code = eh.expense_category  \
and cmvv.master_id =  (select cm.master_id from LT_MAST_COMN_MASTER cm where cmvv.master_id = cm.master_id and cm.master_name = 'EXPENSE_CATEGORY' ) \
LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = eh.Currency_Code  \
and cmvc.master_id =  (select cm.master_id from LT_MAST_COMN_MASTER cm where cmvc.master_id = cm.master_id and cm.master_name = 'EXPENSE_CATEGORY' ) \
LEFT JOIN lt_mast_comn_master_values mvav ON mva.COUNTRY = mvav.value_code and mvav.STATUS = 'ACTIVE' \
and mvav.master_id =  (select cm.master_id from LT_MAST_COMN_MASTER cm where mvav.master_id = cm.master_id and cm.master_name = 'EXPENSE_CATEGORY' ) \
LEFT JOIN LT_MAST_STATES lms ON lms.STATE_CODE = mva.STATE_CODE  \
WHERE eh.Exp_Header_id = ? 


#getExpenseLinesByExpenseHeaderId = SELECT trim(l.MISSING_BILL) as MISSING_BILL,cmv.value_name as TRAVEL_TYPE_NAME , \
#( '(' || l.CURRENCY_CODE || ')' || l.RECEIPT_AMOUNT) as currencyCodeWithName,  l.AMOUNT AS receptAmountStr, \
#l.EXP_HEADER_ID,l.EXP_LINE_ID,l.LINE_NO,l.START_DATE,l.END_DATE,l.RECEIPT_AMOUNT,l.CURRENCY_CODE, \
#l.EXCHANGE_RATE,l.AMOUNT,l.JUSTIFICATION,l.PROJECT_ID,l.TASK_ID,l.TRAVEL_TYPE,l.TICKET_CLASS_CODE, \
#l.TICKET_NUMBER,l.FLIGHT_NUMBER,l.NUMBER_ATTENDEES,l.ATTENDEES,l.STATUS,l.MODE_OF_TRAVEL,l.PAID_BY_COMPANY, \
#l.HOTEL_NAME,l.HOTEL_NO_OF_DAYS,l.HOTEL_RATE,l.HOTEL_BILL_NUMBER,l.FOOD_NAME_OF_HOTEL,l.FOOD_HOTEL_BILL_NUMBER, \
#l.PURPOSE,l.MISSING_BILL,l.FUEL_COST_PER_KM,l.MAINTENANCE_PER_KM,l.TOTAL_FUEL_COST,l.TOTAL_MAINTENANCE_COST, \
#l.TOLL_CHARGES,l.EXPENSE_TYPE_ID,l.TOTAL_DISTANCE_TRAVELED,l.SEAT_PREFRENCE,l.FROM_CITY,l.TO_CITY,l.FOOD_PREFERENCE, \
#l.DEPARTURE_TIME,l.ARRIVAL_TIME,l.BOOKING_TYPE,l.EXPENSE_ATTACHMENT_ID,l.EXPENSE_BILL_NUMBER,l.ADDRESS , \
#cmvc.value_name as carrier ,t.Expense_Nature as Expense_Type_Code,t.Expense_Type_Id,t.EXPENSE_TYPE as expense_type_pdf , \
#t.EXPENSE_NATURE \
#FROM LT_EXP_EXPENSE_LINES l, lt_mast_expense_types t , lt_mast_comn_master_values cmv , lt_mast_comn_master_values cmvc \
#WHERE l.Exp_Header_id = ? \
#AND l.Expense_Type_Id=t.Expense_Type_Id(+) \
#AND cmv.value_code(+)= l.travel_type   \
#AND cmvc.value_code(+) = l.carrier  \
#order by l.EXP_LINE_ID

getExpenseLinesByExpenseHeaderId = SELECT TRIM(l.MISSING_BILL) AS MISSING_BILL, cmv.value_name AS TRAVEL_TYPE_NAME, \
CONCAT('(', l.CURRENCY_CODE, ')', l.RECEIPT_AMOUNT) AS currencyCodeWithName, l.AMOUNT AS receptAmountStr, \
l.EXP_HEADER_ID, l.EXP_LINE_ID, l.LINE_NO, l.START_DATE, l.END_DATE, l.RECEIPT_AMOUNT, l.CURRENCY_CODE, \
l.EXCHANGE_RATE, l.AMOUNT, l.JUSTIFICATION, l.PROJECT_ID, l.TASK_ID, l.TRAVEL_TYPE, l.TICKET_CLASS_CODE, \
l.TICKET_NUMBER, l.FLIGHT_NUMBER, l.NUMBER_ATTENDEES, l.ATTENDEES, l.STATUS, l.MODE_OF_TRAVEL, l.PAID_BY_COMPANY, \
l.HOTEL_NAME, l.HOTEL_NO_OF_DAYS, l.HOTEL_RATE, l.HOTEL_BILL_NUMBER, l.FOOD_NAME_OF_HOTEL, l.FOOD_HOTEL_BILL_NUMBER, \
l.PURPOSE, l.MISSING_BILL, l.FUEL_COST_PER_KM, l.MAINTENANCE_PER_KM, l.TOTAL_FUEL_COST, l.TOTAL_MAINTENANCE_COST, \
l.TOLL_CHARGES, l.EXPENSE_TYPE_ID, l.TOTAL_DISTANCE_TRAVELED, l.SEAT_PREFERENCE, l.FROM_CITY, l.TO_CITY, l.FOOD_PREFERENCE, \
l.DEPARTURE_TIME, l.ARRIVAL_TIME, l.BOOKING_TYPE, l.EXPENSE_ATTACHMENT_ID, l.EXPENSE_BILL_NUMBER, l.ADDRESS, \
cmvc.value_name AS carrier, t.Expense_Nature AS Expense_Type_Code, t.Expense_Type_Id, t.EXPENSE_TYPE AS expense_type_pdf, \
t.EXPENSE_NATURE \
FROM LT_EXP_EXPENSE_LINES l \
LEFT JOIN lt_mast_expense_types t ON l.Expense_Type_Id = t.Expense_Type_Id \
LEFT JOIN lt_mast_comn_master_values cmv ON cmv.value_code = l.travel_type \
LEFT JOIN lt_mast_comn_master_values cmvc ON cmvc.value_code = l.carrier \
WHERE l.Exp_Header_id = ? \
ORDER BY l.EXP_LINE_ID

chkLtExpenseApprovalEmpApproval = SELECT * FROM lt_expense_approval v  \
WHERE v.APPROVAL_ID = ? and v.EXP_HEADER_ID = ?  and v.STATUS = ?

updateStatusApproval = UPDATE lt_expense_approval \
SET  Status= ? , LAST_UPDATE_DATE = ?,LAST_UPDATED_BY=? \
WHERE EXP_HEADER_ID = ?  AND (APPROVAL_ID = ? OR DELEGATION_ID = ?)

updateStatusApprovalSelfReject = UPDATE lt_expense_approval \
SET  Status= ? , LAST_UPDATE_DATE = ?,LAST_UPDATED_BY=? \
WHERE EXP_HEADER_ID = ?

#__________________________Expense aprover module

chkIsAprovedByAnyOne = SELECT * FROM  lt_exp_module_approvals b \
WHERE b.MODULE_APPROVAL_ID = ( SELECT MODULE_APPROVAL_ID \
FROM lt_expense_approval WHERE EXP_APPROVAL_ID  = ? )

#__________________________Expense milege queries

getExpMileageLinesByExpHeaderId = SELECT * FROM LT_EXP_MILEAGE_EXPENSE_LINES \
WHERE EXP_HEADER_ID = ? order by TRAVEL_DATE asc

#__________________Expense approval

#getExpenseApprovalByExpHeaderIdBack = SELECT ea.*, \
#( cmv.VALUE_NAME||' '|| em.FIRST_NAME|| ' '||em.LAST_NAME||' '||'('|| em.EMPLOYEE_NUMBER|| ')' ) AS approval_Name \
#FROM lt_expense_approval ea left outer join lt_mast_employees em on ea.APPROVAL_ID=em.EMPLOYEE_ID \
#left outer join LT_MAST_COMN_MASTER_VALUES cmv on em.TITLE = cmv.value_code \
#WHERE ea.EXPENSE_HEADER_ID = ?

getExpenseApprovalByExpHeaderIdBack = SELECT ea.*, \
       CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') AS approval_Name \
FROM lt_expense_approval ea \
LEFT JOIN lt_mast_employees em ON ea.APPROVAL_ID = em.EMPLOYEE_ID \
WHERE ea.EXPENSE_HEADER_ID = ?


#getExpenseApprovalByExpHeaderId = SELECT ea.*, \
#nvl2 (  ea.DELEGATION_ID,\
#(cmv.VALUE_NAME||' '|| em.FIRST_NAME|| ' '||em.LAST_NAME||' '||'('|| em.EMPLOYEE_NUMBER|| ')' ),  \
#( cmv.VALUE_NAME||' '|| em.FIRST_NAME|| ' '||em.LAST_NAME||' '||'('|| em.EMPLOYEE_NUMBER|| ')' )  \
#)  AS approval_Name , \
#CASE ea.MODULE_APPROVAL_ID  \
#WHEN 0 THEN 'Supervisor' \
#ELSE ema.approval_role_name END as approval_level_name \
#FROM lt_expense_approval ea, lt_mast_employees em ,LT_MAST_COMN_MASTER_VALUES cmv, \
#LT_MAST_COMN_MASTER_VALUES cmvv,lt_mast_module_approvals ema ,lt_mast_employees emm  \
#where ea.APPROVAL_ID=em.EMPLOYEE_ID(+) \
#and ea.DELEGATION_ID = emm.EMPLOYEE_ID(+)  \
#and em.TITLE = cmv.value_code(+)  \
#and emm.TITLE = cmvv.value_code(+) \
#and ea.APPROVAL_LEVEL = ema.APPROVAL_LEVEL(+)  \
#and ea.MODULE_APPROVAL_ID = ema.MODULE_APPROVAL_ID(+)  \
#and ea.EXP_HEADER_ID = ? \
#order by ea.APPROVAL_LEVEL

getExpenseApprovalByExpHeaderId = SELECT ea.*, \
       IFNULL( \
           CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'), \
           CONCAT(em.FIRST_NAME, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')') \
       ) AS approval_Name, \
       CASE ea.MODULE_APPROVAL_ID \
           WHEN 0 THEN 'Supervisor' \
           ELSE ema.approval_role_name \
       END AS approval_level_name \
FROM lt_expense_approval ea \
LEFT JOIN lt_mast_employees em ON ea.APPROVAL_ID = em.EMPLOYEE_ID \
LEFT JOIN lt_mast_employees emm ON ea.DELEGATION_ID = emm.EMPLOYEE_ID \
LEFT JOIN lt_mast_module_approvals ema ON ea.APPROVAL_LEVEL = ema.APPROVAL_LEVEL \
                                        AND ea.MODULE_APPROVAL_ID = ema.MODULE_APPROVAL_ID \
WHERE ea.EXP_HEADER_ID = ? \
ORDER BY ea.APPROVAL_LEVEL


checkforApprovals = select  mdl.APPROVAL_ROLE_NAME \
from LT_EXP_MODULE_APPROVALS mdl, LT_EXP_EXPENSE_HEADERS eh \
where mdl.DIVISION_ID = eh.DIVISION_ID \
AND mdl.MODULE = eh.EXPENSE_CATEGORY \
AND mdl.REQUIRED_LEVEL = 'Y'  \
AND mdl.APPROVAL_LEVEL NOT IN (select APPROVAL_LEVEL from LT_EXPENSE_APPROVAL where EXP_HEADER_ID = eh.EXP_HEADER_ID) \
AND eh.EXP_HEADER_ID = ?

submitForApproval1 = UPDATE lt_exp_expense_headers \
SET Expense_Submission_Date=? ,  Status= ? , Approved_Date=?, LAST_UPDATE_DATE = ?  \
WHERE Exp_Header_id=?
 
submitExpenseForApproval2 = UPDATE lt_exp_expense_headers SET  \
Status= ? , Approved_Date=?, LAST_UPDATE_DATE = ?  WHERE Exp_Header_id=?

updateAllStatusApproval = UPDATE lt_expense_approval \
SET  Status= ? ,LAST_UPDATE_DATE=?,LAST_UPDATED_BY=? \
WHERE EXP_HEADER_ID = ?  AND CURRENT_APPROVAL_LEVEL =  APPROVAL_LEVEL  

getCurrLevelByexpenseApprovalId = select  CURRENT_APPROVAL_LEVEL from lt_expense_approval where EXP_APPROVAL_ID= ?

chkCurrentApprover = select * from  lt_expense_approval ea \
where ea.EXPENSE_HEADER_ID = ? AND ea.status = 'PENDING'

getExpenseApproval = SELECT * FROM lt_expense_approval v \
WHERE EXP_HEADER_ID = ?  AND CURRENT_APPROVAL_LEVEL =  APPROVAL_LEVEL \
AND (APPROVAL_ID = ? OR DELEGATION_ID = ? ) AND status= 'PENDING'

#Dashboard Queries 

getExpenseCountByHeaderId_Dashboard = Select eh.Status,  count( eh.Exp_Header_id )  as count \
from lt_exp_expense_headers  eh  \
 where eh.status <> 'APPROVED'  \
 AND eh.Employee_id= ?  \
 group by eh.Status
 
 getExpenseTypeByEmpId_Dashboard = select count(et.Expense_Type_Id) as count ,et.Expense_Type  \
from lt_exp_expense_lines el ,lt_exp_expense_headers eh,lt_mast_expense_types et  \
Where el.Exp_Header_id=eh.Exp_Header_id  \
AND el.Expense_Type_Id=et.Expense_Type_Id  \
AND eh.Employee_id= ?  \
group by et.Expense_Type

getNotificatioByEmpId_Dashboard = select CONCAT(eh.Expense_Number,' IS ',ea.STATUS) AS notification,\
eh.Exp_Header_id as expenseHeaderId,eh.expense_category as expense_Category, \
eh.Expense_Number as expenseNumber \
from lt_expense_approval ea , \
lt_exp_expense_headers eh ,  \
lt_mast_employees em \
where ea.EXP_HEADER_ID = eh.Exp_Header_id \
and em.employee_id=eh.employee_id \
AND ea.STATUS IN (? ,?,?) \
and (ea.APPROVAL_ID = ? or ea.DELEGATION_ID = ? )  \
order by eh.LAST_UPDATE_DATE desc

deleteExpenseLineAttachments = delete from lt_exp_expense_attachments \
where expence_line_id = ?

deleteExpenseHeaderAttachments = delete from lt_exp_expense_attachments \
where expense_attachment_id = ?
				
				