getLtMastCommunicationTabByVendorBuyer = SELECT * FROM LT_MAST_COMMUNICATION_TAB WHERE VENDOR_ID = ? AND COMPANY_ID = ?


getAllCommunicationByComId = SELECT a.* FROM \
(SELECT mc.COMMUNICATION_ID,mc.VENDOR_ID,mc.BUYER_ID,mc.LAST_UPDATED_BY,mc.LAST_UPDATE_DATE,mc.COMPANY_ID , \
mv.VENDOR_NAME,mu.USER_NAME as buyer_name, nvl(ctd.BUYER_MSG,ctd.VENDOR_MSG) as BUYER_MSG  \
FROM LT_MAST_COMMUNICATION_TAB mc,LT_MAST_VENDORS mv,LT_MAST_USERS mu,LT_MAST_COMMUNICATION_TAB_DET ctd \
WHERE mc.COMPANY_ID = ? AND mc.VENDOR_ID = mv.VENDOR_ID(+) AND mc.COMMUNICATION_ID = ctd.COMMUNICATION_ID \
AND mc.LAST_UPDATED_BY = mu.USER_ID(+) \
AND mc.LAST_UPDATE_DATE = ctd.LAST_UPDATE_DATE(+) \
ORDER BY mc.LAST_UPDATE_DATE DESC ) a WHERE ROWNUM <=20


getallvendorcommunication = select cd.MESSAGE_ID, cd.COMMUNICATION_ID, cd.VENDOR_MSG, cd.BUYER_MSG, cd.LAST_UPDATED_BY, \
cd.LAST_UPDATE_DATE ,mu.USER_NAME, mv.VENDOR_NAME, mv.VENDOR_ID, me.FIRST_NAME||' '||me.LAST_NAME as BUYER_NAME  \
from LT_MAST_COMMUNICATION_TAB_DET cd,LT_MAST_USERS mu,LT_MAST_VENDORS mv,LT_MAST_EMPLOYEES me  \
WHERE cd.LAST_UPDATED_BY = mu.USER_ID(+) \
AND cd.COMMUNICATION_ID = ?  \
AND mu.VENDOR_ID = mv.VENDOR_ID(+) \
AND mu.EMPLOYEE_ID = me.EMPLOYEE_ID(+) \
ORDER BY cd.LAST_UPDATE_DATE desc


getAllBuyerCommunication = SELECT mc.COMMUNICATION_ID,mc.VENDOR_ID,mc.BUYER_ID,mc.LAST_UPDATED_BY,mc.LAST_UPDATE_DATE, \
mc.COMPANY_ID , mv.VENDOR_NAME,mu.USER_NAME as buyer_name \
FROM LT_MAST_COMMUNICATION_TAB mc,LT_MAST_VENDORS mv,LT_MAST_USERS mu \
WHERE mc.VENDOR_ID = ?   \
AND mc.VENDOR_ID = mv.VENDOR_ID(+) \
AND mc.LAST_UPDATED_BY = mu.USER_ID(+)

getVendorNotificationCount = select ct.BUYER_ID,ct.VENDOR_ID,td.* \
from LT_MAST_COMMUNICATION_TAB_DET td ,LT_MAST_COMMUNICATION_TAB ct \
where  ct.COMMUNICATION_ID = td.COMMUNICATION_ID(+) \
and ct.VENDOR_ID = ?  \
and td.NOTIFICATION_FLAG IS NULL AND td.BUYER_MSG IS NOT NULL



getBuuyerNotificationCount = select td.*,ct.*,mv.VENDOR_NAME   \
from LT_MAST_COMMUNICATION_TAB_DET td ,LT_MAST_COMMUNICATION_TAB ct ,LT_MAST_VENDORS mv \
where  ct.COMMUNICATION_ID = td.COMMUNICATION_ID  AND ct.VENDOR_ID = mv.VENDOR_ID(+) \
and ct.COMPANY_ID = ( select company_id from LT_MAST_EMPLOYEES where employee_id = ? ) \
and td.NOTIFICATION_FLAG IS NULL \
AND td.VENDOR_MSG IS NOT NULL \
AND ct.LAST_UPDATE_DATE = td.LAST_UPDATE_DATE


updateVendorNotification = update LT_MAST_COMMUNICATION_TAB_DET set NOTIFICATION_FLAG = 'N' \
Where COMMUNICATION_ID IN  ( SELECT COMMUNICATION_ID FROM LT_MAST_COMMUNICATION_TAB WHERE VENDOR_ID = ? )


updateBuuyerNotification_03-07-2019 = update LT_MAST_COMMUNICATION_TAB_DET set NOTIFICATION_FLAG = 'N' \
Where COMMUNICATION_ID IN ( SELECT COMMUNICATION_ID FROM LT_MAST_COMMUNICATION_TAB WHERE BUYER_ID = ? AND VENDOR_ID = ? )

updateBuuyerNotification = update LT_MAST_COMMUNICATION_TAB_DET set NOTIFICATION_FLAG = 'N' \
Where COMMUNICATION_ID IN ( SELECT COMMUNICATION_ID FROM LT_MAST_COMMUNICATION_TAB WHERE VENDOR_ID = ? )

getLikeNameByBuyerId = select ven.* \
from LT_MAST_VENDORS ven where  ven.INITIATOR_ID = ? \
AND UPPER(ven.VENDOR_NAME) like ? \
AND ven.START_DATE <= SYSDATE \
AND (ven.END_DATE IS NULL OR ven.END_DATE >= SYSDATE)


getLikeNameByBuyerName = select ven.* \
from  LT_MAST_VENDORS ven \
where  UPPER(ven.VENDOR_NAME) like ? \
AND ven.START_DATE <= SYSDATE \
AND (ven.END_DATE IS NULL OR ven.END_DATE >= SYSDATE)

getVendorMsgByBuyerId = SELECT ctd.COMMUNICATION_ID, ctd.MESSAGE_ID,ctd.VENDOR_MSG, \
ctd.BUYER_MSG,ctd.LAST_UPDATE_DATE, mv.VENDOR_NAME,mv.VENDOR_ID   \
FROM LT_MAST_COMMUNICATION_TAB_DET ctd,LT_MAST_VENDORS mv,LT_MAST_COMMUNICATION_TAB ct  \
WHERE  ctd.VENDOR_MSG IS NOT NULL \
AND ct.VENDOR_ID = mv.VENDOR_ID \
AND ct.COMMUNICATION_ID = ctd.COMMUNICATION_ID \
AND ctd.LAST_UPDATE_DATE = ( SELECT max(LAST_UPDATE_DATE) \
						FROM LT_MAST_COMMUNICATION_TAB_DET a WHERE  VENDOR_MSG IS NOT NULL \
						AND ctd.COMMUNICATION_ID = COMMUNICATION_ID  \
						GROUP BY COMMUNICATION_ID ) \
AND ct.COMPANY_ID = ( select company_id from lt_mast_employees where employee_id = ? ) ORDER BY ctd.LAST_UPDATE_DATE DESC


