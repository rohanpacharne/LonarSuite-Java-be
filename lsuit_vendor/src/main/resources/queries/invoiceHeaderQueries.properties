#getLtInvoiceHeadersDataTable =  select  *  from \
#(SELECT a.*,ROWNUM RNUM from \
#( select  ih.INVOICE_HEADER_ID, cmv.value_name as INVOICE_TYPE,ih.INTERNAL_INVOICE_NUMBER,ih.INVOICE_NUM, \
#ih.INVOICE_DATE,ih.INVOICE_RECEIVED_DATE,ih.PO_HEADER_ID,ih.BUYER_ID,ih.VENDOR_ID,ih.VENDOR_ADD_ID, \
#ih.DESCRIPTION,ih.INVOICE_AMOUNT,ih.BILLING_ADD_ID,ih.SHIPPING_ADD_ID,cmvs.value_name as STATUS,ih.AMOUNT_PAID, \
#ih.VOUCHER_NUM,ih.VOUCHER_DATE,ih.INVOICE_CURRENCY,ih.SOURCE,ih.SOURCE_REF_NO, \
#nvl2(me.EMPLOYEE_ID,( cmvt.value_name||' ' || me.first_name || ' '|| me.LAST_NAME||' ' || '(' ||me.EMPLOYEE_NUMBER||')' ),'') AS buyer , \
#ph.PO_NUMBER  \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvs, \
#LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER_VALUES cmvt ,LT_PO_HEADERS ph   \
#where cmvs.value_code(+) = ih.status \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND me.COMPANY_ID = ?  \
#AND ih.PO_HEADER_ID = ph.PO_HEADER_ID(+) \
#AND ( nvl(ih.INITIATOR_ID,-99) = nvl(?,nvl(ih.INITIATOR_ID,-99)) \
#OR nvl(ih.BUYER_ID,-99) = nvl(?,nvl(ih.BUYER_ID,-99)) ) \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))  \
#AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx')) \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))  \
#AND nvl( upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx') ) \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99) ) \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99)  ) \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx')  ) \
#AND nvl(upper(ph.PO_NUMBER),'xx') like nvl(?,nvl(upper(ph.PO_NUMBER),'xx')  ) \
#order by \
#CASE WHEN 2 = ? then upper(ih.INVOICE_TYPE) END asc, \
#CASE WHEN 12 = ? then upper(ih.INVOICE_TYPE) END desc, \
#CASE WHEN 3 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END asc, \
#CASE WHEN 13 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END desc, \
#CASE WHEN 4 = ? then upper(ih.INVOICE_NUM) END asc, \
#CASE WHEN 14 = ? then upper(ih.INVOICE_NUM) END desc, \
#CASE WHEN 5 = ? then ih.INVOICE_DATE END asc, \
#CASE WHEN 15 = ? then ih.INVOICE_DATE END desc, \
#CASE WHEN 6 = ? then upper(ih.DESCRIPTION) END asc, \
#CASE WHEN 16 = ? then (ih.DESCRIPTION) END desc, \
#CASE WHEN 7 = ? then ih.INVOICE_AMOUNT END asc, \
#CASE WHEN 17 = ? then ih.INVOICE_AMOUNT END desc, \
#CASE WHEN 9 = ? then upper(cmvs.value_name) END asc, \
#CASE WHEN 19 = ? then upper(cmvs.value_name) END desc,\
#CASE WHEN 10 = ? then ih.AMOUNT_PAID END asc, \
#CASE WHEN 20 = ? then ih.AMOUNT_PAID END desc, \
#CASE WHEN 8 = ? then ph.PO_NUMBER END asc, \
#CASE WHEN 18 = ? then ph.PO_NUMBER END desc, \
#CASE WHEN 1 = ? then ih.last_update_date END desc, \
#CASE WHEN 11 = ? then ih.last_update_date END asc)a  where ROWNUM <=?) WHERE rnum >=?

getLtInvoiceHeadersDataTable =  SELECT * FROM \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM \
(SELECT ih.INVOICE_HEADER_ID, cmv.value_name AS INVOICE_TYPE, ih.INTERNAL_INVOICE_NUMBER, ih.INVOICE_NUM, \
ih.INVOICE_DATE, ih.INVOICE_RECEIVED_DATE, ih.PO_HEADER_ID, ih.BUYER_ID, ih.VENDOR_ID, ih.VENDOR_ADD_ID, \
ih.DESCRIPTION, ih.INVOICE_AMOUNT, ih.BILLING_ADD_ID, ih.SHIPPING_ADD_ID, cmvs.value_name AS STATUS, ih.AMOUNT_PAID, \
ih.VOUCHER_NUM, ih.VOUCHER_DATE, ih.INVOICE_CURRENCY, ih.SOURCE, ih.SOURCE_REF_NO, \
IF(me.EMPLOYEE_ID IS NOT NULL, CONCAT(me.first_name, ' ', me.LAST_NAME, ' (', me.EMPLOYEE_NUMBER, ')'), '') AS buyer, \
ph.PO_NUMBER,cmvs.value_code,cmvs.value_name, \
ih.creation_date \
FROM LT_INVOICE_HEADERS ih \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
and cmvs.master_id = (select master_id from lt_mast_comn_master where master_name = 'INVOICE_STATUS') \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
LEFT JOIN LT_PO_HEADERS ph ON ih.PO_HEADER_ID = ph.PO_HEADER_ID \
WHERE ih.COMPANY_ID = ? \
AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx')) \
AND IFNULL(UPPER(ph.PO_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ph.PO_NUMBER), 'xx')) \
ORDER BY \
CASE WHEN 2 = ? THEN UPPER(ih.INVOICE_TYPE) END ASC, \
CASE WHEN 12 = ? THEN UPPER(ih.INVOICE_TYPE) END DESC, \
CASE WHEN 3 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END ASC, \
CASE WHEN 13 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END DESC, \
CASE WHEN 4 = ? THEN UPPER(ih.INVOICE_NUM) END ASC, \
CASE WHEN 14 = ? THEN UPPER(ih.INVOICE_NUM) END DESC, \
CASE WHEN 5 = ? THEN ih.INVOICE_DATE END ASC, \
CASE WHEN 15 = ? THEN ih.INVOICE_DATE END DESC, \
CASE WHEN 6 = ? THEN UPPER(ih.DESCRIPTION) END ASC, \
CASE WHEN 16 = ? THEN ih.DESCRIPTION END DESC, \
CASE WHEN 7 = ? THEN ih.INVOICE_AMOUNT END ASC, \
CASE WHEN 17 = ? THEN ih.INVOICE_AMOUNT END DESC, \
CASE WHEN 9 = ? THEN UPPER(cmvs.value_name) END ASC, \
CASE WHEN 19 = ? THEN UPPER(cmvs.value_name) END DESC, \
CASE WHEN 10 = ? THEN ih.AMOUNT_PAID END ASC, \
CASE WHEN 20 = ? THEN ih.AMOUNT_PAID END DESC, \
CASE WHEN 8 = ? THEN ph.PO_NUMBER END ASC, \
CASE WHEN 18 = ? THEN ph.PO_NUMBER END DESC, \
CASE WHEN 1 = ? THEN ih.last_update_date END DESC, \
CASE WHEN 11 = ? THEN ih.last_update_date END ASC \
) a, (SELECT @rownum := 0) r \
WHERE @rownum < ?) AS t \
WHERE RNUM >= ?



#getLtInvoiceHeadersCount = select count(ih.INVOICE_HEADER_ID) \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvs, \
#LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER_VALUES cmvt ,LT_PO_HEADERS ph   \
#where cmvs.value_code(+) = ih.status \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND me.COMPANY_ID = ?  \
#AND ih.PO_HEADER_ID = ph.PO_HEADER_ID(+) \
#AND ( nvl(ih.INITIATOR_ID,-99) = nvl(?,nvl(ih.INITIATOR_ID,-99)) \
#OR nvl(ih.BUYER_ID,-99) = nvl(?,nvl(ih.BUYER_ID,-99)) ) \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))  \
#AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx')) \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))  \
#AND nvl( upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx') ) \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99) ) \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99)  ) \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx')  ) \
#AND nvl(upper(ph.PO_NUMBER),'xx') like nvl(?,nvl(upper(ph.PO_NUMBER),'xx')  )

#This is original query commented on 12 Nov 24 to remove condition of initiator and buyer id
#getLtInvoiceHeadersCount = SELECT COUNT(ih.INVOICE_HEADER_ID) \
#FROM LT_INVOICE_HEADERS ih \
#LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
#LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
#and cmvs.master_id = (select master_id from lt_mast_comn_master where master_name = 'INVOICE_STATUS') \
#LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
#LEFT JOIN LT_PO_HEADERS ph ON ih.PO_HEADER_ID = ph.PO_HEADER_ID \
#WHERE ih.COMPANY_ID = ? \
#AND (IFNULL(ih.INITIATOR_ID, -99) = IFNULL(?, IFNULL(ih.INITIATOR_ID, -99)) \
#OR IFNULL(ih.BUYER_ID, -99) = IFNULL(?, IFNULL(ih.BUYER_ID, -99))) \
#AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
#AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
#AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
#AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
#AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
#AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
#AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
#AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx')) \
#AND IFNULL(UPPER(ph.PO_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ph.PO_NUMBER), 'xx'))

getLtInvoiceHeadersCount = SELECT COUNT(ih.INVOICE_HEADER_ID) \
FROM LT_INVOICE_HEADERS ih \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
and cmvs.master_id = (select master_id from lt_mast_comn_master where master_name = 'INVOICE_STATUS') \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
LEFT JOIN LT_PO_HEADERS ph ON ih.PO_HEADER_ID = ph.PO_HEADER_ID \
WHERE ih.COMPANY_ID = ? \
AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx')) \
AND IFNULL(UPPER(ph.PO_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ph.PO_NUMBER), 'xx'))



#getLtInvoiceHeadersCountByVendorId = select count(ih.INVOICE_HEADER_ID) \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvs,LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER_VALUES cmvt \
#where cmvs.value_code(+) = ih.status \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND ih.VENDOR_ID = ? \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))  \
#AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx'))  \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))  \
#AND nvl(upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx'))  \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99))  \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99))  \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx'))

getLtInvoiceHeadersCountByVendorId = SELECT COUNT(ih.INVOICE_HEADER_ID) \
FROM LT_INVOICE_HEADERS ih \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
WHERE ih.VENDOR_ID = ? \
AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx'))


#getLtInvoiceHeadersCountByVendorId_21-05-24 = select count(ih.INVOICE_HEADER_ID) \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER lmcm,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER lmcms,LT_MAST_COMN_MASTER_VALUES cmvs,LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER lmcmt,LT_MAST_COMN_MASTER_VALUES cmvt \
#where cmvs.value_code(+) = ih.status \
#AND lmcms.master_name = 'INVOICE_STATUS' \
#AND lmcms.master_id = cmvs.master_id \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND lmcmt.master_name = 'TITLE_MASTER' \
#AND lmcmt.master_id = cmvt.master_id \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND lmcm.master_name = 'INVOICE_TYPE' \
#AND lmcm.master_id = cmv.master_id \
#AND ih.VENDOR_ID = ? \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))  \
#AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx'))  \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))  \
#AND nvl(upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx'))  \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99))  \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99))  \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx'))

getLtInvoiceHeadersCountByVendorId_21-05-24 = SELECT COUNT(ih.INVOICE_HEADER_ID)  \
FROM LT_INVOICE_HEADERS ih  \
LEFT JOIN LT_MAST_COMN_MASTER lmcm ON lmcm.master_name = 'INVOICE_TYPE' \
AND lmcm.MASTER_ID = (select MASTER_ID from LT_MAST_COMN_MASTER where master_name = 'INVOICE_TYPE')\
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE  \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status  \
AND cmvs.MASTER_ID = (Select MASTER_ID from  LT_MAST_COMN_MASTER lmcms Where lmcms.master_name = 'INVOICE_STATUS'  ) \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID  \
WHERE ih.VENDOR_ID = ? \
AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx'))  \
AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx'))  \
AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx'))  \
AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx'))  \
AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99))  \
AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99))  \
AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx'))

#getLtInvoiceHeadersDataTableByVendorId = select  *  from (SELECT a.*,ROWNUM RNUM from ( select  \
#ih.INVOICE_HEADER_ID, cmv.value_name as INVOICE_TYPE,ih.INTERNAL_INVOICE_NUMBER,ih.INVOICE_NUM, \
#ih.INVOICE_DATE,ih.INVOICE_RECEIVED_DATE,ih.PO_HEADER_ID,ih.BUYER_ID,ih.VENDOR_ID,ih.VENDOR_ADD_ID,\
#ih.DESCRIPTION,ih.INVOICE_AMOUNT,ih.BILLING_ADD_ID,ih.SHIPPING_ADD_ID,cmvs.value_name as STATUS,ih.AMOUNT_PAID,\
#ih.VOUCHER_NUM,ih.VOUCHER_DATE,ih.INVOICE_CURRENCY,ih.SOURCE,ih.SOURCE_REF_NO,\
#nvl2(me.EMPLOYEE_ID,( cmvt.value_name||' ' || me.first_name || ' '|| me.LAST_NAME||' ' || '(' ||me.EMPLOYEE_NUMBER||')' ),'') AS buyer \
#,po.PO_NUMBER \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvs, \
#LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER_VALUES cmvt,lt_po_headers po \
#where cmvs.value_code(+) = ih.status \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND ih.VENDOR_ID = ? \
#AND ih.PO_HEADER_ID = po.PO_HEADER_ID(+) \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))  \
#AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx'))  \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))  \
#AND nvl(upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx'))  \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99))  \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99))  \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx'))  \
#order by \
#CASE WHEN 2 = ? then upper(ih.INVOICE_TYPE) END asc, \
#CASE WHEN 12 = ? then upper(ih.INVOICE_TYPE) END desc, \
#CASE WHEN 3 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END asc, \
#CASE WHEN 13 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END desc, \
#CASE WHEN 4 = ? then upper(ih.INVOICE_NUM) END asc, \
#CASE WHEN 14 = ? then upper(ih.INVOICE_NUM) END desc, \
#CASE WHEN 5 = ? then ih.INVOICE_DATE END asc, \
#CASE WHEN 15 = ? then ih.INVOICE_DATE END desc, \
#CASE WHEN 6 = ? then upper(ih.DESCRIPTION) END asc, \
#CASE WHEN 16 = ? then (ih.DESCRIPTION) END desc, \
#CASE WHEN 7 = ? then ih.INVOICE_AMOUNT END asc, \
#CASE WHEN 17 = ? then ih.INVOICE_AMOUNT END desc, \
#CASE WHEN 9 = ? then ih.AMOUNT_PAID END asc, \
#CASE WHEN 19 = ? then ih.AMOUNT_PAID END desc, \
#CASE WHEN 8 = ? then upper(cmvs.value_name) END asc, \
#CASE WHEN 18 = ? then upper(cmvs.value_name) END desc,\
#CASE WHEN 1 = ? then ih.last_update_date END desc, \
#CASE WHEN 11 = ? then ih.last_update_date END asc)a  where ROWNUM <=?) WHERE rnum >=?

getLtInvoiceHeadersDataTableByVendorId = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT \
            ih.INVOICE_HEADER_ID, \
            cmv.value_name AS INVOICE_TYPE, \
            ih.INTERNAL_INVOICE_NUMBER, \
            ih.INVOICE_NUM, \
            ih.INVOICE_DATE, \
            ih.INVOICE_RECEIVED_DATE, \
            ih.PO_HEADER_ID, \
            ih.BUYER_ID, \
            ih.VENDOR_ID, \
            ih.VENDOR_ADD_ID, \
            ih.DESCRIPTION, \
            ih.INVOICE_AMOUNT, \
            ih.BILLING_ADD_ID, \
            ih.SHIPPING_ADD_ID, \
            cmvs.value_name AS STATUS, \
            ih.AMOUNT_PAID, \
            ih.VOUCHER_NUM, \
            ih.VOUCHER_DATE, \
            ih.INVOICE_CURRENCY, \
            ih.SOURCE, \
            ih.SOURCE_REF_NO, \
            IF(me.EMPLOYEE_ID IS NOT NULL, CONCAT(me.first_name, ' ', me.LAST_NAME, ' (', me.EMPLOYEE_NUMBER, ')'), '') AS buyer, \
            po.PO_NUMBER \
        FROM LT_INVOICE_HEADERS ih \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
        LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
        LEFT JOIN LT_PO_HEADERS po ON ih.PO_HEADER_ID = po.PO_HEADER_ID \
        WHERE ih.VENDOR_ID = ? \
        AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
        AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
        AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
        AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
        AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
        AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
        AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
        AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx')) \
        ORDER BY \
            CASE WHEN 2 = ? THEN UPPER(ih.INVOICE_TYPE) END ASC, \
            CASE WHEN 12 = ? THEN UPPER(ih.INVOICE_TYPE) END DESC, \
            CASE WHEN 3 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END ASC, \
            CASE WHEN 13 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END DESC, \
            CASE WHEN 4 = ? THEN UPPER(ih.INVOICE_NUM) END ASC, \
            CASE WHEN 14 = ? THEN UPPER(ih.INVOICE_NUM) END DESC, \
            CASE WHEN 5 = ? THEN ih.INVOICE_DATE END ASC, \
            CASE WHEN 15 = ? THEN ih.INVOICE_DATE END DESC, \
            CASE WHEN 6 = ? THEN UPPER(ih.DESCRIPTION) END ASC, \
            CASE WHEN 16 = ? THEN ih.DESCRIPTION END DESC, \
            CASE WHEN 7 = ? THEN ih.INVOICE_AMOUNT END ASC, \
            CASE WHEN 17 = ? THEN ih.INVOICE_AMOUNT END DESC, \
            CASE WHEN 9 = ? THEN ih.AMOUNT_PAID END ASC, \
            CASE WHEN 19 = ? THEN ih.AMOUNT_PAID END DESC, \
            CASE WHEN 8 = ? THEN UPPER(cmvs.value_name) END ASC, \
            CASE WHEN 18 = ? THEN UPPER(cmvs.value_name) END DESC, \
            CASE WHEN 1 = ? THEN ih.last_update_date END DESC, \
            CASE WHEN 11 = ? THEN ih.last_update_date END ASC \
    ) a, (SELECT @rownum := 0) rnum \
    WHERE RNUM <= ? \
) WHERE RNUM >= ?



#getLtInvoiceHeadersDataTableByVendorId_21-05-24 = select  *  from (SELECT a.*,ROWNUM RNUM from ( select   \
#ih.INVOICE_HEADER_ID, cmv.value_name as INVOICE_TYPE,ih.INTERNAL_INVOICE_NUMBER,ih.INVOICE_NUM,  \
#ih.INVOICE_DATE,ih.INVOICE_RECEIVED_DATE,ih.PO_HEADER_ID,ih.BUYER_ID,ih.VENDOR_ID,ih.VENDOR_ADD_ID, \
#ih.DESCRIPTION,ih.INVOICE_AMOUNT,ih.BILLING_ADD_ID,ih.SHIPPING_ADD_ID,cmvs.value_name as STATUS,ih.AMOUNT_PAID, \
#ih.VOUCHER_NUM,ih.VOUCHER_DATE,ih.INVOICE_CURRENCY,ih.SOURCE,ih.SOURCE_REF_NO, \
#nvl2(me.EMPLOYEE_ID,( cmvt.value_name||' ' || me.first_name || ' '|| me.LAST_NAME||' ' || '(' ||me.EMPLOYEE_NUMBER||')' ),'') AS buyer  \
#,po.PO_NUMBER  \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER lmcm,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER lmcms,LT_MAST_COMN_MASTER_VALUES cmvs,LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER lmcmt,LT_MAST_COMN_MASTER_VALUES cmvt,lt_po_headers po  \
#where cmvs.value_code(+) = ih.status \
#AND lmcms.master_name = 'INVOICE_STATUS' \
#AND lmcms.master_id = cmvs.master_id \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID  \
#AND cmvt.value_code(+) = me.TITLE  \
#AND lmcmt.master_name = 'TITLE_MASTER' \
#AND lmcmt.master_id = cmvt.master_id \
#AND cmv.value_code(+) = ih.INVOICE_TYPE  \
#AND lmcm.master_name = 'INVOICE_TYPE' \
#AND lmcm.master_id = cmv.master_id \
#AND ih.VENDOR_ID = ? \
#AND ih.PO_HEADER_ID = po.PO_HEADER_ID(+)  \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx')) AND nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx') like nvl(?,nvl(upper(ih.INTERNAL_INVOICE_NUMBER),'xx')) \
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx'))   \
#AND  TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY')) AND nvl(upper(ih.DESCRIPTION),'xx') like nvl(?,nvl(upper(ih.DESCRIPTION),'xx'))   \
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99))   \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99))   \
#AND nvl(upper(cmvs.value_name),'xx') like nvl(?,nvl(upper(cmvs.value_name),'xx'))   \
#order by  \
#CASE WHEN 2 = ? then upper(ih.INVOICE_TYPE) END asc, CASE WHEN 12 = ? then upper(ih.INVOICE_TYPE) END desc,  \
#CASE WHEN 3 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END asc,  \
#CASE WHEN 13 = ? then upper(ih.INTERNAL_INVOICE_NUMBER) END desc,  \
#CASE WHEN 4 = ? then upper(ih.INVOICE_NUM) END asc,  \
#CASE WHEN 14 = ? then upper(ih.INVOICE_NUM) END desc,  \
#CASE WHEN 5 = ? then ih.INVOICE_DATE END asc,  \
#CASE WHEN 15 = ? then ih.INVOICE_DATE END desc, CASE WHEN 6 = ? then upper(ih.DESCRIPTION) END asc, CASE WHEN 16 = ? then (ih.DESCRIPTION) END desc,  \
#CASE WHEN 7 = ? then ih.INVOICE_AMOUNT END asc,  \
#CASE WHEN 17 = ? then ih.INVOICE_AMOUNT END desc, CASE WHEN 9 = ? then ih.AMOUNT_PAID END asc,  \
#CASE WHEN 19 = ? then ih.AMOUNT_PAID END desc,  \
#CASE WHEN 8 = ? then upper(cmvs.value_name) END asc,  \
#CASE WHEN 18 = ? then upper(cmvs.value_name) END desc, \
#CASE WHEN 1 = ? then ih.last_update_date END desc,  \
#CASE WHEN 11 = ? then ih.last_update_date END asc)a  where ROWNUM <=?) WHERE rnum >=? 

getLtInvoiceHeadersDataTableByVendorId_21-05-24 = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT \
            ih.INVOICE_HEADER_ID, \
            cmv.value_name AS INVOICE_TYPE, \
            ih.INTERNAL_INVOICE_NUMBER, \
            ih.INVOICE_NUM, \
            ih.INVOICE_DATE, \
            ih.INVOICE_RECEIVED_DATE, \
            ih.PO_HEADER_ID, \
            ih.BUYER_ID, \
            ih.VENDOR_ID, \
            ih.VENDOR_ADD_ID, \
            ih.DESCRIPTION, \
            ih.INVOICE_AMOUNT, \
            ih.BILLING_ADD_ID, \
            ih.SHIPPING_ADD_ID, \
            cmvs.value_name AS STATUS, \
            ih.AMOUNT_PAID, \
            ih.VOUCHER_NUM, \
            ih.VOUCHER_DATE, \
            ih.INVOICE_CURRENCY, \
            ih.SOURCE, \
            ih.SOURCE_REF_NO, \
            IF(me.EMPLOYEE_ID IS NOT NULL, CONCAT(me.first_name, ' ', me.LAST_NAME, ' (', me.EMPLOYEE_NUMBER, ')'), '') AS buyer, \
            po.PO_NUMBER, \
            cmvs.value_name, \
            cmvs.value_code \
        FROM LT_INVOICE_HEADERS ih \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
        LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
        LEFT JOIN LT_MAST_COMN_MASTER lmcms ON lmcms.master_name = 'INVOICE_STATUS' \
        LEFT JOIN LT_MAST_COMN_MASTER lmcm ON lmcm.master_name = 'INVOICE_TYPE' \
        LEFT JOIN LT_PO_HEADERS po ON ih.PO_HEADER_ID = po.PO_HEADER_ID \
        WHERE ih.VENDOR_ID = ? \
        AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
        AND IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INTERNAL_INVOICE_NUMBER), 'xx')) \
        AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
        AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
        AND IFNULL(UPPER(ih.DESCRIPTION), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.DESCRIPTION), 'xx')) \
        AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
        AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
        AND IFNULL(UPPER(cmvs.value_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(cmvs.value_name), 'xx')) \
        ORDER BY \
            CASE WHEN 2 = ? THEN UPPER(ih.INVOICE_TYPE) END ASC, \
            CASE WHEN 12 = ? THEN UPPER(ih.INVOICE_TYPE) END DESC, \
            CASE WHEN 3 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END ASC, \
            CASE WHEN 13 = ? THEN UPPER(ih.INTERNAL_INVOICE_NUMBER) END DESC, \
            CASE WHEN 4 = ? THEN UPPER(ih.INVOICE_NUM) END ASC, \
            CASE WHEN 14 = ? THEN UPPER(ih.INVOICE_NUM) END DESC, \
            CASE WHEN 5 = ? THEN ih.INVOICE_DATE END ASC, \
            CASE WHEN 15 = ? THEN ih.INVOICE_DATE END DESC, \
            CASE WHEN 6 = ? THEN UPPER(ih.DESCRIPTION) END ASC, \
            CASE WHEN 16 = ? THEN ih.DESCRIPTION END DESC, \
            CASE WHEN 7 = ? THEN ih.INVOICE_AMOUNT END ASC, \
            CASE WHEN 17 = ? THEN ih.INVOICE_AMOUNT END DESC, \
            CASE WHEN 9 = ? THEN ih.AMOUNT_PAID END ASC, \
            CASE WHEN 19 = ? THEN ih.AMOUNT_PAID END DESC, \
            CASE WHEN 8 = ? THEN UPPER(cmvs.value_name) END ASC, \
            CASE WHEN 18 = ? THEN UPPER(cmvs.value_name) END DESC, \
            CASE WHEN 1 = ? THEN ih.last_update_date END DESC, \
            CASE WHEN 11 = ? THEN ih.last_update_date END ASC \
    ) a, (SELECT @rownum := 0) rnum \
)AS paginated_results \
 WHERE RNUM <= ? AND RNUM >= ?


#getLtInvoiceHeadersDataTableByVendorId1 = select  *  from (SELECT a.*,ROWNUM RNUM from ( select \
#ih.INVOICE_HEADER_ID, cmv.value_name as INVOICE_TYPE,ih.INTERNAL_INVOICE_NUMBER,ih.INVOICE_NUM, \
#ih.INVOICE_DATE,ih.INVOICE_RECEIVED_DATE,ih.PO_HEADER_ID,ih.BUYER_ID,ih.VENDOR_ID,ih.VENDOR_ADD_ID,\
#ih.DESCRIPTION,ih.INVOICE_AMOUNT,ih.BILLING_ADD_ID,ih.SHIPPING_ADD_ID,cmvs.value_name as STATUS,ih.AMOUNT_PAID,\
#ih.VOUCHER_NUM,ih.VOUCHER_DATE,ih.INVOICE_CURRENCY,ih.SOURCE,ih.SOURCE_REF_NO,\
#nvl2(me.EMPLOYEE_ID,( cmvt.value_name||' ' || me.first_name || ' '|| me.LAST_NAME||' ' || '(' ||me.EMPLOYEE_NUMBER||')' ),'') AS buyer \
#,po.PO_NUMBER \
#from LT_INVOICE_HEADERS  ih ,LT_MAST_COMN_MASTER_VALUES cmv,LT_MAST_COMN_MASTER_VALUES cmvs, \
#LT_MAST_EMPLOYEES me ,LT_MAST_COMN_MASTER_VALUES cmvt,lt_po_headers po \
#where cmvs.value_code(+) = ih.status \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID \
#AND cmvt.value_code(+) = me.TITLE \
#AND cmv.value_code(+) = ih.INVOICE_TYPE \
#AND ih.VENDOR_ID = ? \
#AND ih.PO_HEADER_ID = po.PO_HEADER_ID(+) \
#AND nvl(upper(ih.INVOICE_TYPE),'xx') like nvl(?,nvl(upper(ih.INVOICE_TYPE),'xx'))\
#AND nvl(upper(ih.INVOICE_NUM),'xx') like nvl(?,nvl(upper(ih.INVOICE_NUM),'xx'))\
#AND TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY') LIKE nvl(?, TO_CHAR(nvl (ih.INVOICE_DATE, SYSDATE ),'DD-MM-YYYY'))\
#AND nvl(ih.INVOICE_AMOUNT,-99) like nvl( ?, nvl(ih.INVOICE_AMOUNT,-99))  \
#AND nvl(ih.AMOUNT_PAID,-99) like nvl( ?, nvl(ih.AMOUNT_PAID,-99))  \
#)a  where ROWNUM <=?) WHERE rnum >=?

getLtInvoiceHeadersDataTableByVendorId1 = SELECT * \
FROM ( \
    SELECT a.*, @rownum := @rownum + 1 AS RNUM \
    FROM ( \
        SELECT \
            ih.INVOICE_HEADER_ID, \
            cmv.value_name AS INVOICE_TYPE, \
            ih.INTERNAL_INVOICE_NUMBER, \
            ih.INVOICE_NUM, \
            ih.INVOICE_DATE, \
            ih.INVOICE_RECEIVED_DATE, \
            ih.PO_HEADER_ID, \
            ih.BUYER_ID, \
            ih.VENDOR_ID, \
            ih.VENDOR_ADD_ID, \
            ih.DESCRIPTION, \
            ih.INVOICE_AMOUNT, \
            ih.BILLING_ADD_ID, \
            ih.SHIPPING_ADD_ID, \
            cmvs.value_name AS STATUS, \
            ih.AMOUNT_PAID, \
            ih.VOUCHER_NUM, \
            ih.VOUCHER_DATE, \
            ih.INVOICE_CURRENCY, \
            ih.SOURCE, \
            ih.SOURCE_REF_NO, \
            IF(me.EMPLOYEE_ID IS NOT NULL, CONCAT(me.first_name, ' ', me.LAST_NAME, ' (', me.EMPLOYEE_NUMBER, ')'), '') AS buyer, \
            po.PO_NUMBER \
        FROM LT_INVOICE_HEADERS ih \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
        LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.status \
        LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
        LEFT JOIN LT_PO_HEADERS po ON ih.PO_HEADER_ID = po.PO_HEADER_ID \
        WHERE ih.VENDOR_ID = ? \
        AND IFNULL(UPPER(ih.INVOICE_TYPE), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_TYPE), 'xx')) \
        AND IFNULL(UPPER(ih.INVOICE_NUM), 'xx') LIKE IFNULL(?, IFNULL(UPPER(ih.INVOICE_NUM), 'xx')) \
        AND DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(ih.INVOICE_DATE, CURRENT_DATE), '%d-%m-%Y')) \
        AND IFNULL(ih.INVOICE_AMOUNT, -99) LIKE IFNULL(?, IFNULL(ih.INVOICE_AMOUNT, -99)) \
        AND IFNULL(ih.AMOUNT_PAID, -99) LIKE IFNULL(?, IFNULL(ih.AMOUNT_PAID, -99)) \
    ) a, (SELECT @rownum := 0) rnum \
    WHERE RNUM <= ? \
) AS paginated_results \
WHERE RNUM >= ?



getCountAndStatusByVendorId =  SELECT COUNT(ih.INVOICE_HEADER_ID) as COUNT,ih.STATUS as STATUS \
FROM LT_INVOICE_HEADERS ih WHERE ih.VENDOR_ID = ?  GROUP BY ih.STATUS

getInvoiceAmtByUserId = SELECT SUM(ih.INVOICE_AMOUNT) INVOICE_AMOUNT  FROM LT_INVOICE_HEADERS ih WHERE ih.CREATED_BY = ?


getAllInvoice = SELECT * FROM LT_INVOICE_HEADERS lih \
JOIN \
    lt_mast_employees lme ON lih.buyer_id = lme.employee_id \
    WHERE  \
    lme.COMPANY_ID=? 


getAllInvoiceByInitiator = SELECT * FROM LT_INVOICE_HEADERS WHERE INITIATOR_ID = ?

#getInvoiceById = SELECT ih.INVOICE_HEADER_ID,ih.INTERNAL_INVOICE_NUMBER,ih.INVOICE_NUM,ih.INVOICE_DATE,ih.STATUS,ih.INVOICE_TYPE , \
#ih.INVOICE_RECEIVED_DATE,ih.PO_HEADER_ID,ih.BUYER_ID,ih.VENDOR_ID,ih.VENDOR_ADD_ID,ih.DESCRIPTION,ih.INVOICE_AMOUNT,  \
#ih.BILLING_ADD_ID,ih.SHIPPING_ADD_ID,ih.AMOUNT_PAID,ih.VOUCHER_NUM,ih.VOUCHER_DATE,ih.INVOICE_CURRENCY,ih.SOURCE,ph.PO_AMOUNT,  \
#ih.SOURCE_REF_NO,ih.CREATED_BY,ih.CREATION_DATE,ih.LAST_UPDATE_LOGIN,ih.EXCHANGE_RATE,ih.BASE_AMOUNT, ih.PAYTERM_ID, \
#pt.TERM_NAME,ih.INITIATOR_ID,cmv.value_name as TYPE, vm.VENDOR_NAME||' ( '||vm.VENDOR_CODE||' )' as VENDOR_NAME, \
#cmvs.value_name as INVOICE_STATUS  ,nvl2(d.DIVISION_NAME,d.DIVISION_NAME||' ( '||d.DIVISION_CODE||' )','')  as DIVISION_NAME, \
#nvl2(me.EMPLOYEE_ID,( cmvt.value_name||' ' || me.first_name || ' '|| me.LAST_NAME||' ' || '(' ||me.EMPLOYEE_NUMBER||')' ),'') AS buyer , \
#DECODE(mu.VENDOR_ID , null, nvl2(mei.EMPLOYEE_ID,( cmvt.value_name||' ' || mei.first_name || ' '|| mei.LAST_NAME||' ' || '(' ||mei.EMPLOYEE_NUMBER||')' ),''), \
#mv.VENDOR_NAME||' ( '||mv.VENDOR_CODE||' )') AS initiator_name,ph.PO_NUMBER \
#FROM LT_INVOICE_HEADERS ih,LT_MAST_VENDORS vm, LT_MAST_COMN_MASTER_VALUES cmv, LT_MAST_COMN_MASTER_VALUES cmvs, LT_MAST_DIVISIONS d ,  \
#LT_MAST_EMPLOYEES me, LT_MAST_COMN_MASTER_VALUES cmvt  , LT_MAST_EMPLOYEES mei, LT_MAST_USERS mu, LT_MAST_VENDORS mv , \
#LT_MAST_PAYMENT_TERMS pt,LT_PO_HEADERS ph  \
#WHERE ih.INVOICE_HEADER_ID = ?   \
#AND ih.VENDOR_ID = vm.VENDOR_ID(+)  AND ih.PAYTERM_ID = pt.PAYTERM_ID(+) AND  ih.CREATED_BY = mu.USER_ID(+)   \
#AND cmv.value_code(+) = ih.INVOICE_TYPE  \
#AND me.title = cmvt.value_code(+)   \
#AND me.EMPLOYEE_ID(+) = ih.BUYER_ID   \
#AND mei.EMPLOYEE_ID(+) = ih.INITIATOR_ID  AND cmvs.value_code(+) = ih.STATUS AND ih.PO_HEADER_ID = ph.PO_HEADER_ID(+) \
#AND mu.VENDOR_ID  = mv.VENDOR_ID(+) AND ih.DIVISION_ID = d.DIVISION_ID(+)

getInvoiceById = SELECT \
    ih.INVOICE_HEADER_ID, \
    ih.INTERNAL_INVOICE_NUMBER, \
    ih.INVOICE_NUM, \
    ih.INVOICE_DATE, \
    ih.STATUS, \
    ih.INVOICE_TYPE, \
    ih.INVOICE_RECEIVED_DATE, \
    ih.PO_HEADER_ID, \
    ih.BUYER_ID, \
    ih.VENDOR_ID, \
    ih.VENDOR_ADD_ID, \
    ih.DESCRIPTION, \
    ih.INVOICE_AMOUNT, \
    ih.BILLING_ADD_ID, \
    ih.SHIPPING_ADD_ID, \
    ih.AMOUNT_PAID, \
    ih.VOUCHER_NUM, \
    ih.VOUCHER_DATE, \
    ih.INVOICE_CURRENCY, \
    ih.SOURCE, \
    ph.PO_AMOUNT, \
    ih.SOURCE_REF_NO, \
    ih.CREATED_BY, \
    ih.CREATION_DATE, \
    ih.LAST_UPDATE_LOGIN, \
    ih.EXCHANGE_RATE, \
    ih.BASE_AMOUNT, \
    ih.company_id, \
    ih.PAYTERM_ID, \
    pt.TERM_NAME, \
    ih.INITIATOR_ID, \
    cmv.value_name AS TYPE, \
    CONCAT(vm.VENDOR_NAME, ' (', vm.VENDOR_CODE, ')') AS VENDOR_NAME, \
    cmvs.value_name AS INVOICE_STATUS, \
    IFNULL(CONCAT(d.DIVISION_NAME, ' (', d.DIVISION_CODE, ')'), '') AS DIVISION_NAME, \
    IF(me.EMPLOYEE_ID IS NOT NULL, CONCAT(me.first_name, ' ', me.LAST_NAME, ' (', me.EMPLOYEE_NUMBER, ')'), '') AS buyer, \
    IFNULL( \
        IFNULL(mu.VENDOR_ID, IFNULL(CONCAT(mei.first_name, ' ', mei.LAST_NAME, ' (', mei.EMPLOYEE_NUMBER, ')'), '')), \
        CONCAT(mv.VENDOR_NAME, ' (', mv.VENDOR_CODE, ')') \
    ) AS initiator_name, \
    ph.PO_NUMBER \
FROM LT_INVOICE_HEADERS ih \
LEFT JOIN LT_MAST_VENDORS vm ON ih.VENDOR_ID = vm.VENDOR_ID \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmv ON cmv.value_code = ih.INVOICE_TYPE \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ih.STATUS \
LEFT JOIN LT_MAST_DIVISIONS d ON ih.DIVISION_ID = d.DIVISION_ID \
LEFT JOIN LT_MAST_EMPLOYEES me ON me.EMPLOYEE_ID = ih.BUYER_ID \
LEFT JOIN LT_MAST_EMPLOYEES mei ON mei.EMPLOYEE_ID = ih.INITIATOR_ID \
LEFT JOIN LT_MAST_USERS mu ON ih.CREATED_BY = mu.USER_ID \
LEFT JOIN LT_MAST_VENDORS mv ON mu.VENDOR_ID = mv.VENDOR_ID \
LEFT JOIN LT_MAST_PAYMENT_TERMS pt ON ih.PAYTERM_ID = pt.PAYTERM_ID \
LEFT JOIN LT_PO_HEADERS ph ON ih.PO_HEADER_ID = ph.PO_HEADER_ID \
WHERE ih.INVOICE_HEADER_ID = ?



getByInvoiceNumber = SELECT * FROM LT_INVOICE_HEADERS WHERE UPPER(INVOICE_NUM) = ?

getByInvNumVendAndAddr = SELECT * FROM LT_INVOICE_HEADERS WHERE UPPER(INVOICE_NUM) = ? AND VENDOR_ID = ? AND VENDOR_ADD_ID = ?

deleteInvoiceHeaderById = DELETE FROM LT_INVOICE_HEADERS WHERE INVOICE_HEADER_ID = ?

#Rental Agreement Queries...Date 16 Nov 2024

#getLtRentalAgreementHeadersDatatable = SELECT rah.agreement_number,mv.vendor_name, \
#rah.property_city,rah.property_type,cmvpt.value_name property_type_name, \
#rah.from_date,rah.to_date,rah.base_rent,rah.rent_frequency,cmv.value_name rent_frequency_name,rah.status \
#FROM lt_rental_agreement_headers rah \
#    ,lt_mast_vendors mv \
#    ,lt_mast_comn_master cm \
#    ,lt_mast_comn_master_values cmv \
#    ,lt_mast_comn_master cmpt \
#    ,lt_mast_comn_master_values cmvpt \
#WHERE mv.vendor_id = rah.vendor_id \
#AND   cm.master_name = 'RENT_FREQUENCY' \
#AND   cm.master_id = cmv.master_id \
#AND   cmv.value_code = rah.rent_frequency \
#AND   cmpt.master_name = 'PROPERTY_TYPE' \
#AND   cmpt.master_id = cmvpt.master_id \
#AND   cmvpt.value_code = rah.property_type \
#ORDER BY rah.last_update_date DESC

getLtRentalAgreementHeadersDatatable = SELECT * FROM  \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM \
(SELECT rah.agreement_header_id,rah.agreement_number,mv.vendor_name,rah.property_city,rah.property_type,cmvpt.value_name property_type_name,rah.from_date,rah.to_date,rah.base_rent,rah.rent_frequency,cmv.value_name rent_frequency_name,rah.status,cmptvs.value_code,cmptvs.value_name \
FROM lt_rental_agreement_headers rah \
   ,lt_mast_vendors mv \
    ,lt_mast_comn_master cm \
    ,lt_mast_comn_master_values cmv \
    ,lt_mast_comn_master cmpt \
    ,lt_mast_comn_master_values cmvpt \
    ,lt_mast_comn_master cmpts  \
    ,lt_mast_comn_master_values cmptvs \
WHERE rah.company_id = ? \
AND mv.vendor_id = rah.vendor_id \
AND   cm.master_name = 'RENT_FREQUENCY' \
AND   cm.master_id = cmv.master_id \
AND   cmv.value_code = rah.rent_frequency \
AND   cmpt.master_name = 'PROPERTY_TYPE' \
AND   cmpt.master_id = cmvpt.master_id \
AND   cmvpt.value_code = rah.property_type \
AND   cmpts.master_name = 'RENTAL_AGREEMENT_STATUES' \
AND   cmpts.master_id = cmptvs.master_id \
AND   cmptvs.value_code = rah.status \
AND IFNULL(UPPER(rah.agreement_number), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.agreement_number), 'xx'))  \
AND IFNULL(UPPER(rah.property_city), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.property_city), 'xx'))   \
AND IFNULL(UPPER(mv.vendor_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(mv.vendor_name), 'xx'))  \
AND DATE_FORMAT(IFNULL(rah.from_date, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(rah.from_date, CURRENT_DATE), '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(rah.to_date, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(rah.to_date, CURRENT_DATE), '%d-%m-%Y'))  \
AND IFNULL(UPPER(rah.rent_frequency), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.rent_frequency), 'xx'))  \
AND IFNULL(UPPER(rah.status), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.status), 'xx')) \
ORDER BY  \
CASE WHEN 2 = ? THEN UPPER(rah.agreement_number) END ASC,  \
CASE WHEN 12 = ? THEN UPPER(rah.agreement_number) END DESC,  \
CASE WHEN 3 = ? THEN UPPER(rah.property_city) END ASC,  \
CASE WHEN 13 = ? THEN UPPER(rah.property_city) END DESC,  \
CASE WHEN 4 = ? THEN UPPER(mv.vendor_name) END ASC,  \
CASE WHEN 14 = ? THEN UPPER(mv.vendor_name) END DESC,  \
CASE WHEN 5 = ? THEN rah.from_date END ASC,  \
CASE WHEN 15 = ? THEN rah.from_date END DESC,  \
CASE WHEN 6 = ? THEN rah.to_date END ASC, \
CASE WHEN 16 = ? THEN rah.to_date END DESC,  \
CASE WHEN 7 = ? THEN UPPER(rah.rent_frequency) END ASC,  \
CASE WHEN 17 = ? THEN UPPER(rah.rent_frequency) END DESC, \
CASE WHEN 8 = ? THEN UPPER(rah.status) END ASC,  \
CASE WHEN 18 = ? THEN UPPER(rah.status) END DESC, \
CASE WHEN 1 = ? THEN rah.last_update_date END DESC,  \
CASE WHEN 11 = ? THEN rah.last_update_date END ASC  \
) a, (SELECT @rownum := 0) r  \
WHERE @rownum < ?) AS t  \
WHERE RNUM >= ?


getLtRentalAgreementHeadersCount = SELECT count(rah.agreement_header_id) \
FROM lt_rental_agreement_headers rah \
   ,lt_mast_vendors mv \
    ,lt_mast_comn_master cm \
    ,lt_mast_comn_master_values cmv \
    ,lt_mast_comn_master cmpt \
    ,lt_mast_comn_master_values cmvpt \
WHERE rah.company_id = ? \
AND mv.vendor_id = rah.vendor_id \
AND   cm.master_name = 'RENT_FREQUENCY' \
AND   cm.master_id = cmv.master_id \
AND   cmv.value_code = rah.rent_frequency \
AND   cmpt.master_name = 'PROPERTY_TYPE' \
AND   cmpt.master_id = cmvpt.master_id \
AND   cmvpt.value_code = rah.property_type \
AND IFNULL(UPPER(rah.agreement_number), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.agreement_number), 'xx')) \
AND IFNULL(UPPER(rah.property_city), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.property_city), 'xx'))  \
AND IFNULL(UPPER(mv.vendor_name), 'xx') LIKE IFNULL(?, IFNULL(UPPER(mv.vendor_name), 'xx'))  \
AND DATE_FORMAT(IFNULL(rah.from_date, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(rah.from_date, CURRENT_DATE), '%d-%m-%Y')) \
AND DATE_FORMAT(IFNULL(rah.to_date, CURRENT_DATE), '%d-%m-%Y') LIKE IFNULL(?, DATE_FORMAT(IFNULL(rah.to_date, CURRENT_DATE), '%d-%m-%Y'))  \
AND IFNULL(UPPER(rah.rent_frequency), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.rent_frequency), 'xx'))  \
AND IFNULL(UPPER(rah.status), 'xx') LIKE IFNULL(?, IFNULL(UPPER(rah.status), 'xx'))

getRentalAgreementHeaderById = SELECT \
    rah.agreement_header_id, \
    rah.agreement_number, \
    mv.vendor_name, \
    rah.vendor_id, \
    rah.property_address, \
    rah.property_city, \
    rah.property_state_id, \
    rah.property_type, \
    cmvpt.value_name AS property_type_name, \
    rah.from_date, \
    rah.to_date, \
    rah.base_rent, \
    rah.rent_frequency, \
    cmv.value_name AS rent_frequency_name, \
    rah.status, \
    rah.property_title, \
    rah.security_deposit, \
    rah.sd_payment_ref, \
    rah.sd_payment_date, \
    rah.rental_type, \
    rah.rent_due_day, \
    rah.lock_in_period, \
    rah.branch_id, \
    rah.agreement_file_path, \
    rah.notice_period, \
    rah.notice_date, \
    rah.termination_date, \
    rah.termination_remark, \
    rah.created_by, \
    rah.creation_date, \
    rah.last_update_login, \
    rah.last_updated_by, \
    rah.last_update_date, \
    rah.end_date, \
    rah.lock_in_period, \
    rah.company_id, \
    rah.rent_currency, \
    rah.division_id, \
    lmd.division_name, \
    rah.initiator_id , \
    concat(lme.FIRST_NAME,' ',lme.LAST_NAME)  as initiator_name, \
    rah.branch_id , \
    lmb.branch_name , \
    lmcmv.VALUE_CODE , \
    lmcmv.VALUE_NAME, \
    rah.vendor_add_id, \
    rah.billing_add_id \
FROM  \
    lt_rental_agreement_headers rah \
    JOIN lt_mast_vendors mv ON mv.vendor_id = rah.vendor_id \
    JOIN lt_mast_divisions lmd ON lmd.division_id = rah.division_id \
    join lt_mast_employees lme on lme.EMPLOYEE_ID = rah.initiator_id \
    join lt_mast_branches lmb on lmb.BRANCH_ID = rah.BRANCH_ID \
    JOIN lt_mast_comn_master cm ON cm.master_name = 'RENT_FREQUENCY' \
    JOIN lt_mast_comn_master_values cmv ON cm.master_id = cmv.master_id AND cmv.value_code = rah.rent_frequency \
    JOIN lt_mast_comn_master cmpt ON cmpt.master_name = 'PROPERTY_TYPE' \
    JOIN lt_mast_comn_master_values cmvpt ON cmpt.master_id = cmvpt.master_id AND cmvpt.value_code = rah.property_type \
    JOIN lt_mast_comn_master lmcm ON lmcm.master_name = 'RENTAL_AGREEMENT_STATUES' \
    JOIN lt_mast_comn_master_values lmcmv ON lmcm.master_id = lmcmv.master_id AND lmcmv.value_code = rah.status \
WHERE \
    rah.agreement_header_id = ?
    
    
    
 getRentalAgreementStatusById = Select rah.status,rah.created_by from lt_rental_agreement_headers rah \
 where rah.agreement_header_id = ? 
 
 deleteRentalAgreementHeaderById = DELETE FROM lt_rental_agreement_headers WHERE agreement_header_id = ? 
 
getNextApprovalLevelAgr = select MIN(APPROVAL_LEVEL) AS  CURRENT_APPROVAL_LEVEL \
 from lt_rental_agreement_approval \
 where AGREEMENT_HEADER_ID = ? AND APPROVAL_LEVEL > ?
 
getByStatusInboxViewForRentalAgr = SELECT * FROM   \
(SELECT a.*, @rownum := @rownum + 1 AS RNUM FROM   \
(SELECT ea.AGREEMENT_APPROVAL_ID AS AGREEMENT_APPROVAL_ID, \
ea.MODULE_APPROVAL_ID AS MODULE_APPROVAL_ID,   \
ea.APPROVAL_ID AS APPROVAL_ID,   \
ea.APPROVAL_LEVEL AS APPROVAL_LEVEL,   \
ea.CURRENT_APPROVAL_LEVEL AS CURRENT_APPROVAL_LEVEL,  \
ea.AGREEMENT_HEADER_ID AS AGREEMENT_HEADER_ID,   \
cmvs.value_name AS STATUS,   \
ea.LAST_UPDATE_DATE AS LAST_UPDATE_DATE,   \
ea.DELEGATION_ID AS DELEGATION_ID,   \
ea.START_DATE AS START_DATE,   \
ea.END_DATE AS END_DATE,   \
eh.initiator_id AS Employee_id,  \
eh.agreement_Number AS agreement_Number,      \
eh.Division_id AS Division_id,     \
ea.created_by, \
(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')) AS INITIATOR_NAME  \
FROM lt_rental_agreement_approval ea   \
JOIN lt_rental_agreement_headers eh ON ea.AGREEMENT_HEADER_ID = eh.AGREEMENT_Header_id   \
JOIN lt_mast_employees em ON em.employee_id = eh.initiator_id   \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ea.status   \
and cmvs.MASTER_ID = (select Master_id from LT_MAST_COMN_MASTER where MASTER_NAME = 'RENTAL_AGREEMENT_STATUES') \
WHERE UPPER(ea.STATUS) IN (?,?)   \
AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?)   \
AND UPPER(eh.agreement_Number) LIKE IFNULL(?, UPPER(eh.agreement_Number))   \
AND UPPER(ea.STATUS) LIKE IFNULL(?, UPPER(ea.STATUS))  \
AND UPPER(CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')'))   \
LIKE UPPER(IFNULL(?, CONCAT(em.first_name, ' ', em.LAST_NAME, ' (', em.EMPLOYEE_NUMBER, ')')))  \
ORDER BY   \
CASE WHEN 2 = ? THEN UPPER(eh.agreement_Number) END ASC,   \
CASE WHEN 11 = ? THEN UPPER(eh.agreement_Number) END DESC,   \
CASE WHEN 3 = ? THEN UPPER(INITIATOR_NAME) END ASC,   \
CASE WHEN 12 = ? THEN UPPER(INITIATOR_NAME) END DESC   \
) a, (SELECT @rownum := 0) r   \
) b   \
WHERE RNUM <= ? and RNUM >= ?

getCountInboxForRentalAgr = select count(*)  \
FROM lt_rental_agreement_approval ea   \
JOIN lt_rental_agreement_headers eh ON ea.AGREEMENT_HEADER_ID = eh.AGREEMENT_Header_id   \
JOIN lt_mast_employees em ON em.employee_id = eh.initiator_id   \
LEFT JOIN LT_MAST_COMN_MASTER_VALUES cmvs ON cmvs.value_code = ea.status   \
and cmvs.MASTER_ID = (select Master_id from LT_MAST_COMN_MASTER where MASTER_NAME = 'RENTAL_AGREEMENT_STATUES')  \
WHERE UPPER(ea.STATUS) IN (?,?)  \
AND (ea.APPROVAL_ID = ? OR ea.DELEGATION_ID = ?)



Check_Duplicate_Invoice=PROCEDURE Check_Duplicate_Invoice(IN p_company_id INT, IN p_invoice_num VARCHAR(80),  \
IN p_vendor_id INT, IN p_vendor_add_id INT, IN p_invoice_date DATE, OUT x_status VARCHAR(20), \
 OUT x_message VARCHAR(300))